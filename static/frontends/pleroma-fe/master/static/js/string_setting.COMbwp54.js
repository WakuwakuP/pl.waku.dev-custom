import{_ as b,P as I,B as r,c as n,y as c,o as s,x as a,w as u,a as f,t as i,D as l,f as M,c4 as C,ce as L,v as P,l as g,e as A,A as y,W as _,I as m,a6 as V,J as N,aB as O}from"./main.C8E1fd6V.js";M.add(C);const w={components:{Popover:I},props:{changed:Boolean,messageKey:{type:String,default:"settings.setting_changed"}}},E={key:0,class:"ModifiedIndicator"},F={class:"modified-tooltip"};function j(e,t,d,$,S,D){const o=r("FAIcon"),h=r("Popover");return d.changed?(s(),n("span",E,[a(h,{trigger:"hover","trigger-attrs":{"aria-label":e.$t("settings.setting_changed")}},{trigger:u(()=>[t[0]||(t[0]=l("   ")),a(o,{icon:"wrench"})]),content:u(()=>[f("div",F,i(e.$t(d.messageKey)),1)]),_:1},8,["trigger-attrs"])])):c("",!0)}const q=b(w,[["render",j]]);M.add(L);const R={components:{Popover:I},props:["isProfile"]},U={key:0,class:"ProfileSettingIndicator"},T={class:"profilesetting-tooltip"};function G(e,t,d,$,S,D){const o=r("FAIcon"),h=r("Popover");return d.isProfile?(s(),n("span",U,[a(h,{trigger:"hover"},{trigger:u(()=>[t[0]||(t[0]=l("   ")),a(o,{icon:"server","aria-label":e.$t("settings.setting_server_side")},null,8,["aria-label"])]),content:u(()=>[f("div",T,i(e.$t("settings.setting_server_side")),1)]),_:1})])):c("",!0)}const H=b(R,[["render",G]]);M.add(C);const K={components:{Popover:I},props:["changed"]},W={class:"DraftButtons"},z={class:"modified-tooltip"},J={class:"modified-tooltip"},Q={class:"modified-tooltip"};function X(e,t,d,$,S,D){const o=r("Popover");return s(),n("span",W,[e.$parent.isDirty?(s(),P(o,{key:0,trigger:"hover","normal-button":"","trigger-attrs":{"aria-label":e.$t("settings.commit_value_tooltip")},onClick:e.$parent.commitDraft},{trigger:u(()=>[l(i(e.$t("settings.commit_value")),1)]),content:u(()=>[f("div",z,i(e.$t("settings.commit_value_tooltip")),1)]),_:1},8,["trigger-attrs","onClick"])):c("",!0),e.$parent.isDirty?(s(),P(o,{key:1,trigger:"hover","normal-button":"","trigger-attrs":{"aria-label":e.$t("settings.reset_value_tooltip")},onClick:e.$parent.reset},{trigger:u(()=>[l(i(e.$t("settings.reset_value")),1)]),content:u(()=>[f("div",J,i(e.$t("settings.reset_value_tooltip")),1)]),_:1},8,["trigger-attrs","onClick"])):c("",!0),e.$parent.canHardReset?(s(),P(o,{key:2,trigger:"hover","normal-button":"","trigger-attrs":{"aria-label":e.$t("settings.hard_reset_value_tooltip")},onClick:e.$parent.hardReset},{trigger:u(()=>[l(i(e.$t("settings.hard_reset_value")),1)]),content:u(()=>[f("div",Q,i(e.$t("settings.hard_reset_value_tooltip")),1)]),_:1},8,["trigger-attrs","onClick"])):c("",!0)])}const Y=b(K,[["render",X]]),p={components:{ModifiedIndicator:q,DraftButtons:Y,ProfileSettingIndicator:H},props:{modelValue:{type:String,default:null},path:{type:[String,Array],required:!1},disabled:{type:Boolean,default:!1},parentPath:{type:[String,Array]},parentInvert:{type:Boolean,default:!1},expert:{type:[Number,String],default:0},source:{type:String,default:void 0},hideDescription:{type:Boolean},swapDescriptionAndLabel:{type:Boolean},overrideBackendDescription:{type:Boolean},overrideBackendDescriptionLabel:{type:Boolean},draftMode:{type:Boolean,default:void 0},timedApplyMode:{type:Boolean,default:!1}},inject:{defaultSource:{default:"default"},defaultDraftMode:{default:!1}},data(){return{localDraft:null}},created(){this.realDraftMode&&(this.realSource!=="admin"||this.path==null)&&(this.draft=this.state)},computed:{draft:{get(){return this.realSource==="admin"||this.path==null?g.get(this.$store.state.adminSettings.draft,this.canonPath):this.localDraft},set(e){this.realSource==="admin"||this.path==null?this.$store.commit("updateAdminDraft",{path:this.canonPath,value:e}):this.localDraft=e}},state(){if(this.path==null)return this.modelValue;const e=g.get(this.configSource,this.canonPath);return e===void 0?this.defaultState:e},visibleState(){return this.realDraftMode?this.draft:this.state},realSource(){return this.source||this.defaultSource},realDraftMode(){return typeof this.draftMode>"u"?this.defaultDraftMode:this.draftMode},backendDescription(){return g.get(this.$store.state.adminSettings.descriptions,this.path)},backendDescriptionLabel(){var e,t;return this.realSource!=="admin"?"":!this.backendDescription||this.overrideBackendDescriptionLabel?this.$t(["admin_dash","temp_overrides",...this.canonPath.map(d=>d.replace(/\./g,"_DOT_")),"label"].join(".")):this.swapDescriptionAndLabel?(e=this.backendDescription)==null?void 0:e.description:(t=this.backendDescription)==null?void 0:t.label},backendDescriptionDescription(){var e,t;return this.realSource!=="admin"?"":this.hideDescription?null:!this.backendDescription||this.overrideBackendDescription?this.$t(["admin_dash","temp_overrides",...this.canonPath.map(d=>d.replace(/\./g,"_DOT_")),"description"].join(".")):this.swapDescriptionAndLabel?(e=this.backendDescription)==null?void 0:e.label:(t=this.backendDescription)==null?void 0:t.description},backendDescriptionSuggestions(){var e;return(e=this.backendDescription)==null?void 0:e.suggestions},shouldBeDisabled(){if(this.path==null)return this.disabled;const e=this.parentPath!==void 0?g.get(this.configSource,this.parentPath):null;return this.disabled||(e!==null?this.parentInvert?e:!e:!1)},configSource(){switch(this.realSource){case"profile":return this.$store.state.profileConfig;case"admin":return this.$store.state.adminSettings.config;default:return this.$store.getters.mergedConfig}},configSink(){if(this.path==null)return(e,t)=>this.$emit("update:modelValue",t);switch(this.realSource){case"profile":return(e,t)=>this.$store.dispatch("setProfileOption",{name:e,value:t});case"admin":return(e,t)=>this.$store.dispatch("pushAdminSetting",{path:e,value:t});default:return this.timedApplyMode?(e,t)=>this.$store.dispatch("setOptionTemporarily",{name:e,value:t}):(e,t)=>this.$store.dispatch("setOption",{name:e,value:t})}},defaultState(){switch(this.realSource){case"profile":return{};default:return g.get(this.$store.getters.defaultConfig,this.path)}},isProfileSetting(){return this.realSource==="profile"},isChanged(){if(this.path==null)return!1;switch(this.realSource){case"profile":case"admin":return!1;default:return this.state!==this.defaultState}},canonPath(){return this.path==null?null:Array.isArray(this.path)?this.path:this.path.split(".")},isDirty(){return this.path==null||this.realSource==="admin"&&this.canonPath.length>3?!1:this.realDraftMode&&this.draft!==this.state},canHardReset(){return this.realSource==="admin"&&this.$store.state.adminSettings.modifiedPaths&&this.$store.state.adminSettings.modifiedPaths.has(this.canonPath.join(" -> "))},matchesExpertLevel(){return(this.expert||0)<=this.$store.state.config.expertLevel>0}},methods:{getValue(e){return e.target.value},update(e){this.realDraftMode?this.draft=this.getValue(e):this.configSink(this.path,this.getValue(e))},commitDraft(){this.realDraftMode&&this.configSink(this.path,this.draft)},reset(){this.realDraftMode?this.draft=g.cloneDeep(this.state):g.set(this.$store.getters.mergedConfig,this.path,g.cloneDeep(this.defaultState))},hardReset(){switch(this.realSource){case"admin":return this.$store.dispatch("resetAdminSetting",{path:this.path}).then(()=>{this.draft=this.state});default:console.warn("Hard reset not implemented yet!")}}}},Z={...p,props:{...p.props,indeterminateState:[String,Object]},components:{...p.components,Checkbox:A},computed:{...p.computed,isIndeterminate(){return this.visibleState===this.indeterminateState}},methods:{...p.methods,getValue(e){return this.indeterminateState&&!e&&this.visibleState===!0?this.indeterminateState:e}}},x={key:0,class:"BooleanSetting"};function ee(e,t,d,$,S,D){const o=r("Checkbox"),h=r("ModifiedIndicator"),k=r("ProfileSettingIndicator"),v=r("DraftButtons");return e.matchesExpertLevel?(s(),n("label",x,[a(o,{"model-value":e.visibleState,disabled:e.shouldBeDisabled,indeterminate:e.isIndeterminate,"onUpdate:modelValue":e.update},{default:u(()=>[f("span",{class:y(["label",{faint:e.shouldBeDisabled}])},[e.backendDescriptionLabel?(s(),n(m,{key:0},[l(i(e.backendDescriptionLabel),1)],64)):e.source==="admin"?(s(),n(m,{key:1},[l(" MISSING LABEL FOR "+i(e.path),1)],64)):_(e.$slots,"default",{key:2})],2)]),_:3},8,["model-value","disabled","indeterminate","onUpdate:modelValue"]),a(h,{changed:e.isChanged,onclick:e.reset},null,8,["changed","onclick"]),a(k,{"is-profile":e.isProfileSetting},null,8,["is-profile"]),a(v),e.backendDescriptionDescription?(s(),n("p",{key:0,class:y(["setting-description",{faint:e.shouldBeDisabled}])},i(e.backendDescriptionDescription+" "),3)):c("",!0)])):c("",!0)}const De=b(Z,[["render",ee]]),ke=()=>({user(){return this.$store.state.users.currentUser},expertLevel(){return this.$store.getters.mergedConfig.expertLevel>0},mergedConfig(){return this.$store.getters.mergedConfig},adminConfig(){return this.$store.state.adminSettings.config},adminDraft(){return this.$store.state.adminSettings.draft}}),te={...p,components:{...p.components,Select:V},props:{...p.props,options:{type:Array,required:!1},optionLabelMap:{type:Object,required:!1,default:{}}},computed:{...p.computed,realOptions(){return this.realSource==="admin"?this.backendDescriptionSuggestions.map(e=>({key:e,value:e,label:this.optionLabelMap[e]||e})):this.options}},methods:{...p.methods,getValue(e){return e}}},ie={key:0,class:"ChoiceSetting"},se=["value"],ne={key:2,class:"setting-description"};function re(e,t,d,$,S,D){const o=r("Select"),h=r("ModifiedIndicator"),k=r("ProfileSettingIndicator"),v=r("DraftButtons");return e.matchesExpertLevel?(s(),n("label",ie,[e.backendDescriptionLabel?(s(),n(m,{key:0},[l(i(e.backendDescriptionLabel),1)],64)):_(e.$slots,"default",{key:1}),t[0]||(t[0]=l(" "+i(" ")+" ")),a(o,{"model-value":e.realDraftMode?e.draft:e.state,disabled:e.disabled,"onUpdate:modelValue":e.update},{default:u(()=>[(s(!0),n(m,null,N(e.realOptions,B=>(s(),n("option",{key:B.key,value:B.value},i(B.label)+" "+i(B.value===e.defaultState?e.$t("settings.instance_default_simple"):""),9,se))),128))]),_:1},8,["model-value","disabled","onUpdate:modelValue"]),a(h,{changed:e.isChanged,onclick:e.reset},null,8,["changed","onclick"]),a(k,{"is-profile":e.isProfileSetting},null,8,["is-profile"]),a(v),e.backendDescriptionDescription?(s(),n("p",ne,i(e.backendDescriptionDescription+" "),1)):c("",!0)])):c("",!0)}const ve=b(te,[["render",re]]),ae={...p,props:{...p.props,min:{type:Number,required:!1,default:1},max:{type:Number,required:!1,default:1},step:{type:Number,required:!1,default:1},truncate:{type:Number,required:!1,default:1}},methods:{...p.methods,getValue(e){return!this.truncate===1?parseInt(e.target.value):this.truncate>1?Math.trunc(e.target.value/this.truncate)*this.truncate:parseFloat(e.target.value)}}},oe={key:0,class:"NumberSetting"},le=["for"],de=["id","step","disabled","min","value"];function pe(e,t,d,$,S,D){const o=r("ModifiedIndicator"),h=r("ProfileSettingIndicator"),k=r("DraftButtons");return e.matchesExpertLevel?(s(),n("span",oe,[f("label",{for:e.path,class:y({faint:e.shouldBeDisabled})},[e.backendDescriptionLabel?(s(),n(m,{key:0},[l(i(e.backendDescriptionLabel+" "),1)],64)):e.source==="admin"?(s(),n(m,{key:1},[l(" MISSING LABEL FOR "+i(e.path),1)],64)):_(e.$slots,"default",{key:2})],10,le),t[1]||(t[1]=l(" "+i(" ")+" ")),f("input",{id:e.path,class:"input number-input",type:"number",step:e.step||1,disabled:e.shouldBeDisabled,min:e.min||0,value:e.realDraftMode?e.draft:e.state,onChange:t[0]||(t[0]=(...v)=>e.update&&e.update(...v))},null,40,de),t[2]||(t[2]=l(" "+i(" ")+" ")),a(o,{changed:e.isChanged,onclick:e.reset},null,8,["changed","onclick"]),a(h,{"is-profile":e.isProfileSetting},null,8,["is-profile"]),a(k),e.backendDescriptionDescription?(s(),n("p",{key:0,class:y(["setting-description",{faint:e.shouldBeDisabled}])},i(e.backendDescriptionDescription+" "),3)):c("",!0)])):c("",!0)}const ue=b(ae,[["render",pe]]),ce={components:{NumberSetting:ue}};function he(e,t,d,$,S,D){const o=r("NumberSetting");return s(),P(o,O(e.$attrs,{truncate:1}),{default:u(()=>[_(e.$slots,"default")]),_:3},16)}const ye=b(ce,[["render",he]]),fe={...p},ge={key:0,class:"StringSetting"},me=["for"],be=["id","disabled","value"];function $e(e,t,d,$,S,D){const o=r("ModifiedIndicator"),h=r("ProfileSettingIndicator"),k=r("DraftButtons");return e.matchesExpertLevel?(s(),n("label",ge,[f("label",{for:e.path,class:y(["setting-label",{faint:e.shouldBeDisabled}])},[e.backendDescriptionLabel?(s(),n(m,{key:0},[l(i(e.backendDescriptionLabel+" "),1)],64)):e.source==="admin"?(s(),n(m,{key:1},[l(" MISSING LABEL FOR "+i(e.path),1)],64)):_(e.$slots,"default",{key:2})],10,me),t[1]||(t[1]=l(" "+i(" ")+" ")),f("input",{id:e.path,class:"input string-input",disabled:e.shouldBeDisabled,value:e.realDraftMode?e.draft:e.state,onChange:t[0]||(t[0]=(...v)=>e.update&&e.update(...v))},null,40,be),t[2]||(t[2]=l(" "+i(" ")+" ")),a(o,{changed:e.isChanged,onclick:e.reset},null,8,["changed","onclick"]),a(h,{"is-profile":e.isProfileSetting},null,8,["is-profile"]),a(k),e.backendDescriptionDescription?(s(),n("p",{key:0,class:y(["setting-description",{faint:e.shouldBeDisabled}])},i(e.backendDescriptionDescription+" "),3)):c("",!0)])):c("",!0)}const _e=b(fe,[["render",$e]]);export{De as B,ve as C,ye as I,q as M,ue as N,H as P,ke as S,p as a,_e as b};
//# sourceMappingURL=string_setting.COMbwp54.js.map
