import{f as ue,L as vt,i as Ht,_ as X,B as P,c as b,o as m,a as n,v as H,y as V,t as i,D as v,x as u,N as dn,e as pe,O as gt,J as Y,K as se,Q as xa,R as ei,S as ti,U as ma,g as un,V as si,W as x,X as ie,Y as Le,Z as fa,w as f,$ as Wt,a0 as ni,z as To,A as W,a1 as oi,a2 as li,a3 as ai,a4 as ii,a5 as ga,H as Kt,a6 as ri,a7 as cn,a8 as qe,P as Gt,a9 as di,b as ba,m as ui,aa as Vo,F as It,l as ae,u as Q,G as Oe,ab as ci,h as hi,ac as va,ad as pi,ae as hn,af as pn,ag as mi,ah as fi,ai as $t,aj as gi,ak as $a,al as mn,am as ya,an as bi,ao as vi,ap as $i,aq as yi,ar as wi,as as ki,at as Ci,au as Ti,av as Vi,aw as wa,ax as Si,ay as Pi,az as ka,aA as Ii,aB as Ca,aC as Ei,aD as So,aE as Zt,aF as Ta,aG as Et,aH as Qt,aI as st,aJ as Ai,aK as _i,aL as Va,aM as Ft,aN as Li,aO as Oi,aP as Ui,aQ as Ri,aR as Bi,aS as Mi,aT as Sa,aU as Fi,aV as Di,aW as Ni,aX as Pa,aY as bt,aZ as fn,a_ as Dt,a$ as Ia,b0 as lt,b1 as Z,b2 as At,b3 as gn,b4 as ji,b5 as qi,b6 as We,b7 as Po,b8 as zi,b9 as ln,p as Hi,ba as Wi,bb as Ki,bc as Gi,bd as Yi,be as Xi,bf as Ve,bg as Ji,bh as _t,bi as Zi,bj as Qi,bk as xi,bl as er,bm as tr,bn as sr,bo as nr,bp as or,bq as Io,br as lr,E as Ea,bs as xt,bt as de,bu as nt,bv as ar,bw as Eo,bx as Lt,by as ir,bz as rr,bA as dr,bB as ur,bC as cr,bD as hr,bE as pr,bF as mr,bG as fr,bH as gr,bI as br,bJ as vr,bK as $r,bL as yr,bM as wr,bN as kr,bO as Cr,bP as Tr,bQ as Vr,bR as Sr,bS as Pr,bT as Ir,bU as Er,bV as Ar,bW as _r,bX as Lr,bY as Or,bZ as Ur,b_ as Rr,b$ as Br,c0 as Mr,c1 as Fr,c2 as Dr,c3 as Nr,c4 as jr,c5 as qr,c6 as zr,c7 as Hr,c8 as Wr,c9 as Kr,ca as Gr,cb as Yr,cc as Xr,cd as Jr,ce as Zr,cf as Qr,cg as xr,ch as ed,ci as td}from"./main.D8z3v97Z.js";import{S as yt,B as wt,a as _e,I as bn,C as vn,N as sd,P as Aa,b as nd}from"./string_setting.glx_SDfi.js";import{n as Yt,a as kt}from"./settings_modal.BQqWcrxE.js";ue.add(vt,Ht);const od={props:{submitHandler:{type:Function,required:!0},submitButtonLabel:{type:String},successMessage:{type:String},errorMessage:{type:String}},data(){return{file:null,error:!1,success:!1,submitting:!1}},methods:{change(){this.file=this.$refs.input.files[0]},submit(){this.dismiss(),this.submitting=!0,this.submitHandler(this.file).then(()=>{this.success=!0}).catch(()=>{this.error=!0}).finally(()=>{this.submitting=!1})},dismiss(){this.success=!1,this.error=!1}}},ld={class:"importer"},ad={key:2},id={key:3};function rd(e,t,s,o,l,a){const d=P("FAIcon");return m(),b("div",ld,[n("form",null,[n("input",{ref:"input",class:"input",type:"file",onChange:t[0]||(t[0]=(...r)=>e.change&&e.change(...r))},null,544)]),e.submitting?(m(),H(d,{key:0,class:"importer-uploading",spin:"",icon:"circle-notch"})):(m(),b("button",{key:1,class:"btn button-default",onClick:t[1]||(t[1]=(...r)=>e.submit&&e.submit(...r))},i(e.submitButtonLabel||e.$t("importer.submit")),1)),e.success?(m(),b("div",ad,[n("button",{class:"button-unstyled",onClick:t[2]||(t[2]=(...r)=>e.dismiss&&e.dismiss(...r))},[u(d,{icon:"times"})]),t[4]||(t[4]=v(" "+i(" ")+" ")),n("span",null,i(e.successMessage||e.$t("importer.success")),1)])):e.error?(m(),b("div",id,[n("button",{class:"button-unstyled",onClick:t[3]||(t[3]=(...r)=>e.dismiss&&e.dismiss(...r))},[u(d,{icon:"times"})]),t[5]||(t[5]=v(" "+i(" ")+" ")),n("span",null,i(e.errorMessage||e.$t("importer.error")),1)])):V("",!0)])}const dd=X(od,[["render",rd]]);ue.add(vt);const ud={props:{getContent:{type:Function,required:!0},filename:{type:String,default:"export.csv"},exportButtonLabel:{type:String},processingMessage:{type:String}},data(){return{processing:!1}},methods:{process(){this.processing=!0,this.getContent().then(e=>{const t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download",this.filename),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t),setTimeout(()=>{this.processing=!1},2e3)})}}},cd={class:"exporter"},hd={key:0};function pd(e,t,s,o,l,a){const d=P("FAIcon");return m(),b("div",cd,[e.processing?(m(),b("div",hd,[u(d,{icon:"circle-notch",size:"lg",spin:""}),n("span",null,i(e.processingMessage||e.$t("exporter.processing")),1)])):(m(),b("button",{key:1,class:"btn button-default",onClick:t[0]||(t[0]=(...r)=>e.process&&e.process(...r))},i(e.exportButtonLabel||e.$t("exporter.export")),1))])}const md=X(ud,[["render",pd]]),fd={data(){return{activeTab:"profile",newDomainToMute:"",listBackupsError:!1,addBackupError:!1,addedBackup:!1,backups:[]}},created(){gt().fetchTokens(),this.fetchBackups()},components:{Importer:dd,Exporter:md,Checkbox:pe},computed:{...dn({backendInteractor:e=>e.api.backendInteractor,user:e=>e.users.currentUser})},methods:{getFollowsContent(){return this.backendInteractor.exportFriends({id:this.user.id}).then(this.generateExportableUsersContent)},getBlocksContent(){return this.backendInteractor.fetchBlocks().then(this.generateExportableUsersContent)},getMutesContent(){return this.backendInteractor.fetchMutes().then(this.generateExportableUsersContent)},importFollows(e){return this.backendInteractor.importFollows({file:e}).then(t=>{if(!t)throw new Error("failed")})},importBlocks(e){return this.backendInteractor.importBlocks({file:e}).then(t=>{if(!t)throw new Error("failed")})},importMutes(e){return this.backendInteractor.importMutes({file:e}).then(t=>{if(!t)throw new Error("failed")})},generateExportableUsersContent(e){return e.map(t=>t&&t.is_local?t.screen_name+"@"+location.hostname:t.screen_name).join(`
`)},addBackup(){this.$store.state.api.backendInteractor.addBackup().then(()=>{this.addedBackup=!0,this.addBackupError=!1}).catch(e=>{this.addedBackup=!1,this.addBackupError=e}).then(()=>this.fetchBackups())},fetchBackups(){this.$store.state.api.backendInteractor.listBackups().then(e=>{this.backups=e,this.listBackupsError=!1}).catch(e=>{this.listBackupsError=e.error})}}},gd=["label"],bd={class:"setting-item"},vd={class:"setting-item"},$d={class:"setting-item"},yd={class:"setting-item"},wd={class:"setting-item"},kd={class:"setting-item"},Cd={class:"setting-item"},Td={class:"actions"},Vd=["href"],Sd={key:1},Pd={key:2},Id={key:3},Ed={key:0,class:"alert error"},Ad=["title"],_d={key:1},Ld={key:2};function Od(e,t,s,o,l,a){const d=P("Importer"),r=P("Exporter"),h=P("FAIcon");return m(),b("div",{label:e.$t("settings.data_import_export_tab")},[n("div",bd,[n("h2",null,i(e.$t("settings.follow_import")),1),n("p",null,i(e.$t("settings.import_followers_from_a_csv_file")),1),u(d,{"submit-handler":e.importFollows,"success-message":e.$t("settings.follows_imported"),"error-message":e.$t("settings.follow_import_error")},null,8,["submit-handler","success-message","error-message"])]),n("div",vd,[n("h2",null,i(e.$t("settings.follow_export")),1),u(r,{"get-content":e.getFollowsContent,filename:"friends.csv","export-button-label":e.$t("settings.follow_export_button")},null,8,["get-content","export-button-label"])]),n("div",$d,[n("h2",null,i(e.$t("settings.block_import")),1),n("p",null,i(e.$t("settings.import_blocks_from_a_csv_file")),1),u(d,{"submit-handler":e.importBlocks,"success-message":e.$t("settings.blocks_imported"),"error-message":e.$t("settings.block_import_error")},null,8,["submit-handler","success-message","error-message"])]),n("div",yd,[n("h2",null,i(e.$t("settings.block_export")),1),u(r,{"get-content":e.getBlocksContent,filename:"blocks.csv","export-button-label":e.$t("settings.block_export_button")},null,8,["get-content","export-button-label"])]),n("div",wd,[n("h2",null,i(e.$t("settings.mute_import")),1),n("p",null,i(e.$t("settings.import_mutes_from_a_csv_file")),1),u(d,{"submit-handler":e.importMutes,"success-message":e.$t("settings.mutes_imported"),"error-message":e.$t("settings.mute_import_error")},null,8,["submit-handler","success-message","error-message"])]),n("div",kd,[n("h2",null,i(e.$t("settings.mute_export")),1),u(r,{"get-content":e.getMutesContent,filename:"mutes.csv","export-button-label":e.$t("settings.mute_export_button")},null,8,["get-content","export-button-label"])]),n("div",Cd,[n("h2",null,i(e.$t("settings.account_backup")),1),n("p",null,i(e.$t("settings.account_backup_description")),1),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,i(e.$t("settings.account_backup_table_head")),1),t[2]||(t[2]=n("th",null,null,-1))])]),n("tbody",null,[(m(!0),b(Y,null,se(e.backups,c=>(m(),b("tr",{key:c.id},[n("td",null,i(c.inserted_at),1),n("td",Td,[c.processed?(m(),b("a",{key:0,target:"_blank",href:c.url},i(e.$t("settings.download_backup")),9,Vd)):c.state==="running"?(m(),b("span",Sd,i(e.$t("settings.backup_running",{number:c.processed_number},c.processed_number)),1)):c.state==="failed"?(m(),b("span",Pd,i(e.$t("settings.backup_failed")),1)):(m(),b("span",Id,i(e.$t("settings.backup_not_ready")),1))])]))),128))])]),e.listBackupsError?(m(),b("div",Ed,[v(i(e.$t("settings.list_backups_error",{error:e.error}))+" ",1),n("button",{title:e.$t("settings.hide_list_backups_error_action"),onClick:t[0]||(t[0]=c=>e.listBackupsError=!1)},[u(h,{class:"fa-scale-110 fa-old-padding",icon:"times"})],8,Ad)])):V("",!0),n("button",{class:"btn button-default",onClick:t[1]||(t[1]=(...c)=>e.addBackup&&e.addBackup(...c))},i(e.$t("settings.add_backup")),1),e.addedBackup?(m(),b("p",_d,i(e.$t("settings.added_backup")),1)):V("",!0),e.addBackupError!==!1?(m(),b("p",Ld,i(e.$t("settings.add_backup_error",{error:e.addBackupError})),1)):V("",!0)])],8,gd)}const Ud=X(fd,[["render",Od]]);var es,Ao;function Rd(){if(Ao)return es;Ao=1;var e="Expected a function";function t(s){if(typeof s!="function")throw new TypeError(e);return function(){var o=arguments;switch(o.length){case 0:return!s.call(this);case 1:return!s.call(this,o[0]);case 2:return!s.call(this,o[0],o[1]);case 3:return!s.call(this,o[0],o[1],o[2])}return!s.apply(this,o)}}return es=t,es}var ts,_o;function Bd(){if(_o)return ts;_o=1;var e=xa(),t=ei(),s=ti(),o=ma(),l=Rd();function a(d,r){var h=o(d)?e:t;return h(d,l(s(r,3)))}return ts=a,ts}var Md=Bd();const Lo=un(Md),Fd=500,Dd={props:{query:{type:Function,required:!0},filter:{type:Function},placeholder:{type:String,default:"Search..."}},data(){return{term:"",timeout:null,results:[],resultsVisible:!1}},computed:{filtered(){return this.filter?this.filter(this.results):this.results}},watch:{term(e){this.fetchResults(e)}},methods:{fetchResults(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.results=[],e&&this.query(e).then(t=>{this.results=t})},Fd)},onInputClick(){this.resultsVisible=!0},onClickOutside(){this.resultsVisible=!1}}},Nd={class:"autosuggest"},jd=["placeholder"],qd={key:0,class:"panel autosuggest-results"};function zd(e,t,s,o,l,a){const d=si("click-outside");return x((m(),b("div",Nd,[x(n("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>e.term=r),placeholder:e.placeholder,class:"input autosuggest-input",onClick:t[1]||(t[1]=(...r)=>e.onInputClick&&e.onInputClick(...r))},null,8,jd),[[ie,e.term]]),e.resultsVisible&&e.filtered.length>0?(m(),b("div",qd,[(m(!0),b(Y,null,se(e.filtered,r=>Le(e.$slots,"default",{item:r})),256))])):V("",!0)])),[[d,e.onClickOutside]])}const _a=X(Dd,[["render",zd]]),Hd={props:["userId"],data(){return{progress:!1}},computed:{user(){return this.$store.getters.findUser(this.userId)},relationship(){return this.$store.getters.relationship(this.userId)},blocked(){return this.relationship.blocking}},components:{BasicUserCard:fa},methods:{unblockUser(){this.progress=!0,this.$store.dispatch("unblockUser",this.user.id).then(()=>{this.progress=!1})},blockUser(){this.progress=!0,this.$store.dispatch("blockUser",this.user.id).then(()=>{this.progress=!1})}}},Wd={class:"block-card-content-container"},Kd=["disabled"],Gd=["disabled"];function Yd(e,t,s,o,l,a){const d=P("basic-user-card");return m(),H(d,{user:e.user},{default:f(()=>[n("div",Wd,[e.blocked?(m(),b("button",{key:0,class:"btn button-default",disabled:e.progress,onClick:t[0]||(t[0]=(...r)=>e.unblockUser&&e.unblockUser(...r))},[e.progress?(m(),b(Y,{key:0},[v(i(e.$t("user_card.unblock_progress")),1)],64)):(m(),b(Y,{key:1},[v(i(e.$t("user_card.unblock")),1)],64))],8,Kd)):(m(),b("button",{key:1,class:"btn button-default",disabled:e.progress,onClick:t[1]||(t[1]=(...r)=>e.blockUser&&e.blockUser(...r))},[e.progress?(m(),b(Y,{key:0},[v(i(e.$t("user_card.block_progress")),1)],64)):(m(),b(Y,{key:1},[v(i(e.$t("user_card.block")),1)],64))],8,Gd))])]),_:1},8,["user"])}const Xd=X(Hd,[["render",Yd]]),Jd={props:["userId"],data(){return{progress:!1}},computed:{user(){return this.$store.getters.findUser(this.userId)},relationship(){return this.$store.getters.relationship(this.userId)},muted(){return this.relationship.muting}},components:{BasicUserCard:fa},methods:{unmuteUser(){this.progress=!0,this.$store.dispatch("unmuteUser",this.userId).then(()=>{this.progress=!1})},muteUser(){this.progress=!0,this.$store.dispatch("muteUser",this.userId).then(()=>{this.progress=!1})}}},Zd={class:"mute-card-content-container"},Qd=["disabled"],xd=["disabled"];function eu(e,t,s,o,l,a){const d=P("basic-user-card");return m(),H(d,{user:e.user},{default:f(()=>[n("div",Zd,[e.muted?(m(),b("button",{key:0,class:"btn button-default",disabled:e.progress,onClick:t[0]||(t[0]=(...r)=>e.unmuteUser&&e.unmuteUser(...r))},[e.progress?(m(),b(Y,{key:0},[v(i(e.$t("user_card.unmute_progress")),1)],64)):(m(),b(Y,{key:1},[v(i(e.$t("user_card.unmute")),1)],64))],8,Qd)):(m(),b("button",{key:1,class:"btn button-default",disabled:e.progress,onClick:t[1]||(t[1]=(...r)=>e.muteUser&&e.muteUser(...r))},[e.progress?(m(),b(Y,{key:0},[v(i(e.$t("user_card.mute_progress")),1)],64)):(m(),b(Y,{key:1},[v(i(e.$t("user_card.mute")),1)],64))],8,xd))])]),_:1},8,["user"])}const tu=X(Jd,[["render",eu]]),su={props:["domain"],components:{ProgressButton:Wt},computed:{user(){return this.$store.state.users.currentUser},muted(){return this.user.domainMutes.includes(this.domain)}},methods:{unmuteDomain(){return this.$store.dispatch("unmuteDomain",this.domain)},muteDomain(){return this.$store.dispatch("muteDomain",this.domain)}}},nu={class:"domain-mute-card"},ou={class:"domain-mute-card-domain"};function lu(e,t,s,o,l,a){const d=P("ProgressButton");return m(),b("div",nu,[n("div",ou,i(e.domain),1),e.muted?(m(),H(d,{key:0,click:e.unmuteDomain,class:"btn button-default"},{progress:f(()=>[v(i(e.$t("domain_mute_card.unmute_progress")),1)]),default:f(()=>[v(i(e.$t("domain_mute_card.unmute"))+" ",1)]),_:1},8,["click"])):(m(),H(d,{key:1,click:e.muteDomain,class:"btn button-default"},{progress:f(()=>[v(i(e.$t("domain_mute_card.mute_progress")),1)]),default:f(()=>[v(i(e.$t("domain_mute_card.mute"))+" ",1)]),_:1},8,["click"]))])}const au=X(su,[["render",lu]]),iu={components:{List:ni,Checkbox:pe},props:{items:{type:Array,default:()=>[]},getKey:{type:Function,default:e=>e.id}},data(){return{selected:[]}},computed:{allKeys(){return this.items.map(this.getKey)},filteredSelected(){return this.allKeys.filter(e=>this.selected.indexOf(e)!==-1)},allSelected(){return this.filteredSelected.length===this.items.length},noneSelected(){return this.filteredSelected.length===0},someSelected(){return!this.allSelected&&!this.noneSelected}},methods:{isSelected(e){return this.filteredSelected.indexOf(this.getKey(e))!==-1},toggle(e,t){const s=this.getKey(t),o=this.isSelected(s);e!==o&&(e?this.selected.push(s):this.selected.splice(this.selected.indexOf(s),1))},toggleAll(e){e?this.selected=this.allKeys.slice(0):this.selected=[]}}},ru={class:"selectable-list"},du={key:0,class:"selectable-list-header"},uu={class:"selectable-list-checkbox-wrapper"},cu={class:"selectable-list-header-actions"},hu=["onClick"],pu={class:"selectable-list-checkbox-wrapper"};function mu(e,t,s,o,l,a){const d=P("Checkbox"),r=P("List");return m(),b("div",ru,[e.items.length>0?(m(),b("div",du,[n("div",uu,[u(d,{"model-value":e.allSelected,indeterminate:e.someSelected,"onUpdate:modelValue":e.toggleAll},{default:f(()=>[v(i(e.$t("selectable_list.select_all")),1)]),_:1},8,["model-value","indeterminate","onUpdate:modelValue"])]),n("div",cu,[Le(e.$slots,"header",{selected:e.filteredSelected})])])):V("",!0),u(r,{items:e.items,"get-key":e.getKey,"get-class":h=>e.isSelected(h)?"-active":""},{item:f(({item:h})=>[n("div",{class:W(["selectable-list-item-inner",{"selectable-list-item-selected-inner":e.isSelected(h)}]),onClick:To(c=>e.toggle(!e.isSelected(h),h),["stop"])},[n("div",pu,[u(d,{"model-value":e.isSelected(h),"onUpdate:modelValue":c=>e.toggle(c,h),onClick:t[0]||(t[0]=To(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"])]),Le(e.$slots,"item",{item:h})],10,hu)]),empty:f(()=>[Le(e.$slots,"empty")]),_:3},8,["items","get-key","get-class"])])}const $n=X(iu,[["render",mu]]);function fu(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ii(e)}ue.add(vt);const gu=({fetch:e,select:t,childPropName:s="content",additionalPropNames:o=[]})=>l=>({props:[...Object.keys(oi(l)).filter(r=>r!==s).concat(o),"refresh"],data(){return{loading:!1,error:!1}},computed:{fetchedData(){return t(this.$props,this.$store)}},created(){(this.refresh||ai(this.fetchedData))&&this.fetchData()},methods:{fetchData(){this.loading||(this.loading=!0,this.error=!1,e(this.$props,this.$store).then(()=>{this.loading=!1}).catch(()=>{this.error=!0,this.loading=!1}))}},render(){if(!this.error&&!this.loading){const r={...this.$props,[s]:this.fetchedData},h=this.$slots;return u("div",{class:"with-subscription"},[u(l,r,fu(h)?h:{default:()=>[h]})])}else return u("div",{class:"with-subscription-loading"},[this.error?u("a",{onClick:this.fetchData,class:"alert error"},[this.$t("general.generic_error")]):u(li,{spin:!0,icon:"circle-notch"},null)])}}),bu=ga({fetch:(e,t)=>t.dispatch("fetchBlocks"),select:(e,t)=>cn(t.state.users.currentUser,"blockIds",[]),childPropName:"items"})($n),vu=ga({fetch:(e,t)=>t.dispatch("fetchMutes"),select:(e,t)=>cn(t.state.users.currentUser,"muteIds",[]),childPropName:"items"})($n),$u=gu({fetch:(e,t)=>t.dispatch("fetchDomainMutes"),select:(e,t)=>cn(t.state.users.currentUser,"domainMutes",[]),childPropName:"items"})($n),yu={data(){return{activeTab:"profile"}},created(){gt().fetchTokens(),this.$store.dispatch("getKnownDomains")},components:{TabSwitcher:Kt,BlockList:bu,MuteList:vu,DomainMuteList:$u,BlockCard:Xd,MuteCard:tu,DomainMuteCard:au,ProgressButton:Wt,Autosuggest:_a,Checkbox:pe},computed:{knownDomains(){return this.$store.state.instance.knownDomains},user(){return this.$store.state.users.currentUser}},methods:{importFollows(e){return this.$store.state.api.backendInteractor.importFollows({file:e}).then(t=>{if(!t)throw new Error("failed")})},importBlocks(e){return this.$store.state.api.backendInteractor.importBlocks({file:e}).then(t=>{if(!t)throw new Error("failed")})},generateExportableUsersContent(e){return e.map(t=>t&&t.is_local?t.screen_name+"@"+location.hostname:t.screen_name).join(`
`)},activateTab(e){this.activeTab=e},filterUnblockedUsers(e){return Lo(e,t=>this.$store.getters.relationship(this.userId).blocking||t===this.user.id)},filterUnMutedUsers(e){return Lo(e,t=>this.$store.getters.relationship(this.userId).muting||t===this.user.id)},queryUserIds(e){return this.$store.dispatch("searchUsers",{query:e}).then(t=>ri(t,"id"))},blockUsers(e){return this.$store.dispatch("blockUsers",e)},unblockUsers(e){return this.$store.dispatch("unblockUsers",e)},muteUsers(e){return this.$store.dispatch("muteUsers",e)},unmuteUsers(e){return this.$store.dispatch("unmuteUsers",e)},filterUnMutedDomains(e){return e.filter(t=>!this.user.domainMutes.includes(t))},queryKnownDomains(e){return new Promise(t=>{t(this.knownDomains.filter(s=>s.toLowerCase().includes(e)))})},unmuteDomains(e){return this.$store.dispatch("unmuteDomains",e)}}},wu=["label"],ku={class:"usersearch-wrapper"},Cu={class:"bulk-actions"},Tu=["label"],Vu=["label"],Su={class:"usersearch-wrapper"},Pu={class:"bulk-actions"},Iu=["label"],Eu={class:"domain-mute-form"},Au={class:"bulk-actions"};function _u(e,t,s,o,l,a){const d=P("BlockCard"),r=P("Autosuggest"),h=P("ProgressButton"),c=P("BlockList"),p=P("MuteCard"),$=P("MuteList"),w=P("DomainMuteCard"),y=P("DomainMuteList"),k=P("tab-switcher");return m(),H(k,{"scrollable-tabs":!0,class:"mutes-and-blocks-tab"},{default:f(()=>[n("div",{label:e.$t("settings.blocks_tab")},[n("div",ku,[u(r,{filter:e.filterUnblockedUsers,query:e.queryUserIds,placeholder:e.$t("settings.search_user_to_block")},{default:f(S=>[u(d,{"user-id":S.item},null,8,["user-id"])]),_:1},8,["filter","query","placeholder"])]),u(c,{refresh:!0,"get-key":S=>S},{header:f(({selected:S})=>[n("div",Cu,[S.length>0?(m(),H(h,{key:0,class:"btn button-default bulk-action-button",click:()=>e.blockUsers(S)},{progress:f(()=>[v(i(e.$t("user_card.block_progress")),1)]),default:f(()=>[v(i(e.$t("user_card.block"))+" ",1)]),_:2},1032,["click"])):V("",!0),S.length>0?(m(),H(h,{key:1,class:"btn button-default",click:()=>e.unblockUsers(S)},{progress:f(()=>[v(i(e.$t("user_card.unblock_progress")),1)]),default:f(()=>[v(i(e.$t("user_card.unblock"))+" ",1)]),_:2},1032,["click"])):V("",!0)])]),item:f(({item:S})=>[u(d,{"user-id":S},null,8,["user-id"])]),empty:f(()=>[v(i(e.$t("settings.no_blocks")),1)]),_:1},8,["get-key"])],8,wu),n("div",{label:e.$t("settings.mutes_tab")},[u(k,null,{default:f(()=>[n("div",{label:e.$t("settings.user_mutes")},[n("div",Su,[u(r,{filter:e.filterUnMutedUsers,query:e.queryUserIds,placeholder:e.$t("settings.search_user_to_mute")},{default:f(S=>[u(p,{"user-id":S.item},null,8,["user-id"])]),_:1},8,["filter","query","placeholder"])]),u($,{refresh:!0,"get-key":S=>S},{header:f(({selected:S})=>[n("div",Pu,[S.length>0?(m(),H(h,{key:0,class:"btn button-default",click:()=>e.muteUsers(S)},{progress:f(()=>[v(i(e.$t("user_card.mute_progress")),1)]),default:f(()=>[v(i(e.$t("user_card.mute"))+" ",1)]),_:2},1032,["click"])):V("",!0),S.length>0?(m(),H(h,{key:1,class:"btn button-default",click:()=>e.unmuteUsers(S)},{progress:f(()=>[v(i(e.$t("user_card.unmute_progress")),1)]),default:f(()=>[v(i(e.$t("user_card.unmute"))+" ",1)]),_:2},1032,["click"])):V("",!0)])]),item:f(({item:S})=>[u(p,{"user-id":S},null,8,["user-id"])]),empty:f(()=>[v(i(e.$t("settings.no_mutes")),1)]),_:1},8,["get-key"])],8,Vu),n("div",{label:e.$t("settings.domain_mutes")},[n("div",Eu,[u(r,{filter:e.filterUnMutedDomains,query:e.queryKnownDomains,placeholder:e.$t("settings.type_domains_to_mute")},{default:f(S=>[u(w,{domain:S.item},null,8,["domain"])]),_:1},8,["filter","query","placeholder"])]),u(y,{refresh:!0,"get-key":S=>S},{header:f(({selected:S})=>[n("div",Au,[S.length>0?(m(),H(h,{key:0,class:"btn button-default",click:()=>e.unmuteDomains(S)},{progress:f(()=>[v(i(e.$t("domain_mute_card.unmute_progress")),1)]),default:f(()=>[v(i(e.$t("domain_mute_card.unmute"))+" ",1)]),_:2},1032,["click"])):V("",!0)])]),item:f(({item:S})=>[u(w,{domain:S},null,8,["domain"])]),empty:f(()=>[v(i(e.$t("settings.no_mutes")),1)]),_:1},8,["get-key"])],8,Iu)]),_:1})],8,Tu)]),_:1})}const Lu=X(yu,[["render",_u]]),Ou={data(){return{activeTab:"profile",notificationSettings:this.$store.state.users.currentUser.notification_settings,newDomainToMute:""}},components:{BooleanSetting:wt},computed:{user(){return this.$store.state.users.currentUser},canReceiveReports(){return this.user?this.user.privileges.includes("reports_manage_reports"):!1},...yt()},methods:{updateNotificationSettings(){this.$store.state.api.backendInteractor.updateNotificationSettings({settings:this.notificationSettings})}}},Uu=["label"],Ru={class:"setting-item"},Bu={class:"setting-list"},Mu={class:"setting-item"},Fu={class:"setting-list"},Du={key:0},Nu={class:"setting-list two-column"},ju={class:"setting-list"},qu={class:"setting-list"},zu={class:"setting-list"},Hu={class:"setting-list"},Wu={class:"setting-list"},Ku={class:"setting-list"},Gu={class:"setting-list"},Yu={class:"setting-list"},Xu={class:"setting-list"},Ju={key:0},Zu={class:"setting-list"},Qu={class:"setting-list suboptions"},xu={key:0,class:"setting-item"},ec={class:"setting-list"},tc={class:"setting-list suboptions"},sc={class:"setting-item"};function nc(e,t,s,o,l,a){const d=P("BooleanSetting");return m(),b("div",{label:e.$t("settings.notifications")},[n("div",Ru,[n("h2",null,i(e.$t("settings.notification_setting_annoyance")),1),n("ul",Bu,[n("li",null,[u(d,{path:"closingDrawerMarksAsSeen"},{default:f(()=>[v(i(e.$t("settings.notification_setting_drawer_marks_as_seen")),1)]),_:1})]),n("li",null,[u(d,{path:"ignoreInactionableSeen"},{default:f(()=>[v(i(e.$t("settings.notification_setting_ignore_inactionable_seen")),1)]),_:1}),n("div",null,[n("small",null,i(e.$t("settings.notification_setting_ignore_inactionable_seen_tip")),1)])]),n("li",null,[u(d,{path:"unseenAtTop",expert:"1"},{default:f(()=>[v(i(e.$t("settings.notification_setting_unseen_at_top")),1)]),_:1})])])]),n("div",Mu,[n("h2",null,i(e.$t("settings.notification_setting_filters")),1),n("ul",Fu,[n("li",null,[u(d,{source:"profile",path:"blockNotificationsFromStrangers"},{default:f(()=>[v(i(e.$t("settings.notification_setting_block_from_strangers")),1)]),_:1})]),n("li",null,[n("h3",null,i(e.$t("settings.notification_visibility")),1),e.expertLevel>0?(m(),b("p",Du,i(e.$t("settings.notification_setting_filters_chrome_push")),1)):V("",!0),n("ul",Nu,[n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_mentions")),1),n("ul",ju,[n("li",null,[u(d,{path:"notificationVisibility.mentions"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.mentions"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_statuses")),1),n("ul",qu,[n("li",null,[u(d,{path:"notificationVisibility.statuses"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.statuses"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_likes")),1),n("ul",zu,[n("li",null,[u(d,{path:"notificationVisibility.likes"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.likes"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_repeats")),1),n("ul",Hu,[n("li",null,[u(d,{path:"notificationVisibility.repeats"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.repeats"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_emoji_reactions")),1),n("ul",Wu,[n("li",null,[u(d,{path:"notificationVisibility.emojiReactions"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.emojiReactions"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_follows")),1),n("ul",Ku,[n("li",null,[u(d,{path:"notificationVisibility.follows"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.follows"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_follow_requests")),1),n("ul",Gu,[n("li",null,[u(d,{path:"notificationVisibility.followRequest"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.followRequest"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_moves")),1),n("ul",Yu,[n("li",null,[u(d,{path:"notificationVisibility.moves"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.moves"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),n("li",null,[n("h4",null,i(e.$t("settings.notification_visibility_polls")),1),n("ul",Xu,[n("li",null,[u(d,{path:"notificationVisibility.polls"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.polls"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])]),e.canReceiveReports?(m(),b("li",Ju,[n("h4",null,i(e.$t("settings.notification_visibility_reports")),1),n("ul",Zu,[n("li",null,[u(d,{path:"notificationVisibility.reports"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_in_column")),1)]),_:1})]),n("li",null,[u(d,{path:"notificationNative.reports"},{default:f(()=>[v(i(e.$t("settings.notification_visibility_native_notifications")),1)]),_:1})])])])):V("",!0)])]),n("li",null,[u(d,{path:"showExtraNotifications"},{default:f(()=>[v(i(e.$t("settings.notification_show_extra")),1)]),_:1})]),n("li",null,[n("ul",Qu,[n("li",null,[u(d,{path:"showChatsInExtraNotifications",disabled:!e.mergedConfig.showExtraNotifications},{default:f(()=>[v(i(e.$t("settings.notification_extra_chats")),1)]),_:1},8,["disabled"])]),n("li",null,[u(d,{path:"showAnnouncementsInExtraNotifications",disabled:!e.mergedConfig.showExtraNotifications},{default:f(()=>[v(i(e.$t("settings.notification_extra_announcements")),1)]),_:1},8,["disabled"])]),n("li",null,[u(d,{path:"showFollowRequestsInExtraNotifications",disabled:!e.mergedConfig.showExtraNotifications},{default:f(()=>[v(i(e.$t("settings.notification_extra_follow_requests")),1)]),_:1},8,["disabled"])]),n("li",null,[u(d,{path:"showExtraNotificationsTip",disabled:!e.mergedConfig.showExtraNotifications},{default:f(()=>[v(i(e.$t("settings.notification_extra_tip")),1)]),_:1},8,["disabled"])])])])])]),e.expertLevel>0?(m(),b("div",xu,[n("h2",null,i(e.$t("settings.notification_setting_privacy")),1),n("ul",ec,[n("li",null,[u(d,{path:"webPushNotifications",expert:"1"},{default:f(()=>[v(i(e.$t("settings.enable_web_push_notifications")),1)]),_:1}),n("ul",tc,[n("li",null,[u(d,{path:"webPushAlwaysShowNotifications",disabled:!e.mergedConfig.webPushNotifications},{default:f(()=>[v(i(e.$t("settings.enable_web_push_always_show")),1)]),_:1},8,["disabled"]),n("div",{class:W({faint:!e.mergedConfig.webPushNotifications})},[n("small",null,i(e.$t("settings.enable_web_push_always_show_tip")),1)],2)])])]),n("li",null,[u(d,{source:"profile",path:"webPushHideContents",expert:"1"},{default:f(()=>[v(i(e.$t("settings.notification_setting_hide_notification_contents")),1)]),_:1})])])])):V("",!0),n("div",sc,[n("p",null,i(e.$t("settings.notification_mutes")),1),n("p",null,i(e.$t("settings.notification_blocks")),1)])],8,Uu)}const oc=X(Ou,[["render",nc]]),lc=["cm","mm","in","px","pt","pc","em","ex","ch","rem","vw","vh","vmin","vmax","%"],ac={..._e,components:{..._e.components,Select:qe},props:{..._e.props,min:Number,units:{type:Array,default:()=>lc},unitSet:{type:String,default:"none"},step:{type:Number,default:1},resetDefault:{type:Object,default:null}},computed:{..._e.computed,stateUnit(){return typeof this.state=="string"?this.state.replace(/[0-9,.]+/,""):""},stateValue(){return typeof this.state=="string"?this.state.replace(/[^0-9,.]+/,""):""}},methods:{..._e.methods,getUnitString(e){return this.unitSet==="none"?e:this.$t(["settings","units",this.unitSet,e].join("."))},updateValue(e){this.configSink(this.path,parseFloat(e.target.value)+this.stateUnit)},updateUnit(e){let t=this.stateValue;const s=e.target.value;if(this.resetDefault){const o=this.resetDefault[s];o!=null&&(t=o)}this.configSink(this.path,t+s)}}},ic={key:0,class:"UnitSetting"},rc=["for"],dc={class:"no-break"},uc=["id","step","disabled","min","value"],cc=["value"];function hc(e,t,s,o,l,a){const d=P("Select"),r=P("ModifiedIndicator");return e.matchesExpertLevel?(m(),b("span",ic,[n("label",{for:e.path,class:"size-label"},[Le(e.$slots,"default")],8,rc),t[1]||(t[1]=v(" "+i(" ")+" ")),n("span",dc,[n("input",{id:e.path,class:"input number-input",type:"number",step:e.step,disabled:e.disabled,min:e.min||0,value:e.stateValue,onChange:t[0]||(t[0]=(...h)=>e.updateValue&&e.updateValue(...h))},null,40,uc),u(d,{id:e.path,"model-value":e.stateUnit,disabled:e.disabled,class:"unit-input unstyled",onChange:e.updateUnit},{default:f(()=>[(m(!0),b(Y,null,se(e.units,h=>(m(),b("option",{key:h,value:h},i(e.getUnitString(h)),9,cc))),128))]),_:1},8,["id","model-value","disabled","onChange"])]),t[2]||(t[2]=v(" "+i(" ")+" ")),u(r,{changed:e.isChanged,onclick:e.reset},null,8,["changed","onclick"])])):V("",!0)}const yn=X(ac,[["render",hc]]);ue.add(di);const pc={components:{Popover:Gt}},mc={class:"HelpIndicator"},fc={class:"help-tooltip"};function gc(e,t,s,o,l,a){const d=P("FAIcon"),r=P("Popover");return m(),b("span",mc,[u(r,{trigger:"click","trigger-attrs":{"aria-label":e.$t("settings.setting_changed")}},{trigger:f(()=>[t[0]||(t[0]=v("   ")),u(d,{icon:"circle-question"})]),content:f(()=>[n("div",fc,[Le(e.$slots,"default")])]),_:3},8,["trigger-attrs"])])}const bc=X(pc,[["render",gc]]),vc=new Set(["word","regexp","user","user_regexp"]),$c={data(){return{replyVisibilityOptions:["all","following","self"].map(e=>({key:e,value:e,label:this.$t(`settings.reply_visibility_${e}`)})),muteFiltersDraftObject:ae.cloneDeep(It().prefsStorage.simple.muteFilters),muteFiltersDraftDirty:Object.fromEntries(Object.entries(It().prefsStorage.simple.muteFilters).map(([e])=>[e,!1])),exportedFilter:null,filterImporter:kt({validator(e){return!(Array.isArray(e)||!vc.has(e.type))},onImport:e=>{const{enabled:t=!0,expires:s=null,hide:o=!1,name:l="",value:a=""}=e;this.createFilter({enabled:t,expires:s,hide:o,name:l,value:a})},onImportFailure(e){console.error("Failure importing filter:",e),Q().pushGlobalNotice({messageKey:"settings.filter.import_failure",level:"error"})}}),filterExporter:Yt({filename:"pleromafe_mute-filter",getExportedObject:()=>this.exportedFilter})}},components:{BooleanSetting:wt,ChoiceSetting:vn,UnitSetting:yn,IntegerSetting:bn,Checkbox:pe,Select:qe,HelpIndicator:bc},computed:{...yt(),...ui(It,{muteFilters:e=>Object.entries(e.prefsStorage.simple.muteFilters),muteFiltersObject:e=>e.prefsStorage.simple.muteFilters}),muteFiltersDraft(){return Object.entries(this.muteFiltersDraftObject)},muteFiltersExpired(){const e=Date.now();return Object.entries(this.muteFiltersDraftObject).filter(([,{expires:t}])=>t!=null&&t<=e)}},methods:{...ba(It,["setPreference","unsetPreference","pushServerSideStorage"]),getDatetimeLocal(e){const t=new Date(e);let s=new Intl.NumberFormat("en-US",{minimumIntegerDigits:2});return[t.getFullYear(),"-",s.format(t.getMonth()+1),"-",s.format(t.getDate()),"T",s.format(t.getHours()),":",s.format(t.getMinutes())].join("")},checkRegexValid(e){const t=this.muteFiltersObject[e];if(t.type!=="regexp"||t.type!=="user_regexp")return!0;const{value:s}=t;let o=!0;try{new RegExp(s)}catch{o=!1,console.error("Invalid RegExp: "+s)}return o},createFilter(e={type:"word",value:"",name:"New Filter",enabled:!0,expires:null,hide:!1}){const t=Vo();e.order=this.muteFilters.length+2,this.muteFiltersDraftObject[t]=e,this.setPreference({path:"simple.muteFilters."+t,value:e}),this.pushServerSideStorage()},exportFilter(e){this.exportedFilter={...this.muteFiltersDraftObject[e]},delete this.exportedFilter.order,this.filterExporter.exportData()},importFilter(){this.filterImporter.importData()},copyFilter(e){const t={...this.muteFiltersDraftObject[e]},s=Vo();this.muteFiltersDraftObject[s]=t,this.setPreference({path:"simple.muteFilters."+s,value:t}),this.pushServerSideStorage()},deleteFilter(e){delete this.muteFiltersDraftObject[e],this.unsetPreference({path:"simple.muteFilters."+e,value:null}),this.pushServerSideStorage()},purgeExpiredFilters(){this.muteFiltersExpired.forEach(([e])=>{console.log(e),delete this.muteFiltersDraftObject[e],this.unsetPreference({path:"simple.muteFilters."+e,value:null})}),this.pushServerSideStorage()},updateFilter(e,t,s){const o={...this.muteFiltersDraftObject[e]};if(t==="expires-never")if(s)o.expires=null;else{const a=Date.now()+12096e5;o.expires=a}else if(t==="expires"){const l=Date.parse(s);o.expires=l.valueOf()}else o[t]=s;this.muteFiltersDraftObject[e]=o,this.muteFiltersDraftDirty[e]=!0},saveFilter(e){this.setPreference({path:"simple.muteFilters."+e,value:this.muteFiltersDraftObject[e]}),this.pushServerSideStorage(),this.muteFiltersDraftDirty[e]=!1}},watch:{replyVisibility(){this.$store.dispatch("queueFlushAll")}}},yc=["label"],wc={class:"setting-item"},kc={class:"setting-list"},Cc={class:"setting-list suboptions"},Tc={class:"setting-item"},Vc={class:"setting-list"},Sc={class:"setting-list suboptions"},Pc={class:"muteFiltersActions"},Ic={class:"total"},Ec={class:"muteFilterContainer"},Ac={class:"filter-name"},_c=["for"],Lc=["id","value","onInput"],Oc={key:0,class:"alert neutral"},Uc={class:"filter-enabled"},Rc={class:"filter-type filter-field"},Bc=["for"],Mc=["href"],Fc={value:"word"},Dc={value:"regexp"},Nc={value:"user"},jc={value:"user_regexp"},qc={class:"filter-value filter-field"},zc=["for"],Hc=["id","value","onInput"],Wc={class:"filter-expires filter-field"},Kc=["for"],Gc={class:"filter-field-value"},Yc=["id","disabled","value","onInput"],Xc={key:0,class:"alert error"},Jc={class:"filter-buttons"},Zc=["onClick"],Qc=["onClick"],xc=["onClick"],eh=["disabled","onClick"],th={class:"muteFiltersActionsBottom"},sh={class:"total"},nh=["disabled"];function oh(e,t,s,o,l,a){const d=P("ChoiceSetting"),r=P("BooleanSetting"),h=P("UnitSetting"),c=P("IntegerSetting"),p=P("Checkbox"),$=P("i18n-t"),w=P("HelpIndicator"),y=P("Select");return m(),b("div",{label:e.$t("settings.filtering"),class:"filtering-tab"},[n("div",wc,[n("h2",null,i(e.$t("settings.filter.clutter")),1),n("ul",kc,[n("li",null,[e.user?(m(),H(d,{key:0,id:"replyVisibility",path:"replyVisibility",options:e.replyVisibilityOptions},{default:f(()=>[v(i(e.$t("settings.replies_in_timeline")),1)]),_:1},8,["options"])):V("",!0)]),n("li",null,[u(r,{expert:"1",path:"hidePostStats"},{default:f(()=>[v(i(e.$t("settings.hide_post_stats")),1)]),_:1})]),n("li",null,[u(r,{expert:"1",path:"hideUserStats"},{default:f(()=>[v(i(e.$t("settings.hide_user_stats")),1)]),_:1})]),n("li",null,[u(r,{path:"hideBotIndication"},{default:f(()=>[v(i(e.$t("settings.hide_actor_type_indication")),1)]),_:1})]),n("li",null,[u(r,{path:"hideScrobbles"},{default:f(()=>[v(i(e.$t("settings.hide_scrobbles")),1)]),_:1}),n("ul",Cc,[n("li",null,[u(h,{key:"hideScrobblesAfter",path:"hideScrobblesAfter",units:["m","h","d"],"unit-set":"time",expert:"1"},{default:f(()=>[v(i(e.$t("settings.hide_scrobbles_after")),1)]),_:1})])])]),n("h3",null,i(e.$t("settings.attachments")),1),n("li",null,[u(c,{path:"maxThumbnails",expert:"1",min:0},{default:f(()=>[v(i(e.$t("settings.max_thumbnails")),1)]),_:1})]),n("li",null,[u(r,{path:"hideAttachments"},{default:f(()=>[v(i(e.$t("settings.hide_attachments_in_tl")),1)]),_:1})]),n("li",null,[u(r,{path:"hideAttachmentsInConv"},{default:f(()=>[v(i(e.$t("settings.hide_attachments_in_convo")),1)]),_:1})])])]),n("div",Tc,[n("h2",null,i(e.$t("settings.filter.mute_filter")),1),n("ul",Vc,[n("li",null,[u(r,{path:"hideFilteredStatuses"},{default:f(()=>[v(i(e.$t("settings.hide_muted_statuses")),1)]),_:1}),n("ul",Sc,[n("li",null,[u(r,{"parent-path":"hideFilteredStatuses","parent-invert":!0,path:"hideWordFilteredPosts",expert:"1"},{default:f(()=>[v(i(e.$t("settings.hide_filtered_statuses")),1)]),_:1})]),n("li",null,[e.user?(m(),H(r,{key:0,"parent-path":"hideFilteredStatuses","parent-invert":!0,path:"hideMutedThreads"},{default:f(()=>[v(i(e.$t("settings.hide_muted_threads")),1)]),_:1})):V("",!0)]),n("li",null,[e.user?(m(),H(r,{key:0,"parent-path":"hideFilteredStatuses","parent-invert":!0,path:"hideMutedPosts"},{default:f(()=>[v(i(e.$t("settings.hide_muted_posts")),1)]),_:1})):V("",!0)])])]),n("li",null,[u(r,{path:"muteBotStatuses"},{default:f(()=>[v(i(e.$t("settings.mute_bot_posts")),1)]),_:1})]),n("li",null,[u(r,{path:"muteSensitiveStatuses"},{default:f(()=>[v(i(e.$t("settings.mute_sensitive_posts")),1)]),_:1})]),n("li",null,[n("h3",null,i(e.$t("settings.filter.custom_filters")),1),n("p",Pc,[n("span",Ic,i(e.$t("settings.filter.total_count",{count:e.muteFiltersDraft.length})),1),n("button",{class:"add-button button-default",type:"button",onClick:t[0]||(t[0]=k=>e.createFilter())},i(e.$t("settings.filter.new")),1),n("button",{class:"add-button button-default",type:"button",onClick:t[1]||(t[1]=k=>e.importFilter())},i(e.$t("settings.filter.import")),1)]),n("div",Ec,[(m(!0),b(Y,null,se(e.muteFiltersDraft,k=>(m(),b("div",{key:k[0],class:"mute-filter",style:Oe({order:k[1].order})},[n("div",Ac,[n("label",{for:"filterName"+k[0]},i(e.$t("settings.filter.name")),9,_c),t[3]||(t[3]=v(" "+i(" ")+" ")),n("input",{id:"filterName"+k[0],class:"input",value:k[1].name,onInput:S=>e.updateFilter(k[0],"name",S.target.value)},null,40,Lc),k[1].expires!==null&&Date.now()>k[1].expires?(m(),b("span",Oc,i(e.$t("settings.filter.expired")),1)):V("",!0)]),n("div",Uc,[u(p,{id:"filterHide"+k[0],"model-value":k[1].hide,name:"filterHide"+k[0],"onUpdate:modelValue":S=>e.updateFilter(k[0],"hide",S)},{default:f(()=>[v(i(e.$t("settings.filter.hide")),1)]),_:2},1032,["id","model-value","name","onUpdate:modelValue"]),t[4]||(t[4]=v(" "+i(" ")+" ")),u(p,{id:"filterEnabled"+k[0],"model-value":k[1].enabled,name:"filterEnabled"+k[0],"onUpdate:modelValue":S=>e.updateFilter(k[0],"enabled",S)},{default:f(()=>[v(i(e.$t("settings.enabled")),1)]),_:2},1032,["id","model-value","name","onUpdate:modelValue"])]),n("div",Rc,[n("label",{for:"filterType"+k[0]},[u(w,null,{default:f(()=>[n("p",null,i(e.$t("settings.filter.help.word")),1),n("p",null,i(e.$t("settings.filter.help.user")),1),u($,{keypath:"settings.filter.help.regexp",tag:"p"},{link:f(()=>[n("a",{href:e.$t("settings.filter.help.regexp_url"),target:"_blank"},i(e.$t("settings.filter.help.regexp_link")),9,Mc)]),_:1})]),_:1}),v(" "+i(e.$t("settings.filter.type")),1)],8,Bc),u(y,{id:"filterType"+k[0],class:"filter-field-value","model-value":k[1].type,"onUpdate:modelValue":S=>e.updateFilter(k[0],"type",S)},{default:f(()=>[n("option",Fc,i(e.$t("settings.filter.plain")),1),n("option",Dc,i(e.$t("settings.filter.regexp")),1),n("option",Nc,i(e.$t("settings.filter.user")),1),n("option",jc,i(e.$t("settings.filter.user_regexp")),1)]),_:2},1032,["id","model-value","onUpdate:modelValue"])]),n("div",qc,[n("label",{for:"filterValue"+k[0]},i(e.$t("settings.filter.value")),9,zc),t[5]||(t[5]=v(" "+i(" ")+" ")),n("input",{id:"filterValue"+k[0],class:"input filter-field-value",value:k[1].value,onInput:S=>e.updateFilter(k[0],"value",S.target.value)},null,40,Hc)]),n("div",Wc,[n("label",{for:"filterExpires"+k[0]},i(e.$t("settings.filter.expires")),9,Kc),t[7]||(t[7]=v(" "+i(" ")+" ")),n("div",Gc,[n("input",{id:"filterExpires"+k[0],class:W(["input",{disabled:k[1].expires===null}]),type:"datetime-local",disabled:k[1].expires===null,value:k[1].expires?e.getDatetimeLocal(k[1].expires):null,onInput:S=>e.updateFilter(k[0],"expires",S.target.value)},null,42,Yc),t[6]||(t[6]=v(" "+i(" ")+" ")),u(p,{id:"filterExpiresNever"+k[0],"model-value":k[1].expires===null,name:"filterExpiresNever"+k[0],class:"input-inset input-boolean never","onUpdate:modelValue":S=>e.updateFilter(k[0],"expires-never",S)},{default:f(()=>[v(i(e.$t("settings.filter.never_expires")),1)]),_:2},1032,["id","model-value","name","onUpdate:modelValue"])])]),e.checkRegexValid(k[0])?V("",!0):(m(),b("div",Xc,i(e.$t("settings.filter.regexp_error")),1)),n("div",Jc,[n("button",{class:"delete-button button-default -danger",type:"button",onClick:S=>e.deleteFilter(k[0])},i(e.$t("settings.filter.delete")),9,Zc),n("button",{class:"export-button button-default",type:"button",onClick:S=>e.exportFilter(k[0])},i(e.$t("settings.filter.export")),9,Qc),n("button",{class:"copy-button button-default",type:"button",onClick:S=>e.copyFilter(k[0])},i(e.$t("settings.filter.copy")),9,xc),n("button",{class:W(["save-button button-default",{disabled:!e.muteFiltersDraftDirty[k[0]]}]),disabled:!e.muteFiltersDraftDirty[k[0]],type:"button",onClick:S=>e.saveFilter(k[0])},i(e.$t("settings.filter.save")),11,eh)])],4))),128))]),n("p",th,[n("span",sh,i(e.$t("settings.filter.expired_count",{count:e.muteFiltersExpired.length})),1),n("button",{class:W(["add-button button-default",{disabled:e.muteFiltersExpired.length===0}]),type:"button",disabled:e.muteFiltersExpired.length===0,onClick:t[2]||(t[2]=k=>e.purgeExpiredFilters())},i(e.$t("settings.filter.purge_expired")),11,nh)])])])])],8,yc)}const lh=X($c,[["render",oh]]),ah={props:{backupCodes:{type:Object,default:()=>({inProgress:!1,codes:[]})}},data:()=>({}),computed:{inProgress(){return this.backupCodes.inProgress},ready(){return this.backupCodes.codes.length>0},displayTitle(){return this.inProgress||this.ready}}},ih={class:"mfa-backup-codes"},rh={key:0},dh={key:1},uh={class:"alert warning"},ch={class:"backup-codes"};function hh(e,t,s,o,l,a){return m(),b("div",ih,[e.displayTitle?(m(),b("h4",rh,i(e.$t("settings.mfa.recovery_codes")),1)):V("",!0),e.inProgress?(m(),b("i",dh,i(e.$t("settings.mfa.waiting_a_recovery_codes")),1)):V("",!0),e.ready?(m(),b(Y,{key:2},[n("p",uh,i(e.$t("settings.mfa.recovery_codes_warning")),1),n("ul",ch,[(m(!0),b(Y,null,se(e.backupCodes.codes,d=>(m(),b("li",{key:d},i(d),1))),128))])],64)):V("",!0)])}const ph=X(ah,[["render",hh]]),mh={props:["disabled"],data:()=>({}),methods:{confirm(){this.$emit("confirm")},cancel(){this.$emit("cancel")}}},fh=["disabled"],gh=["disabled"];function bh(e,t,s,o,l,a){return m(),b("div",null,[Le(e.$slots,"default"),n("button",{class:"btn button-default",disabled:e.disabled,onClick:t[0]||(t[0]=(...d)=>e.confirm&&e.confirm(...d))},i(e.$t("general.confirm")),9,fh),n("button",{class:"btn button-default",disabled:e.disabled,onClick:t[1]||(t[1]=(...d)=>e.cancel&&e.cancel(...d))},i(e.$t("general.cancel")),9,gh)])}const La=X(mh,[["render",bh]]),vh={props:["settings"],data:()=>({error:!1,currentPassword:"",deactivate:!1,inProgress:!1}),components:{confirm:La},computed:{isActivated(){return this.settings.totp},...dn({backendInteractor:e=>e.api.backendInteractor})},methods:{doActivate(){this.$emit("activate")},cancelDeactivate(){this.deactivate=!1},doDeactivate(){this.error=null,this.deactivate=!0},confirmDeactivate(){this.error=null,this.inProgress=!0,this.backendInteractor.mfaDisableOTP({password:this.currentPassword}).then(e=>{if(this.inProgress=!1,e.error){this.error=e.error;return}this.deactivate=!1,this.$emit("deactivate")})}}},$h={class:"method-item"},yh=["disabled"],wh={key:1,class:"alert error"};function kh(e,t,s,o,l,a){const d=P("confirm");return m(),b("div",null,[n("div",$h,[n("strong",null,i(e.$t("settings.mfa.otp")),1),e.isActivated?V("",!0):(m(),b("button",{key:0,class:"btn button-default",onClick:t[0]||(t[0]=(...r)=>e.doActivate&&e.doActivate(...r))},i(e.$t("general.enable")),1)),e.isActivated?(m(),b("button",{key:1,class:"btn button-default",disabled:e.deactivate,onClick:t[1]||(t[1]=(...r)=>e.doDeactivate&&e.doDeactivate(...r))},i(e.$t("general.disable")),9,yh)):V("",!0)]),e.deactivate?(m(),H(d,{key:0,disabled:e.inProgress,onConfirm:e.confirmDeactivate,onCancel:e.cancelDeactivate},{default:f(()=>[v(i(e.$t("settings.enter_current_password_to_confirm"))+": ",1),x(n("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.currentPassword=r),type:"password",class:"input"},null,512),[[ie,e.currentPassword]])]),_:1},8,["disabled","onConfirm","onCancel"])):V("",!0),e.error?(m(),b("div",wh,i(e.error),1)):V("",!0)])}const Ch=X(vh,[["render",kh]]);var tt={},ss,Oo;function Th(){return Oo||(Oo=1,ss=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),ss}var ns={},Fe={},Uo;function Ye(){if(Uo)return Fe;Uo=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Fe.getSymbolSize=function(o){if(!o)throw new Error('"version" cannot be null or undefined');if(o<1||o>40)throw new Error('"version" should be in range from 1 to 40');return o*4+17},Fe.getSymbolTotalCodewords=function(o){return t[o]},Fe.getBCHDigit=function(s){let o=0;for(;s!==0;)o++,s>>>=1;return o},Fe.setToSJISFunction=function(o){if(typeof o!="function")throw new Error('"toSJISFunc" is not a valid function.');e=o},Fe.isKanjiModeEnabled=function(){return typeof e<"u"},Fe.toSJIS=function(o){return e(o)},Fe}var os={},Ro;function wn(){return Ro||(Ro=1,function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+s)}}e.isValid=function(o){return o&&typeof o.bit<"u"&&o.bit>=0&&o.bit<4},e.from=function(o,l){if(e.isValid(o))return o;try{return t(o)}catch{return l}}}(os)),os}var ls,Bo;function Vh(){if(Bo)return ls;Bo=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const s=Math.floor(t/8);return(this.buffer[s]>>>7-t%8&1)===1},put:function(t,s){for(let o=0;o<s;o++)this.putBit((t>>>s-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),t&&(this.buffer[s]|=128>>>this.length%8),this.length++}},ls=e,ls}var as,Mo;function Sh(){if(Mo)return as;Mo=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,s,o,l){const a=t*this.size+s;this.data[a]=o,l&&(this.reservedBit[a]=!0)},e.prototype.get=function(t,s){return this.data[t*this.size+s]},e.prototype.xor=function(t,s,o){this.data[t*this.size+s]^=o},e.prototype.isReserved=function(t,s){return this.reservedBit[t*this.size+s]},as=e,as}var is={},Fo;function Ph(){return Fo||(Fo=1,function(e){const t=Ye().getSymbolSize;e.getRowColCoords=function(o){if(o===1)return[];const l=Math.floor(o/7)+2,a=t(o),d=a===145?26:Math.ceil((a-13)/(2*l-2))*2,r=[a-7];for(let h=1;h<l-1;h++)r[h]=r[h-1]-d;return r.push(6),r.reverse()},e.getPositions=function(o){const l=[],a=e.getRowColCoords(o),d=a.length;for(let r=0;r<d;r++)for(let h=0;h<d;h++)r===0&&h===0||r===0&&h===d-1||r===d-1&&h===0||l.push([a[r],a[h]]);return l}}(is)),is}var rs={},Do;function Ih(){if(Do)return rs;Do=1;const e=Ye().getSymbolSize,t=7;return rs.getPositions=function(o){const l=e(o);return[[0,0],[l-t,0],[0,l-t]]},rs}var ds={},No;function Eh(){return No||(No=1,function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(l){return l!=null&&l!==""&&!isNaN(l)&&l>=0&&l<=7},e.from=function(l){return e.isValid(l)?parseInt(l,10):void 0},e.getPenaltyN1=function(l){const a=l.size;let d=0,r=0,h=0,c=null,p=null;for(let $=0;$<a;$++){r=h=0,c=p=null;for(let w=0;w<a;w++){let y=l.get($,w);y===c?r++:(r>=5&&(d+=t.N1+(r-5)),c=y,r=1),y=l.get(w,$),y===p?h++:(h>=5&&(d+=t.N1+(h-5)),p=y,h=1)}r>=5&&(d+=t.N1+(r-5)),h>=5&&(d+=t.N1+(h-5))}return d},e.getPenaltyN2=function(l){const a=l.size;let d=0;for(let r=0;r<a-1;r++)for(let h=0;h<a-1;h++){const c=l.get(r,h)+l.get(r,h+1)+l.get(r+1,h)+l.get(r+1,h+1);(c===4||c===0)&&d++}return d*t.N2},e.getPenaltyN3=function(l){const a=l.size;let d=0,r=0,h=0;for(let c=0;c<a;c++){r=h=0;for(let p=0;p<a;p++)r=r<<1&2047|l.get(c,p),p>=10&&(r===1488||r===93)&&d++,h=h<<1&2047|l.get(p,c),p>=10&&(h===1488||h===93)&&d++}return d*t.N3},e.getPenaltyN4=function(l){let a=0;const d=l.data.length;for(let h=0;h<d;h++)a+=l.data[h];return Math.abs(Math.ceil(a*100/d/5)-10)*t.N4};function s(o,l,a){switch(o){case e.Patterns.PATTERN000:return(l+a)%2===0;case e.Patterns.PATTERN001:return l%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(l+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(l/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return l*a%2+l*a%3===0;case e.Patterns.PATTERN110:return(l*a%2+l*a%3)%2===0;case e.Patterns.PATTERN111:return(l*a%3+(l+a)%2)%2===0;default:throw new Error("bad maskPattern:"+o)}}e.applyMask=function(l,a){const d=a.size;for(let r=0;r<d;r++)for(let h=0;h<d;h++)a.isReserved(h,r)||a.xor(h,r,s(l,h,r))},e.getBestMask=function(l,a){const d=Object.keys(e.Patterns).length;let r=0,h=1/0;for(let c=0;c<d;c++){a(c),e.applyMask(c,l);const p=e.getPenaltyN1(l)+e.getPenaltyN2(l)+e.getPenaltyN3(l)+e.getPenaltyN4(l);e.applyMask(c,l),p<h&&(h=p,r=c)}return r}}(ds)),ds}var Ot={},jo;function Oa(){if(jo)return Ot;jo=1;const e=wn(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],s=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Ot.getBlocksCount=function(l,a){switch(a){case e.L:return t[(l-1)*4+0];case e.M:return t[(l-1)*4+1];case e.Q:return t[(l-1)*4+2];case e.H:return t[(l-1)*4+3];default:return}},Ot.getTotalCodewordsCount=function(l,a){switch(a){case e.L:return s[(l-1)*4+0];case e.M:return s[(l-1)*4+1];case e.Q:return s[(l-1)*4+2];case e.H:return s[(l-1)*4+3];default:return}},Ot}var us={},ut={},qo;function Ah(){if(qo)return ut;qo=1;const e=new Uint8Array(512),t=new Uint8Array(256);return function(){let o=1;for(let l=0;l<255;l++)e[l]=o,t[o]=l,o<<=1,o&256&&(o^=285);for(let l=255;l<512;l++)e[l]=e[l-255]}(),ut.log=function(o){if(o<1)throw new Error("log("+o+")");return t[o]},ut.exp=function(o){return e[o]},ut.mul=function(o,l){return o===0||l===0?0:e[t[o]+t[l]]},ut}var zo;function _h(){return zo||(zo=1,function(e){const t=Ah();e.mul=function(o,l){const a=new Uint8Array(o.length+l.length-1);for(let d=0;d<o.length;d++)for(let r=0;r<l.length;r++)a[d+r]^=t.mul(o[d],l[r]);return a},e.mod=function(o,l){let a=new Uint8Array(o);for(;a.length-l.length>=0;){const d=a[0];for(let h=0;h<l.length;h++)a[h]^=t.mul(l[h],d);let r=0;for(;r<a.length&&a[r]===0;)r++;a=a.slice(r)}return a},e.generateECPolynomial=function(o){let l=new Uint8Array([1]);for(let a=0;a<o;a++)l=e.mul(l,new Uint8Array([1,t.exp(a)]));return l}}(us)),us}var cs,Ho;function Lh(){if(Ho)return cs;Ho=1;const e=_h();function t(s){this.genPoly=void 0,this.degree=s,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(o){this.degree=o,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(o){if(!this.genPoly)throw new Error("Encoder not initialized");const l=new Uint8Array(o.length+this.degree);l.set(o);const a=e.mod(l,this.genPoly),d=this.degree-a.length;if(d>0){const r=new Uint8Array(this.degree);return r.set(a,d),r}return a},cs=t,cs}var hs={},ps={},ms={},Wo;function Ua(){return Wo||(Wo=1,ms.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),ms}var Se={},Ko;function Ra(){if(Ko)return Se;Ko=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let s="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";s=s.replace(/u/g,"\\u");const o="(?:(?![A-Z0-9 $%*+\\-./:]|"+s+`)(?:.|[\r
]))+`;Se.KANJI=new RegExp(s,"g"),Se.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Se.BYTE=new RegExp(o,"g"),Se.NUMERIC=new RegExp(e,"g"),Se.ALPHANUMERIC=new RegExp(t,"g");const l=new RegExp("^"+s+"$"),a=new RegExp("^"+e+"$"),d=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Se.testKanji=function(h){return l.test(h)},Se.testNumeric=function(h){return a.test(h)},Se.testAlphanumeric=function(h){return d.test(h)},Se}var Go;function Xe(){return Go||(Go=1,function(e){const t=Ua(),s=Ra();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,d){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(d))throw new Error("Invalid version: "+d);return d>=1&&d<10?a.ccBits[0]:d<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return s.testNumeric(a)?e.NUMERIC:s.testAlphanumeric(a)?e.ALPHANUMERIC:s.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function o(l){if(typeof l!="string")throw new Error("Param is not a string");switch(l.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+l)}}e.from=function(a,d){if(e.isValid(a))return a;try{return o(a)}catch{return d}}}(ps)),ps}var Yo;function Oh(){return Yo||(Yo=1,function(e){const t=Ye(),s=Oa(),o=wn(),l=Xe(),a=Ua(),d=7973,r=t.getBCHDigit(d);function h(w,y,k){for(let S=1;S<=40;S++)if(y<=e.getCapacity(S,k,w))return S}function c(w,y){return l.getCharCountIndicator(w,y)+4}function p(w,y){let k=0;return w.forEach(function(S){const T=c(S.mode,y);k+=T+S.getBitsLength()}),k}function $(w,y){for(let k=1;k<=40;k++)if(p(w,k)<=e.getCapacity(k,y,l.MIXED))return k}e.from=function(y,k){return a.isValid(y)?parseInt(y,10):k},e.getCapacity=function(y,k,S){if(!a.isValid(y))throw new Error("Invalid QR Code version");typeof S>"u"&&(S=l.BYTE);const T=t.getSymbolTotalCodewords(y),E=s.getTotalCodewordsCount(y,k),M=(T-E)*8;if(S===l.MIXED)return M;const O=M-c(S,y);switch(S){case l.NUMERIC:return Math.floor(O/10*3);case l.ALPHANUMERIC:return Math.floor(O/11*2);case l.KANJI:return Math.floor(O/13);case l.BYTE:default:return Math.floor(O/8)}},e.getBestVersionForData=function(y,k){let S;const T=o.from(k,o.M);if(Array.isArray(y)){if(y.length>1)return $(y,T);if(y.length===0)return 1;S=y[0]}else S=y;return h(S.mode,S.getLength(),T)},e.getEncodedBits=function(y){if(!a.isValid(y)||y<7)throw new Error("Invalid QR Code version");let k=y<<12;for(;t.getBCHDigit(k)-r>=0;)k^=d<<t.getBCHDigit(k)-r;return y<<12|k}}(hs)),hs}var fs={},Xo;function Uh(){if(Xo)return fs;Xo=1;const e=Ye(),t=1335,s=21522,o=e.getBCHDigit(t);return fs.getEncodedBits=function(a,d){const r=a.bit<<3|d;let h=r<<10;for(;e.getBCHDigit(h)-o>=0;)h^=t<<e.getBCHDigit(h)-o;return(r<<10|h)^s},fs}var gs={},bs,Jo;function Rh(){if(Jo)return bs;Jo=1;const e=Xe();function t(s){this.mode=e.NUMERIC,this.data=s.toString()}return t.getBitsLength=function(o){return 10*Math.floor(o/3)+(o%3?o%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(o){let l,a,d;for(l=0;l+3<=this.data.length;l+=3)a=this.data.substr(l,3),d=parseInt(a,10),o.put(d,10);const r=this.data.length-l;r>0&&(a=this.data.substr(l),d=parseInt(a,10),o.put(d,r*3+1))},bs=t,bs}var vs,Zo;function Bh(){if(Zo)return vs;Zo=1;const e=Xe(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function s(o){this.mode=e.ALPHANUMERIC,this.data=o}return s.getBitsLength=function(l){return 11*Math.floor(l/2)+6*(l%2)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(l){let a;for(a=0;a+2<=this.data.length;a+=2){let d=t.indexOf(this.data[a])*45;d+=t.indexOf(this.data[a+1]),l.put(d,11)}this.data.length%2&&l.put(t.indexOf(this.data[a]),6)},vs=s,vs}var $s,Qo;function Mh(){if(Qo)return $s;Qo=1;const e=Xe();function t(s){this.mode=e.BYTE,typeof s=="string"?this.data=new TextEncoder().encode(s):this.data=new Uint8Array(s)}return t.getBitsLength=function(o){return o*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(s){for(let o=0,l=this.data.length;o<l;o++)s.put(this.data[o],8)},$s=t,$s}var ys,xo;function Fh(){if(xo)return ys;xo=1;const e=Xe(),t=Ye();function s(o){this.mode=e.KANJI,this.data=o}return s.getBitsLength=function(l){return l*13},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(o){let l;for(l=0;l<this.data.length;l++){let a=t.toSJIS(this.data[l]);if(a>=33088&&a<=40956)a-=33088;else if(a>=57408&&a<=60351)a-=49472;else throw new Error("Invalid SJIS character: "+this.data[l]+`
Make sure your charset is UTF-8`);a=(a>>>8&255)*192+(a&255),o.put(a,13)}},ys=s,ys}var ws={exports:{}},el;function Dh(){return el||(el=1,function(e){var t={single_source_shortest_paths:function(s,o,l){var a={},d={};d[o]=0;var r=t.PriorityQueue.make();r.push(o,0);for(var h,c,p,$,w,y,k,S,T;!r.empty();){h=r.pop(),c=h.value,$=h.cost,w=s[c]||{};for(p in w)w.hasOwnProperty(p)&&(y=w[p],k=$+y,S=d[p],T=typeof d[p]>"u",(T||S>k)&&(d[p]=k,r.push(p,k),a[p]=c))}if(typeof l<"u"&&typeof d[l]>"u"){var E=["Could not find a path from ",o," to ",l,"."].join("");throw new Error(E)}return a},extract_shortest_path_from_predecessor_list:function(s,o){for(var l=[],a=o;a;)l.push(a),s[a],a=s[a];return l.reverse(),l},find_path:function(s,o,l){var a=t.single_source_shortest_paths(s,o,l);return t.extract_shortest_path_from_predecessor_list(a,l)},PriorityQueue:{make:function(s){var o=t.PriorityQueue,l={},a;s=s||{};for(a in o)o.hasOwnProperty(a)&&(l[a]=o[a]);return l.queue=[],l.sorter=s.sorter||o.default_sorter,l},default_sorter:function(s,o){return s.cost-o.cost},push:function(s,o){var l={value:s,cost:o};this.queue.push(l),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t}(ws)),ws.exports}var tl;function Nh(){return tl||(tl=1,function(e){const t=Xe(),s=Rh(),o=Bh(),l=Mh(),a=Fh(),d=Ra(),r=Ye(),h=Dh();function c(E){return unescape(encodeURIComponent(E)).length}function p(E,M,O){const A=[];let K;for(;(K=E.exec(O))!==null;)A.push({data:K[0],index:K.index,mode:M,length:K[0].length});return A}function $(E){const M=p(d.NUMERIC,t.NUMERIC,E),O=p(d.ALPHANUMERIC,t.ALPHANUMERIC,E);let A,K;return r.isKanjiModeEnabled()?(A=p(d.BYTE,t.BYTE,E),K=p(d.KANJI,t.KANJI,E)):(A=p(d.BYTE_KANJI,t.BYTE,E),K=[]),M.concat(O,A,K).sort(function(U,_){return U.index-_.index}).map(function(U){return{data:U.data,mode:U.mode,length:U.length}})}function w(E,M){switch(M){case t.NUMERIC:return s.getBitsLength(E);case t.ALPHANUMERIC:return o.getBitsLength(E);case t.KANJI:return a.getBitsLength(E);case t.BYTE:return l.getBitsLength(E)}}function y(E){return E.reduce(function(M,O){const A=M.length-1>=0?M[M.length-1]:null;return A&&A.mode===O.mode?(M[M.length-1].data+=O.data,M):(M.push(O),M)},[])}function k(E){const M=[];for(let O=0;O<E.length;O++){const A=E[O];switch(A.mode){case t.NUMERIC:M.push([A,{data:A.data,mode:t.ALPHANUMERIC,length:A.length},{data:A.data,mode:t.BYTE,length:A.length}]);break;case t.ALPHANUMERIC:M.push([A,{data:A.data,mode:t.BYTE,length:A.length}]);break;case t.KANJI:M.push([A,{data:A.data,mode:t.BYTE,length:c(A.data)}]);break;case t.BYTE:M.push([{data:A.data,mode:t.BYTE,length:c(A.data)}])}}return M}function S(E,M){const O={},A={start:{}};let K=["start"];for(let C=0;C<E.length;C++){const U=E[C],_=[];for(let R=0;R<U.length;R++){const B=U[R],D=""+C+R;_.push(D),O[D]={node:B,lastCount:0},A[D]={};for(let z=0;z<K.length;z++){const L=K[z];O[L]&&O[L].node.mode===B.mode?(A[L][D]=w(O[L].lastCount+B.length,B.mode)-w(O[L].lastCount,B.mode),O[L].lastCount+=B.length):(O[L]&&(O[L].lastCount=B.length),A[L][D]=w(B.length,B.mode)+4+t.getCharCountIndicator(B.mode,M))}}K=_}for(let C=0;C<K.length;C++)A[K[C]].end=0;return{map:A,table:O}}function T(E,M){let O;const A=t.getBestModeForData(E);if(O=t.from(M,A),O!==t.BYTE&&O.bit<A.bit)throw new Error('"'+E+'" cannot be encoded with mode '+t.toString(O)+`.
 Suggested mode is: `+t.toString(A));switch(O===t.KANJI&&!r.isKanjiModeEnabled()&&(O=t.BYTE),O){case t.NUMERIC:return new s(E);case t.ALPHANUMERIC:return new o(E);case t.KANJI:return new a(E);case t.BYTE:return new l(E)}}e.fromArray=function(M){return M.reduce(function(O,A){return typeof A=="string"?O.push(T(A,null)):A.data&&O.push(T(A.data,A.mode)),O},[])},e.fromString=function(M,O){const A=$(M,r.isKanjiModeEnabled()),K=k(A),C=S(K,O),U=h.find_path(C.map,"start","end"),_=[];for(let R=1;R<U.length-1;R++)_.push(C.table[U[R]].node);return e.fromArray(y(_))},e.rawSplit=function(M){return e.fromArray($(M,r.isKanjiModeEnabled()))}}(gs)),gs}var sl;function jh(){if(sl)return ns;sl=1;const e=Ye(),t=wn(),s=Vh(),o=Sh(),l=Ph(),a=Ih(),d=Eh(),r=Oa(),h=Lh(),c=Oh(),p=Uh(),$=Xe(),w=Nh();function y(C,U){const _=C.size,R=a.getPositions(U);for(let B=0;B<R.length;B++){const D=R[B][0],z=R[B][1];for(let L=-1;L<=7;L++)if(!(D+L<=-1||_<=D+L))for(let j=-1;j<=7;j++)z+j<=-1||_<=z+j||(L>=0&&L<=6&&(j===0||j===6)||j>=0&&j<=6&&(L===0||L===6)||L>=2&&L<=4&&j>=2&&j<=4?C.set(D+L,z+j,!0,!0):C.set(D+L,z+j,!1,!0))}}function k(C){const U=C.size;for(let _=8;_<U-8;_++){const R=_%2===0;C.set(_,6,R,!0),C.set(6,_,R,!0)}}function S(C,U){const _=l.getPositions(U);for(let R=0;R<_.length;R++){const B=_[R][0],D=_[R][1];for(let z=-2;z<=2;z++)for(let L=-2;L<=2;L++)z===-2||z===2||L===-2||L===2||z===0&&L===0?C.set(B+z,D+L,!0,!0):C.set(B+z,D+L,!1,!0)}}function T(C,U){const _=C.size,R=c.getEncodedBits(U);let B,D,z;for(let L=0;L<18;L++)B=Math.floor(L/3),D=L%3+_-8-3,z=(R>>L&1)===1,C.set(B,D,z,!0),C.set(D,B,z,!0)}function E(C,U,_){const R=C.size,B=p.getEncodedBits(U,_);let D,z;for(D=0;D<15;D++)z=(B>>D&1)===1,D<6?C.set(D,8,z,!0):D<8?C.set(D+1,8,z,!0):C.set(R-15+D,8,z,!0),D<8?C.set(8,R-D-1,z,!0):D<9?C.set(8,15-D-1+1,z,!0):C.set(8,15-D-1,z,!0);C.set(R-8,8,1,!0)}function M(C,U){const _=C.size;let R=-1,B=_-1,D=7,z=0;for(let L=_-1;L>0;L-=2)for(L===6&&L--;;){for(let j=0;j<2;j++)if(!C.isReserved(B,L-j)){let ce=!1;z<U.length&&(ce=(U[z]>>>D&1)===1),C.set(B,L-j,ce),D--,D===-1&&(z++,D=7)}if(B+=R,B<0||_<=B){B-=R,R=-R;break}}}function O(C,U,_){const R=new s;_.forEach(function(j){R.put(j.mode.bit,4),R.put(j.getLength(),$.getCharCountIndicator(j.mode,C)),j.write(R)});const B=e.getSymbolTotalCodewords(C),D=r.getTotalCodewordsCount(C,U),z=(B-D)*8;for(R.getLengthInBits()+4<=z&&R.put(0,4);R.getLengthInBits()%8!==0;)R.putBit(0);const L=(z-R.getLengthInBits())/8;for(let j=0;j<L;j++)R.put(j%2?17:236,8);return A(R,C,U)}function A(C,U,_){const R=e.getSymbolTotalCodewords(U),B=r.getTotalCodewordsCount(U,_),D=R-B,z=r.getBlocksCount(U,_),L=R%z,j=z-L,ce=Math.floor(R/z),$e=Math.floor(D/z),Je=$e+1,ye=ce-$e,Ze=new h(ye);let Re=0;const Pe=new Array(z),Ie=new Array(z);let Be=0;const He=new Uint8Array(C.buffer);for(let be=0;be<z;be++){const me=be<j?$e:Je;Pe[be]=He.slice(Re,Re+me),Ie[be]=Ze.encode(Pe[be]),Re+=me,Be=Math.max(Be,me)}const Me=new Uint8Array(R);let we=0,he,re;for(he=0;he<Be;he++)for(re=0;re<z;re++)he<Pe[re].length&&(Me[we++]=Pe[re][he]);for(he=0;he<ye;he++)for(re=0;re<z;re++)Me[we++]=Ie[re][he];return Me}function K(C,U,_,R){let B;if(Array.isArray(C))B=w.fromArray(C);else if(typeof C=="string"){let ce=U;if(!ce){const $e=w.rawSplit(C);ce=c.getBestVersionForData($e,_)}B=w.fromString(C,ce||40)}else throw new Error("Invalid data");const D=c.getBestVersionForData(B,_);if(!D)throw new Error("The amount of data is too big to be stored in a QR Code");if(!U)U=D;else if(U<D)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+D+`.
`);const z=O(U,_,B),L=e.getSymbolSize(U),j=new o(L);return y(j,U),k(j),S(j,U),E(j,_,0),U>=7&&T(j,U),M(j,z),isNaN(R)&&(R=d.getBestMask(j,E.bind(null,j,_))),d.applyMask(R,j),E(j,_,R),{modules:j,version:U,errorCorrectionLevel:_,maskPattern:R,segments:B}}return ns.create=function(U,_){if(typeof U>"u"||U==="")throw new Error("No input text");let R=t.M,B,D;return typeof _<"u"&&(R=t.from(_.errorCorrectionLevel,t.M),B=c.from(_.version),D=d.from(_.maskPattern),_.toSJISFunc&&e.setToSJISFunction(_.toSJISFunc)),K(U,B,R,D)},ns}var ks={},Cs={},nl;function Ba(){return nl||(nl=1,function(e){function t(s){if(typeof s=="number"&&(s=s.toString()),typeof s!="string")throw new Error("Color should be defined as hex string");let o=s.slice().replace("#","").split("");if(o.length<3||o.length===5||o.length>8)throw new Error("Invalid hex color: "+s);(o.length===3||o.length===4)&&(o=Array.prototype.concat.apply([],o.map(function(a){return[a,a]}))),o.length===6&&o.push("F","F");const l=parseInt(o.join(""),16);return{r:l>>24&255,g:l>>16&255,b:l>>8&255,a:l&255,hex:"#"+o.slice(0,6).join("")}}e.getOptions=function(o){o||(o={}),o.color||(o.color={});const l=typeof o.margin>"u"||o.margin===null||o.margin<0?4:o.margin,a=o.width&&o.width>=21?o.width:void 0,d=o.scale||4;return{width:a,scale:a?4:d,margin:l,color:{dark:t(o.color.dark||"#000000ff"),light:t(o.color.light||"#ffffffff")},type:o.type,rendererOpts:o.rendererOpts||{}}},e.getScale=function(o,l){return l.width&&l.width>=o+l.margin*2?l.width/(o+l.margin*2):l.scale},e.getImageWidth=function(o,l){const a=e.getScale(o,l);return Math.floor((o+l.margin*2)*a)},e.qrToImageData=function(o,l,a){const d=l.modules.size,r=l.modules.data,h=e.getScale(d,a),c=Math.floor((d+a.margin*2)*h),p=a.margin*h,$=[a.color.light,a.color.dark];for(let w=0;w<c;w++)for(let y=0;y<c;y++){let k=(w*c+y)*4,S=a.color.light;if(w>=p&&y>=p&&w<c-p&&y<c-p){const T=Math.floor((w-p)/h),E=Math.floor((y-p)/h);S=$[r[T*d+E]?1:0]}o[k++]=S.r,o[k++]=S.g,o[k++]=S.b,o[k]=S.a}}}(Cs)),Cs}var ol;function qh(){return ol||(ol=1,function(e){const t=Ba();function s(l,a,d){l.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=d,a.width=d,a.style.height=d+"px",a.style.width=d+"px"}function o(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,d,r){let h=r,c=d;typeof h>"u"&&(!d||!d.getContext)&&(h=d,d=void 0),d||(c=o()),h=t.getOptions(h);const p=t.getImageWidth(a.modules.size,h),$=c.getContext("2d"),w=$.createImageData(p,p);return t.qrToImageData(w.data,a,h),s($,c,p),$.putImageData(w,0,0),c},e.renderToDataURL=function(a,d,r){let h=r;typeof h>"u"&&(!d||!d.getContext)&&(h=d,d=void 0),h||(h={});const c=e.render(a,d,h),p=h.type||"image/png",$=h.rendererOpts||{};return c.toDataURL(p,$.quality)}}(ks)),ks}var Ts={},ll;function zh(){if(ll)return Ts;ll=1;const e=Ba();function t(l,a){const d=l.a/255,r=a+'="'+l.hex+'"';return d<1?r+" "+a+'-opacity="'+d.toFixed(2).slice(1)+'"':r}function s(l,a,d){let r=l+a;return typeof d<"u"&&(r+=" "+d),r}function o(l,a,d){let r="",h=0,c=!1,p=0;for(let $=0;$<l.length;$++){const w=Math.floor($%a),y=Math.floor($/a);!w&&!c&&(c=!0),l[$]?(p++,$>0&&w>0&&l[$-1]||(r+=c?s("M",w+d,.5+y+d):s("m",h,0),h=0,c=!1),w+1<a&&l[$+1]||(r+=s("h",p),p=0)):h++}return r}return Ts.render=function(a,d,r){const h=e.getOptions(d),c=a.modules.size,p=a.modules.data,$=c+h.margin*2,w=h.color.light.a?"<path "+t(h.color.light,"fill")+' d="M0 0h'+$+"v"+$+'H0z"/>':"",y="<path "+t(h.color.dark,"stroke")+' d="'+o(p,c,h.margin)+'"/>',k='viewBox="0 0 '+$+" "+$+'"',T='<svg xmlns="http://www.w3.org/2000/svg" '+(h.width?'width="'+h.width+'" height="'+h.width+'" ':"")+k+' shape-rendering="crispEdges">'+w+y+`</svg>
`;return typeof r=="function"&&r(null,T),T},Ts}var al;function Hh(){if(al)return tt;al=1;const e=Th(),t=jh(),s=qh(),o=zh();function l(a,d,r,h,c){const p=[].slice.call(arguments,1),$=p.length,w=typeof p[$-1]=="function";if(!w&&!e())throw new Error("Callback required as last argument");if(w){if($<2)throw new Error("Too few arguments provided");$===2?(c=r,r=d,d=h=void 0):$===3&&(d.getContext&&typeof c>"u"?(c=h,h=void 0):(c=h,h=r,r=d,d=void 0))}else{if($<1)throw new Error("Too few arguments provided");return $===1?(r=d,d=h=void 0):$===2&&!d.getContext&&(h=r,r=d,d=void 0),new Promise(function(y,k){try{const S=t.create(r,h);y(a(S,d,h))}catch(S){k(S)}})}try{const y=t.create(r,h);c(null,a(y,d,h))}catch(y){c(y)}}return tt.create=t.create,tt.toCanvas=l.bind(null,s.render),tt.toDataURL=l.bind(null,s.renderToDataURL),tt.toString=l.bind(null,function(a,d,r){return o.render(a,r)}),tt}var Vs=Hh();/*! vue-qrcode v2.0.0 | (c) 2018-present Chen Fengyuan | MIT */const il="ready";var Wh=ci({name:"VueQrcode",props:{value:{type:String,default:void 0},options:{type:Object,default:void 0},tag:{type:String,default:"canvas"}},emits:[il],watch:{$props:{deep:!0,immediate:!0,handler(){this.$el&&this.generate()}}},mounted(){this.generate()},methods:{generate(){const e=this.options||{},t=String(this.value),s=()=>{this.$emit(il,this.$el)};switch(this.tag){case"canvas":Vs.toCanvas(this.$el,t,e,o=>{if(o)throw o;s()});break;case"img":Vs.toDataURL(t,e,(o,l)=>{if(o)throw o;this.$el.src=l,this.$el.onload=s});break;case"svg":Vs.toString(t,e,(o,l)=>{if(o)throw o;const a=document.createElement("div");a.innerHTML=l;const d=a.querySelector("svg");if(d){const{attributes:r,childNodes:h}=d;Object.keys(r).forEach(c=>{const p=r[Number(c)];this.$el.setAttribute(p.name,p.value)}),Object.keys(h).forEach(c=>{const p=h[Number(c)];this.$el.appendChild(p.cloneNode(!0))}),s()}});break}}},render(){return hi(this.tag,this.$slots.default)}});const Kh={data:()=>({settings:{available:!1,enabled:!1,totp:!1},setupState:{state:"",setupOTPState:""},backupCodes:{getNewCodes:!1,inProgress:!1,codes:[]},otpSettings:{provisioning_uri:"",key:""},currentPassword:null,otpConfirmToken:null,error:null,readyInit:!1}),components:{"recovery-codes":ph,"totp-item":Ch,qrcode:Wh,confirm:La},computed:{canSetupOTP(){return(this.setupInProgress&&this.backupCodesPrepared||this.settings.enabled)&&!this.settings.totp&&!this.setupOTPInProgress},setupInProgress(){return this.setupState.state!==""&&this.setupState.state!=="complete"},setupOTPInProgress(){return this.setupState.state==="setupOTP"&&!this.completedOTP},prepareOTP(){return this.setupState.setupOTPState==="prepare"},confirmOTP(){return this.setupState.setupOTPState==="confirm"},completedOTP(){return this.setupState.setupOTPState==="completed"},backupCodesPrepared(){return!this.backupCodes.inProgress&&this.backupCodes.codes.length>0},confirmNewBackupCodes(){return this.backupCodes.getNewCodes},...dn({backendInteractor:e=>e.api.backendInteractor})},methods:{activateOTP(){this.settings.enabled||(this.setupState.state="getBackupcodes",this.fetchBackupCodes())},fetchBackupCodes(){return this.backupCodes.inProgress=!0,this.backupCodes.codes=[],this.backendInteractor.generateMfaBackupCodes().then(e=>{this.backupCodes.codes=e.codes,this.backupCodes.inProgress=!1})},getBackupCodes(){this.backupCodes.getNewCodes=!0},confirmBackupCodes(){this.fetchBackupCodes().then(()=>{this.backupCodes.getNewCodes=!1})},cancelBackupCodes(){this.backupCodes.getNewCodes=!1},setupOTP(){this.setupState.state="setupOTP",this.setupState.setupOTPState="prepare",this.backendInteractor.mfaSetupOTP().then(e=>{this.otpSettings=e,this.setupState.setupOTPState="confirm"})},doConfirmOTP(){this.error=null,this.backendInteractor.mfaConfirmOTP({token:this.otpConfirmToken,password:this.currentPassword}).then(e=>{if(e.error){this.error=e.error;return}this.completeSetup()})},completeSetup(){this.setupState.setupOTPState="complete",this.setupState.state="complete",this.currentPassword=null,this.error=null,this.fetchSettings()},cancelSetup(){this.setupState.setupOTPState="",this.setupState.state="",this.currentPassword=null,this.error=null},async fetchSettings(){const e=await this.backendInteractor.settingsMFA();if(!e.error)return this.settings=e.settings,this.settings.available=!0,e}},mounted(){this.fetchSettings().then(()=>{this.readyInit=!0})}},Gh={key:0,class:"setting-item mfa-settings"},Yh={class:"mfa-heading"},Xh={key:0,class:"setting-item"},Jh={key:0},Zh={key:2},Qh={class:"warning"},xh={key:1},ep={key:0},tp={key:1},sp={class:"setup-otp"},np={class:"qr-code"},op={class:"verify"},lp={class:"confirm-otp-actions"},ap={key:0,class:"alert error"};function ip(e,t,s,o,l,a){const d=P("totp-item"),r=P("recovery-codes"),h=P("confirm"),c=P("qrcode");return e.readyInit&&e.settings.available?(m(),b("div",Gh,[n("div",Yh,[n("h2",null,i(e.$t("settings.mfa.title")),1)]),n("div",null,[e.setupInProgress?V("",!0):(m(),b("div",Xh,[n("h3",null,i(e.$t("settings.mfa.authentication_methods")),1),u(d,{settings:e.settings,onDeactivate:e.fetchSettings,onActivate:e.activateOTP},null,8,["settings","onDeactivate","onActivate"]),t[7]||(t[7]=n("br",null,null,-1)),e.settings.enabled?(m(),b("div",Jh,[e.confirmNewBackupCodes?V("",!0):(m(),H(r,{key:0,"backup-codes":e.backupCodes},null,8,["backup-codes"])),e.confirmNewBackupCodes?V("",!0):(m(),b("button",{key:1,class:"btn button-default",onClick:t[0]||(t[0]=(...p)=>e.getBackupCodes&&e.getBackupCodes(...p))},i(e.$t("settings.mfa.generate_new_recovery_codes")),1)),e.confirmNewBackupCodes?(m(),b("div",Zh,[u(h,{disabled:e.backupCodes.inProgress,onConfirm:e.confirmBackupCodes,onCancel:e.cancelBackupCodes},{default:f(()=>[n("p",Qh,i(e.$t("settings.mfa.warning_of_generate_new_codes")),1)]),_:1},8,["disabled","onConfirm","onCancel"])])):V("",!0)])):V("",!0)])),e.setupInProgress?(m(),b("div",xh,[n("h3",null,i(e.$t("settings.mfa.setup_otp")),1),e.setupOTPInProgress?V("",!0):(m(),H(r,{key:0,"backup-codes":e.backupCodes},null,8,["backup-codes"])),e.canSetupOTP?(m(),b("button",{key:1,class:"btn button-default",onClick:t[1]||(t[1]=(...p)=>e.cancelSetup&&e.cancelSetup(...p))},i(e.$t("general.cancel")),1)):V("",!0),e.canSetupOTP?(m(),b("button",{key:2,class:"btn button-default",onClick:t[2]||(t[2]=(...p)=>e.setupOTP&&e.setupOTP(...p))},i(e.$t("settings.mfa.setup_otp")),1)):V("",!0),e.setupOTPInProgress?(m(),b(Y,{key:3},[e.prepareOTP?(m(),b("i",ep,i(e.$t("settings.mfa.wait_pre_setup_otp")),1)):V("",!0),e.confirmOTP?(m(),b("div",tp,[n("div",sp,[n("div",np,[n("h4",null,i(e.$t("settings.mfa.scan.title")),1),n("p",null,i(e.$t("settings.mfa.scan.desc")),1),u(c,{value:e.otpSettings.provisioning_uri,options:{width:200}},null,8,["value"]),n("p",null,i(e.$t("settings.mfa.scan.secret_code"))+": "+i(e.otpSettings.key),1)]),n("div",op,[n("h4",null,i(e.$t("general.verify")),1),n("p",null,i(e.$t("settings.mfa.verify.desc")),1),x(n("input",{"onUpdate:modelValue":t[3]||(t[3]=p=>e.otpConfirmToken=p),type:"text",class:"input"},null,512),[[ie,e.otpConfirmToken]]),n("p",null,i(e.$t("settings.enter_current_password_to_confirm"))+":",1),x(n("input",{"onUpdate:modelValue":t[4]||(t[4]=p=>e.currentPassword=p),type:"password",class:"input"},null,512),[[ie,e.currentPassword]]),n("div",lp,[n("button",{class:"btn button-default",onClick:t[5]||(t[5]=(...p)=>e.doConfirmOTP&&e.doConfirmOTP(...p))},i(e.$t("settings.mfa.confirm_and_enable")),1),n("button",{class:"btn button-default",onClick:t[6]||(t[6]=(...p)=>e.cancelSetup&&e.cancelSetup(...p))},i(e.$t("general.cancel")),1)]),e.error?(m(),b("div",ap,i(e.error),1)):V("",!0)])])])):V("",!0)],64)):V("",!0)])):V("",!0)])])):V("",!0)}const rp=X(Kh,[["render",ip]]),dp={data(){return{newEmail:"",changeEmailError:!1,changeEmailPassword:"",changedEmail:!1,deletingAccount:!1,deleteAccountConfirmPasswordInput:"",deleteAccountError:!1,changePasswordInputs:["","",""],changedPassword:!1,changePasswordError:!1,moveAccountTarget:"",moveAccountPassword:"",movedAccount:!1,moveAccountError:!1,aliases:[],listAliasesError:!1,addAliasTarget:"",addedAlias:!1,addAliasError:!1}},created(){gt().fetchTokens(),this.fetchAliases()},components:{ProgressButton:Wt,Mfa:rp,Checkbox:pe},computed:{user(){return this.$store.state.users.currentUser},pleromaBackend(){return this.$store.state.instance.pleromaBackend},oauthTokens(){return gt().tokens.map(e=>({id:e.id,appName:e.app_name,validUntil:new Date(e.valid_until).toLocaleDateString(va.internalToBrowserLocale(this.$i18n.locale))}))}},methods:{confirmDelete(){this.deletingAccount=!0},deleteAccount(){this.$store.state.api.backendInteractor.deleteAccount({password:this.deleteAccountConfirmPasswordInput}).then(e=>{e.status==="success"?(this.$store.dispatch("logout"),this.$router.push({name:"root"})):this.deleteAccountError=e.error})},changePassword(){const e={password:this.changePasswordInputs[0],newPassword:this.changePasswordInputs[1],newPasswordConfirmation:this.changePasswordInputs[2]};this.$store.state.api.backendInteractor.changePassword(e).then(t=>{t.status==="success"?(this.changedPassword=!0,this.changePasswordError=!1,this.logout()):(this.changedPassword=!1,this.changePasswordError=t.error)})},changeEmail(){const e={email:this.newEmail,password:this.changeEmailPassword};this.$store.state.api.backendInteractor.changeEmail(e).then(t=>{t.status==="success"?(this.changedEmail=!0,this.changeEmailError=!1):(this.changedEmail=!1,this.changeEmailError=t.error)})},moveAccount(){const e={targetAccount:this.moveAccountTarget,password:this.moveAccountPassword};this.$store.state.api.backendInteractor.moveAccount(e).then(t=>{t.status==="success"?(this.movedAccount=!0,this.moveAccountError=!1):(this.movedAccount=!1,this.moveAccountError=t.error)})},removeAlias(e){this.$store.state.api.backendInteractor.deleteAlias({alias:e}).then(()=>this.fetchAliases())},addAlias(){this.$store.state.api.backendInteractor.addAlias({alias:this.addAliasTarget}).then(()=>{this.addedAlias=!0,this.addAliasError=!1,this.addAliasTarget=""}).catch(e=>{this.addedAlias=!1,this.addAliasError=e}).then(()=>this.fetchAliases())},fetchAliases(){this.$store.state.api.backendInteractor.listAliases().then(e=>{this.aliases=e.aliases,this.listAliasesError=!1}).catch(e=>{this.listAliasesError=e.error})},logout(){this.$store.dispatch("logout"),this.$router.replace("/")},revokeToken(e){window.confirm(`${this.$i18n.t("settings.revoke_token")}?`)&&gt().revokeToken(e)}}},up=["label"],cp={class:"setting-item"},hp={key:0},pp={class:"setting-item"},mp={key:0},fp={key:1},gp={key:2},bp={class:"setting-item"},vp={class:"oauth-tokens"},$p={class:"actions"},yp=["onClick"],wp={class:"setting-item"},kp={class:"actions"},Cp=["onClick"],Tp={key:0,class:"alert error"},Vp={key:1},Sp={key:2},Pp={class:"setting-item"},Ip={key:0},Ep={key:1},Ap={class:"setting-item"},_p={key:0},Lp={key:1},Op={key:2},Up={key:3};function Rp(e,t,s,o,l,a){const d=P("mfa"),r=P("FAIcon"),h=P("i18n-t");return m(),b("div",{label:e.$t("settings.security_tab")},[n("div",cp,[n("h2",null,i(e.$t("settings.change_email")),1),n("div",null,[n("p",null,i(e.$t("settings.new_email")),1),x(n("input",{"onUpdate:modelValue":t[0]||(t[0]=c=>e.newEmail=c),type:"email",autocomplete:"email",class:"input"},null,512),[[ie,e.newEmail]])]),n("div",null,[n("p",null,i(e.$t("settings.current_password")),1),x(n("input",{"onUpdate:modelValue":t[1]||(t[1]=c=>e.changeEmailPassword=c),type:"password",autocomplete:"current-password",class:"input"},null,512),[[ie,e.changeEmailPassword]])]),n("button",{class:"btn button-default",onClick:t[2]||(t[2]=(...c)=>e.changeEmail&&e.changeEmail(...c))},i(e.$t("settings.save")),1),e.changedEmail?(m(),b("p",hp,i(e.$t("settings.changed_email")),1)):V("",!0),e.changeEmailError!==!1?(m(),b(Y,{key:1},[n("p",null,i(e.$t("settings.change_email_error")),1),n("p",null,i(e.changeEmailError),1)],64)):V("",!0)]),n("div",pp,[n("h2",null,i(e.$t("settings.change_password")),1),n("div",null,[n("p",null,i(e.$t("settings.current_password")),1),x(n("input",{"onUpdate:modelValue":t[3]||(t[3]=c=>e.changePasswordInputs[0]=c),type:"password",class:"input"},null,512),[[ie,e.changePasswordInputs[0]]])]),n("div",null,[n("p",null,i(e.$t("settings.new_password")),1),x(n("input",{"onUpdate:modelValue":t[4]||(t[4]=c=>e.changePasswordInputs[1]=c),type:"password",class:"input"},null,512),[[ie,e.changePasswordInputs[1]]])]),n("div",null,[n("p",null,i(e.$t("settings.confirm_new_password")),1),x(n("input",{"onUpdate:modelValue":t[5]||(t[5]=c=>e.changePasswordInputs[2]=c),type:"password",class:"input"},null,512),[[ie,e.changePasswordInputs[2]]])]),n("button",{class:"btn button-default",onClick:t[6]||(t[6]=(...c)=>e.changePassword&&e.changePassword(...c))},i(e.$t("settings.save")),1),e.changedPassword?(m(),b("p",mp,i(e.$t("settings.changed_password")),1)):e.changePasswordError!==!1?(m(),b("p",fp,i(e.$t("settings.change_password_error")),1)):V("",!0),e.changePasswordError?(m(),b("p",gp,i(e.changePasswordError),1)):V("",!0)]),n("div",bp,[n("h2",null,i(e.$t("settings.oauth_tokens")),1),n("table",vp,[n("thead",null,[n("tr",null,[n("th",null,i(e.$t("settings.app_name")),1),n("th",null,i(e.$t("settings.valid_until")),1),t[16]||(t[16]=n("th",null,null,-1))])]),n("tbody",null,[(m(!0),b(Y,null,se(e.oauthTokens,c=>(m(),b("tr",{key:c.id},[n("td",null,i(c.appName),1),n("td",null,i(c.validUntil),1),n("td",$p,[n("button",{class:"btn button-default",onClick:p=>e.revokeToken(c.id)},i(e.$t("settings.revoke_token")),9,yp)])]))),128))])])]),u(d),n("div",wp,[n("h2",null,i(e.$t("settings.account_alias")),1),n("table",null,[n("thead",null,[n("tr",null,[n("th",null,i(e.$t("settings.account_alias_table_head")),1),t[17]||(t[17]=n("th",null,null,-1))])]),n("tbody",null,[(m(!0),b(Y,null,se(e.aliases,c=>(m(),b("tr",{key:c},[n("td",null,i(c),1),n("td",kp,[n("button",{class:"btn button-default",onClick:p=>e.removeAlias(c)},i(e.$t("settings.remove_alias")),9,Cp)])]))),128))])]),e.listAliasesError?(m(),b("div",Tp,[v(i(e.$t("settings.list_aliases_error",{error:e.error}))+" ",1),u(r,{class:"fa-scale-110 fa-old-padding",icon:"times",title:e.$t("settings.hide_list_aliases_error_action"),onClick:t[7]||(t[7]=c=>e.listAliasesError=!1)},null,8,["title"])])):V("",!0),n("div",null,[u(h,{scope:"global",keypath:"settings.new_alias_target",tag:"p"},{default:f(()=>t[18]||(t[18]=[n("code",{place:"example"}," foo@example.org ",-1)])),_:1}),x(n("input",{"onUpdate:modelValue":t[8]||(t[8]=c=>e.addAliasTarget=c),class:"input"},null,512),[[ie,e.addAliasTarget]])]),n("button",{class:"btn button-default",onClick:t[9]||(t[9]=(...c)=>e.addAlias&&e.addAlias(...c))},i(e.$t("settings.save")),1),e.addedAlias?(m(),b("p",Vp,i(e.$t("settings.added_alias")),1)):V("",!0),e.addAliasError!==!1?(m(),b("p",Sp,i(e.$t("settings.add_alias_error",{error:e.addAliasError})),1)):V("",!0)]),n("div",Pp,[n("h2",null,i(e.$t("settings.move_account")),1),n("p",null,i(e.$t("settings.move_account_notes")),1),n("div",null,[u(h,{keypath:"settings.move_account_target",tag:"p",scope:"global"},{example:f(()=>t[19]||(t[19]=[n("code",null," foo@example.org ",-1)])),_:1}),x(n("input",{"onUpdate:modelValue":t[10]||(t[10]=c=>e.moveAccountTarget=c),class:"input"},null,512),[[ie,e.moveAccountTarget]])]),n("div",null,[n("p",null,i(e.$t("settings.current_password")),1),x(n("input",{"onUpdate:modelValue":t[11]||(t[11]=c=>e.moveAccountPassword=c),type:"password",autocomplete:"current-password",class:"input"},null,512),[[ie,e.moveAccountPassword]])]),n("button",{class:"btn button-default",onClick:t[12]||(t[12]=(...c)=>e.moveAccount&&e.moveAccount(...c))},i(e.$t("settings.save")),1),e.movedAccount?(m(),b("p",Ip,i(e.$t("settings.moved_account")),1)):V("",!0),e.moveAccountError!==!1?(m(),b("p",Ep,i(e.$t("settings.move_account_error",{error:e.moveAccountError})),1)):V("",!0)]),n("div",Ap,[n("h2",null,i(e.$t("settings.delete_account")),1),e.deletingAccount?V("",!0):(m(),b("p",_p,i(e.$t("settings.delete_account_description")),1)),e.deletingAccount?(m(),b("div",Lp,[n("p",null,i(e.$t("settings.delete_account_instructions")),1),n("p",null,i(e.$t("login.password")),1),x(n("input",{"onUpdate:modelValue":t[13]||(t[13]=c=>e.deleteAccountConfirmPasswordInput=c),type:"password",class:"input"},null,512),[[ie,e.deleteAccountConfirmPasswordInput]]),n("button",{class:"btn button-default",onClick:t[14]||(t[14]=(...c)=>e.deleteAccount&&e.deleteAccount(...c))},i(e.$t("settings.delete_account")),1)])):V("",!0),e.deleteAccountError!==!1?(m(),b("p",Op,i(e.$t("settings.delete_account_error")),1)):V("",!0),e.deleteAccountError?(m(),b("p",Up,i(e.deleteAccountError),1)):V("",!0),e.deletingAccount?V("",!0):(m(),b("button",{key:4,class:"btn button-default",onClick:t[15]||(t[15]=(...c)=>e.confirmDelete&&e.confirmDelete(...c))},i(e.$t("settings.delete_account")),1))])],8,up)}const Bp=X(dp,[["render",Rp]]);var Ss,rl;function Mp(){if(rl)return Ss;rl=1;function e(t){return function(s){return t==null?void 0:t[s]}}return Ss=e,Ss}var Ps,dl;function Fp(){if(dl)return Ps;dl=1;var e=Mp(),t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},s=e(t);return Ps=s,Ps}var Is,ul;function Dp(){if(ul)return Is;ul=1;var e=pi(),t=Fp(),s=/&(?:amp|lt|gt|quot|#39);/g,o=RegExp(s.source);function l(a){return a=e(a),a&&o.test(a)?a.replace(s,t):a}return Is=l,Is}var Np=Dp();const jp=un(Np);var Es,cl;function Ma(){if(cl)return Es;cl=1;var e=hn(),t=pn();function s(o,l,a){(a!==void 0&&!t(o[l],a)||a===void 0&&!(l in o))&&e(o,l,a)}return Es=s,Es}var ft={exports:{}};ft.exports;var hl;function qp(){return hl||(hl=1,function(e,t){var s=mi(),o=t&&!t.nodeType&&t,l=o&&!0&&e&&!e.nodeType&&e,a=l&&l.exports===o,d=a?s.Buffer:void 0,r=d?d.allocUnsafe:void 0;function h(c,p){if(p)return c.slice();var $=c.length,w=r?r($):new c.constructor($);return c.copy(w),w}e.exports=h}(ft,ft.exports)),ft.exports}var As,pl;function zp(){if(pl)return As;pl=1;var e=fi();function t(s){var o=new s.constructor(s.byteLength);return new e(o).set(new e(s)),o}return As=t,As}var _s,ml;function Hp(){if(ml)return _s;ml=1;var e=zp();function t(s,o){var l=o?e(s.buffer):s.buffer;return new s.constructor(l,s.byteOffset,s.length)}return _s=t,_s}var Ls,fl;function Wp(){if(fl)return Ls;fl=1;function e(t,s){var o=-1,l=t.length;for(s||(s=Array(l));++o<l;)s[o]=t[o];return s}return Ls=e,Ls}var Os,gl;function Kp(){if(gl)return Os;gl=1;var e=$t(),t=Object.create,s=function(){function o(){}return function(l){if(!e(l))return{};if(t)return t(l);o.prototype=l;var a=new o;return o.prototype=void 0,a}}();return Os=s,Os}var Us,bl;function Fa(){if(bl)return Us;bl=1;var e=gi(),t=e(Object.getPrototypeOf,Object);return Us=t,Us}var Rs,vl;function Gp(){if(vl)return Rs;vl=1;var e=Kp(),t=Fa(),s=$a();function o(l){return typeof l.constructor=="function"&&!s(l)?e(t(l)):{}}return Rs=o,Rs}var Bs,$l;function Yp(){if($l)return Bs;$l=1;var e=mn(),t=ya();function s(o){return t(o)&&e(o)}return Bs=s,Bs}var Ms,yl;function Xp(){if(yl)return Ms;yl=1;var e=bi(),t=Fa(),s=ya(),o="[object Object]",l=Function.prototype,a=Object.prototype,d=l.toString,r=a.hasOwnProperty,h=d.call(Object);function c(p){if(!s(p)||e(p)!=o)return!1;var $=t(p);if($===null)return!0;var w=r.call($,"constructor")&&$.constructor;return typeof w=="function"&&w instanceof w&&d.call(w)==h}return Ms=c,Ms}var Fs,wl;function Da(){if(wl)return Fs;wl=1;function e(t,s){if(!(s==="constructor"&&typeof t[s]=="function")&&s!="__proto__")return t[s]}return Fs=e,Fs}var Ds,kl;function Jp(){if(kl)return Ds;kl=1;var e=hn(),t=pn(),s=Object.prototype,o=s.hasOwnProperty;function l(a,d,r){var h=a[d];(!(o.call(a,d)&&t(h,r))||r===void 0&&!(d in a))&&e(a,d,r)}return Ds=l,Ds}var Ns,Cl;function Zp(){if(Cl)return Ns;Cl=1;var e=Jp(),t=hn();function s(o,l,a,d){var r=!a;a||(a={});for(var h=-1,c=l.length;++h<c;){var p=l[h],$=d?d(a[p],o[p],p,a,o):void 0;$===void 0&&($=o[p]),r?t(a,p,$):e(a,p,$)}return a}return Ns=s,Ns}var js,Tl;function Qp(){if(Tl)return js;Tl=1;function e(t){var s=[];if(t!=null)for(var o in Object(t))s.push(o);return s}return js=e,js}var qs,Vl;function xp(){if(Vl)return qs;Vl=1;var e=$t(),t=$a(),s=Qp(),o=Object.prototype,l=o.hasOwnProperty;function a(d){if(!e(d))return s(d);var r=t(d),h=[];for(var c in d)c=="constructor"&&(r||!l.call(d,c))||h.push(c);return h}return qs=a,qs}var zs,Sl;function Na(){if(Sl)return zs;Sl=1;var e=vi(),t=xp(),s=mn();function o(l){return s(l)?e(l,!0):t(l)}return zs=o,zs}var Hs,Pl;function em(){if(Pl)return Hs;Pl=1;var e=Zp(),t=Na();function s(o){return e(o,t(o))}return Hs=s,Hs}var Ws,Il;function tm(){if(Il)return Ws;Il=1;var e=Ma(),t=qp(),s=Hp(),o=Wp(),l=Gp(),a=$i(),d=ma(),r=Yp(),h=yi(),c=wi(),p=$t(),$=Xp(),w=ki(),y=Da(),k=em();function S(T,E,M,O,A,K,C){var U=y(T,M),_=y(E,M),R=C.get(_);if(R){e(T,M,R);return}var B=K?K(U,_,M+"",T,E,C):void 0,D=B===void 0;if(D){var z=d(_),L=!z&&h(_),j=!z&&!L&&w(_);B=_,z||L||j?d(U)?B=U:r(U)?B=o(U):L?(D=!1,B=t(_,!0)):j?(D=!1,B=s(_,!0)):B=[]:$(_)||a(_)?(B=U,a(U)?B=k(U):(!p(U)||c(U))&&(B=l(_))):D=!1}D&&(C.set(_,B),A(B,_,O,K,C),C.delete(_)),e(T,M,B)}return Ws=S,Ws}var Ks,El;function sm(){if(El)return Ks;El=1;var e=Ci(),t=Ma(),s=Ti(),o=tm(),l=$t(),a=Na(),d=Da();function r(h,c,p,$,w){h!==c&&s(c,function(y,k){if(w||(w=new e),l(y))o(h,c,k,p,r,$,w);else{var S=$?$(d(h,k),y,k+"",h,c,w):void 0;S===void 0&&(S=y),t(h,k,S)}},a)}return Ks=r,Ks}var Gs,Al;function nm(){if(Al)return Gs;Al=1;function e(t,s,o){switch(o.length){case 0:return t.call(s);case 1:return t.call(s,o[0]);case 2:return t.call(s,o[0],o[1]);case 3:return t.call(s,o[0],o[1],o[2])}return t.apply(s,o)}return Gs=e,Gs}var Ys,_l;function om(){if(_l)return Ys;_l=1;var e=nm(),t=Math.max;function s(o,l,a){return l=t(l===void 0?o.length-1:l,0),function(){for(var d=arguments,r=-1,h=t(d.length-l,0),c=Array(h);++r<h;)c[r]=d[l+r];r=-1;for(var p=Array(l+1);++r<l;)p[r]=d[r];return p[l]=a(c),e(o,this,p)}}return Ys=s,Ys}var Xs,Ll;function lm(){if(Ll)return Xs;Ll=1;function e(t){return function(){return t}}return Xs=e,Xs}var Js,Ol;function am(){if(Ol)return Js;Ol=1;var e=lm(),t=Vi(),s=wa(),o=t?function(l,a){return t(l,"toString",{configurable:!0,enumerable:!1,value:e(a),writable:!0})}:s;return Js=o,Js}var Zs,Ul;function im(){if(Ul)return Zs;Ul=1;var e=800,t=16,s=Date.now;function o(l){var a=0,d=0;return function(){var r=s(),h=t-(r-d);if(d=r,h>0){if(++a>=e)return arguments[0]}else a=0;return l.apply(void 0,arguments)}}return Zs=o,Zs}var Qs,Rl;function rm(){if(Rl)return Qs;Rl=1;var e=am(),t=im(),s=t(e);return Qs=s,Qs}var xs,Bl;function dm(){if(Bl)return xs;Bl=1;var e=wa(),t=om(),s=rm();function o(l,a){return s(t(l,a,e),l+"")}return xs=o,xs}var en,Ml;function um(){if(Ml)return en;Ml=1;var e=pn(),t=mn(),s=Si(),o=$t();function l(a,d,r){if(!o(r))return!1;var h=typeof d;return(h=="number"?t(r)&&s(d,r.length):h=="string"&&d in r)?e(r[d],a):!1}return en=l,en}var tn,Fl;function cm(){if(Fl)return tn;Fl=1;var e=dm(),t=um();function s(o){return e(function(l,a){var d=-1,r=a.length,h=r>1?a[r-1]:void 0,c=r>2?a[2]:void 0;for(h=o.length>3&&typeof h=="function"?(r--,h):void 0,c&&t(a[0],a[1],c)&&(h=r<3?void 0:h,r=1),l=Object(l);++d<r;){var p=a[d];p&&o(l,p,d,h)}return l})}return tn=s,tn}var sn,Dl;function hm(){if(Dl)return sn;Dl=1;var e=sm(),t=cm(),s=t(function(o,l,a){e(o,l,a)});return sn=s,sn}var pm=hm();const mm=un(pm),Xt=typeof window<"u"&&typeof window.document<"u",Ce=Xt?window:{},kn=Xt?"ontouchstart"in Ce.document.documentElement:!1,Cn=Xt?"PointerEvent"in Ce:!1,ze="cropper",Ct=`${ze}-canvas`,fm=`${ze}-crosshair`,gm=`${ze}-grid`,bm=`${ze}-handle`,Jt=`${ze}-image`,Ne=`${ze}-selection`,vm=`${ze}-shade`,$m=`${ze}-viewer`,Nt="select",ja="move",at="scale",an="rotate",jt="transform",De="none",Nl="n-resize",jl="e-resize",ql="s-resize",zl="w-resize",ct="ne-resize",ht="nw-resize",pt="se-resize",mt="sw-resize",ym="action",wm=kn?"touchend touchcancel":"mouseup",km=kn?"touchmove":"mousemove",Cm=kn?"touchstart":"mousedown",Hl=Cn?"pointerdown":Cm,Wl=Cn?"pointermove":km,Kl=Cn?"pointerup pointercancel":wm,Gl="error",Yl="keydown",ot="load",Xl="wheel",it="action",Ke="actionend",Tm="actionmove",Ge="actionstart",je="change",rn="transform";function Vm(e){return typeof e=="string"}const qa=Number.isNaN||Ce.isNaN;function J(e){return typeof e=="number"&&!qa(e)}function ge(e){return J(e)&&e>0&&e<1/0}function Sm(e){return typeof e>"u"}function za(e){return typeof e=="object"&&e!==null}const{hasOwnProperty:Pm}=Object.prototype;function qt(e){if(!za(e))return!1;try{const{constructor:t}=e,{prototype:s}=t;return t&&s&&Pm.call(s,"isPrototypeOf")}catch{return!1}}function Tn(e){return typeof e=="function"}function Ha(e){return typeof e=="object"&&e!==null&&e.nodeType===1}const Im=/([a-z\d])([A-Z])/g;function Jl(e){return String(e).replace(Im,"$1-$2").toLowerCase()}const Em=/-[A-z\d]/g;function Zl(e){return e.replace(Em,t=>t.slice(1).toUpperCase())}const Wa=/\s\s*/;function oe(e,t,s,o){t.trim().split(Wa).forEach(l=>{e.removeEventListener(l,s,o)})}function le(e,t,s,o){t.trim().split(Wa).forEach(l=>{e.addEventListener(l,s,o)})}function Ql(e,t,s,o){le(e,t,s,Object.assign(Object.assign({},o),{once:!0}))}const Am={bubbles:!0,cancelable:!0,composed:!0};function _m(e,t,s,o){return e.dispatchEvent(new CustomEvent(t,Object.assign(Object.assign(Object.assign({},Am),{detail:s}),o)))}const xl=Promise.resolve();function Lm(e,t){return t?xl.then(e?t.bind(e):t):xl}function ea(e){const{documentElement:t}=e.ownerDocument,s=e.getBoundingClientRect();return{left:s.left+(Ce.pageXOffset-t.clientLeft),top:s.top+(Ce.pageYOffset-t.clientTop)}}const Om=/deg|g?rad|turn$/i;function nn(e){const t=parseFloat(e)||0;if(t!==0){const[s="rad"]=String(e).match(Om)||[];switch(s.toLowerCase()){case"deg":return t/360*(Math.PI*2);case"grad":return t/400*(Math.PI*2);case"turn":return t*(Math.PI*2)}}return t}const ta="contain",Um="cover";function Mt(e,t=ta){const{aspectRatio:s}=e;let{width:o,height:l}=e;const a=ge(o),d=ge(l);if(a&&d){const r=l*s;t===ta&&r>o||t===Um&&r<o?l=o/s:o=l*s}else a?l=o/s:d&&(o=l*s);return{width:o,height:l}}function Ka(e,...t){if(t.length===0)return e;const[s,o,l,a,d,r]=e,[h,c,p,$,w,y]=t[0];return e=[s*h+l*c,o*h+a*c,s*p+l*$,o*p+a*$,s*w+l*y+d,o*w+a*y+r],Ka(e,...t.slice(1))}var Rm=":host([hidden]){display:none!important}";const Bm=/left|top|width|height/i,sa="open",Ut=new WeakMap,Rt=new WeakMap,na=new Map,oa=Ce.document&&Array.isArray(Ce.document.adoptedStyleSheets)&&"replaceSync"in Ce.CSSStyleSheet.prototype;class Ue extends HTMLElement{get $sharedStyle(){return`${this.themeColor?`:host{--theme-color: ${this.themeColor};}`:""}${Rm}`}constructor(){var t,s;super(),this.shadowRootMode=sa,this.slottable=!0;const o=(s=(t=Object.getPrototypeOf(this))===null||t===void 0?void 0:t.constructor)===null||s===void 0?void 0:s.$name;o&&na.set(o,this.tagName.toLowerCase())}static get observedAttributes(){return["shadow-root-mode","slottable","theme-color"]}attributeChangedCallback(t,s,o){if(Object.is(o,s))return;const l=Zl(t),a=this[l];let d=o;switch(typeof a){case"boolean":d=o!==null&&o!=="false";break;case"number":d=Number(o);break}switch(this[l]=d,t){case"theme-color":{const r=Rt.get(this),h=this.$sharedStyle;r&&h&&(oa?r.replaceSync(h):r.textContent=h);break}}}$propertyChangedCallback(t,s,o){if(!Object.is(o,s))switch(t=Jl(t),typeof o){case"boolean":o===!0?this.hasAttribute(t)||this.setAttribute(t,""):this.removeAttribute(t);break;case"number":qa(o)?o="":o=String(o);default:o?this.getAttribute(t)!==o&&this.setAttribute(t,o):this.removeAttribute(t)}}connectedCallback(){Object.getPrototypeOf(this).constructor.observedAttributes.forEach(s=>{const o=Zl(s);let l=this[o];Sm(l)||this.$propertyChangedCallback(o,void 0,l),Object.defineProperty(this,o,{enumerable:!0,configurable:!0,get(){return l},set(a){const d=l;l=a,this.$propertyChangedCallback(o,d,a)}})});const t=this.attachShadow({mode:this.shadowRootMode||sa});if(this.shadowRoot||Ut.set(this,t),Rt.set(this,this.$addStyles(this.$sharedStyle)),this.$style&&this.$addStyles(this.$style),this.$template){const s=document.createElement("template");s.innerHTML=this.$template,t.appendChild(s.content)}if(this.slottable){const s=document.createElement("slot");t.appendChild(s)}}disconnectedCallback(){Rt.has(this)&&Rt.delete(this),Ut.has(this)&&Ut.delete(this)}$getTagNameOf(t){var s;return(s=na.get(t))!==null&&s!==void 0?s:t}$setStyles(t){return Object.keys(t).forEach(s=>{let o=t[s];J(o)&&(o!==0&&Bm.test(s)?o=`${o}px`:o=String(o)),this.style[s]=o}),this}$getShadowRoot(){return this.shadowRoot||Ut.get(this)}$addStyles(t){let s;const o=this.$getShadowRoot();return oa?(s=new CSSStyleSheet,s.replaceSync(t),o.adoptedStyleSheets=o.adoptedStyleSheets.concat(s)):(s=document.createElement("style"),s.textContent=t,o.appendChild(s)),s}$emit(t,s,o){return _m(this,t,s,o)}$nextTick(t){return Lm(this,t)}static $define(t,s){za(t)&&(s=t,t=""),t||(t=this.$name||this.name),t=Jl(t),Xt&&Ce.customElements&&!Ce.customElements.get(t)&&customElements.define(t,this,s)}}Ue.$version="2.0.0";var Mm=':host{display:block;min-height:100px;min-width:200px;overflow:hidden;position:relative;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}:host([background]){background-color:#fff;background-image:repeating-linear-gradient(45deg,#ccc 25%,transparent 0,transparent 75%,#ccc 0,#ccc),repeating-linear-gradient(45deg,#ccc 25%,transparent 0,transparent 75%,#ccc 0,#ccc);background-image:repeating-conic-gradient(#ccc 0 25%,#fff 0 50%);background-position:0 0,.5rem .5rem;background-size:1rem 1rem}:host([disabled]){pointer-events:none}:host([disabled]):after{bottom:0;content:"";cursor:not-allowed;display:block;left:0;pointer-events:none;position:absolute;right:0;top:0}';class Vn extends Ue{constructor(){super(...arguments),this.$onPointerDown=null,this.$onPointerMove=null,this.$onPointerUp=null,this.$onWheel=null,this.$wheeling=!1,this.$pointers=new Map,this.$style=Mm,this.$action=De,this.background=!1,this.disabled=!1,this.scaleStep=.1,this.themeColor="#39f"}static get observedAttributes(){return super.observedAttributes.concat(["background","disabled","scale-step"])}connectedCallback(){super.connectedCallback(),this.disabled||this.$bind()}disconnectedCallback(){this.disabled||this.$unbind(),super.disconnectedCallback()}$propertyChangedCallback(t,s,o){if(!Object.is(o,s))switch(super.$propertyChangedCallback(t,s,o),t){case"disabled":o?this.$unbind():this.$bind();break}}$bind(){this.$onPointerDown||(this.$onPointerDown=this.$handlePointerDown.bind(this),le(this,Hl,this.$onPointerDown)),this.$onPointerMove||(this.$onPointerMove=this.$handlePointerMove.bind(this),le(this.ownerDocument,Wl,this.$onPointerMove)),this.$onPointerUp||(this.$onPointerUp=this.$handlePointerUp.bind(this),le(this.ownerDocument,Kl,this.$onPointerUp)),this.$onWheel||(this.$onWheel=this.$handleWheel.bind(this),le(this,Xl,this.$onWheel,{passive:!1,capture:!0}))}$unbind(){this.$onPointerDown&&(oe(this,Hl,this.$onPointerDown),this.$onPointerDown=null),this.$onPointerMove&&(oe(this.ownerDocument,Wl,this.$onPointerMove),this.$onPointerMove=null),this.$onPointerUp&&(oe(this.ownerDocument,Kl,this.$onPointerUp),this.$onPointerUp=null),this.$onWheel&&(oe(this,Xl,this.$onWheel,{capture:!0}),this.$onWheel=null)}$handlePointerDown(t){const{buttons:s,button:o,type:l}=t;if(this.disabled||(l==="pointerdown"&&t.pointerType==="mouse"||l==="mousedown")&&(J(s)&&s!==1||J(o)&&o!==0||t.ctrlKey))return;const{$pointers:a}=this;let d="";if(t.changedTouches)Array.from(t.changedTouches).forEach(({identifier:r,pageX:h,pageY:c})=>{a.set(r,{startX:h,startY:c,endX:h,endY:c})});else{const{pointerId:r=0,pageX:h,pageY:c}=t;a.set(r,{startX:h,startY:c,endX:h,endY:c})}a.size>1?d=jt:Ha(t.target)&&(d=t.target.action||t.target.getAttribute(ym)||""),this.$emit(Ge,{action:d,relatedEvent:t})!==!1&&(t.preventDefault(),this.$action=d,this.style.willChange="transform")}$handlePointerMove(t){const{$action:s,$pointers:o}=this;if(this.disabled||s===De||o.size===0||this.$emit(Tm,{action:s,relatedEvent:t})===!1)return;if(t.preventDefault(),t.changedTouches)Array.from(t.changedTouches).forEach(({identifier:a,pageX:d,pageY:r})=>{const h=o.get(a);h&&Object.assign(h,{endX:d,endY:r})});else{const{pointerId:a=0,pageX:d,pageY:r}=t,h=o.get(a);h&&Object.assign(h,{endX:d,endY:r})}const l={action:s,relatedEvent:t};if(s===jt){const a=new Map(o);let d=0,r=0,h=0,c=0,p=t.pageX,$=t.pageY;o.forEach((k,S)=>{a.delete(S),a.forEach(T=>{let E=T.startX-k.startX,M=T.startY-k.startY,O=T.endX-k.endX,A=T.endY-k.endY,K=0,C=0,U=0,_=0;if(E===0?M<0?U=Math.PI*2:M>0&&(U=Math.PI):E>0?U=Math.PI/2+Math.atan(M/E):E<0&&(U=Math.PI*1.5+Math.atan(M/E)),O===0?A<0?_=Math.PI*2:A>0&&(_=Math.PI):O>0?_=Math.PI/2+Math.atan(A/O):O<0&&(_=Math.PI*1.5+Math.atan(A/O)),_>0||U>0){const R=_-U,B=Math.abs(R);B>d&&(d=B,h=R,p=(k.startX+T.startX)/2,$=(k.startY+T.startY)/2)}if(E=Math.abs(E),M=Math.abs(M),O=Math.abs(O),A=Math.abs(A),E>0&&M>0?K=Math.sqrt(E*E+M*M):E>0?K=E:M>0&&(K=M),O>0&&A>0?C=Math.sqrt(O*O+A*A):O>0?C=O:A>0&&(C=A),K>0&&C>0){const R=(C-K)/K,B=Math.abs(R);B>r&&(r=B,c=R,p=(k.startX+T.startX)/2,$=(k.startY+T.startY)/2)}})});const w=d>0,y=r>0;w&&y?(l.rotate=h,l.scale=c,l.centerX=p,l.centerY=$):w?(l.action=an,l.rotate=h,l.centerX=p,l.centerY=$):y?(l.action=at,l.scale=c,l.centerX=p,l.centerY=$):l.action=De}else{const[a]=Array.from(o.values());Object.assign(l,a)}o.forEach(a=>{a.startX=a.endX,a.startY=a.endY}),l.action!==De&&this.$emit(it,l,{cancelable:!1})}$handlePointerUp(t){const{$action:s,$pointers:o}=this;if(!(this.disabled||s===De)&&this.$emit(Ke,{action:s,relatedEvent:t})!==!1){if(t.preventDefault(),t.changedTouches)Array.from(t.changedTouches).forEach(({identifier:l})=>{o.delete(l)});else{const{pointerId:l=0}=t;o.delete(l)}o.size===0&&(this.style.willChange="",this.$action=De)}}$handleWheel(t){if(this.disabled||(t.preventDefault(),this.$wheeling))return;this.$wheeling=!0,setTimeout(()=>{this.$wheeling=!1},50);const o=(t.deltaY>0?-1:1)*this.scaleStep;this.$emit(it,{action:at,scale:o,relatedEvent:t},{cancelable:!1})}$setAction(t){return Vm(t)&&(this.$action=t),this}$toCanvas(t){return new Promise((s,o)=>{if(!this.isConnected){o(new Error("The current element is not connected to the DOM."));return}const l=document.createElement("canvas");let a=this.offsetWidth,d=this.offsetHeight,r=1;qt(t)&&(ge(t.width)||ge(t.height))&&({width:a,height:d}=Mt({aspectRatio:a/d,width:t.width,height:t.height}),r=a/this.offsetWidth),l.width=a,l.height=d;const h=this.querySelector(this.$getTagNameOf(Jt));if(!h){s(l);return}h.$ready().then(c=>{const p=l.getContext("2d");if(p){const[$,w,y,k,S,T]=h.$getTransform();let E=S,M=T,O=c.naturalWidth,A=c.naturalHeight;r!==1&&(E*=r,M*=r,O*=r,A*=r);const K=O/2,C=A/2;p.fillStyle="transparent",p.fillRect(0,0,a,d),qt(t)&&Tn(t.beforeDraw)&&t.beforeDraw.call(this,p,l),p.save(),p.translate(K,C),p.transform($,w,y,k,E,M),p.translate(-K,-C),p.drawImage(c,0,0,O,A),p.restore()}s(l)}).catch(o)})}}Vn.$name=Ct;Vn.$version="2.0.0";var Fm=":host{display:inline-block}img{display:block;height:100%;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}";const la=new WeakMap,aa=["alt","crossorigin","decoding","importance","loading","referrerpolicy","sizes","src","srcset"];class Sn extends Ue{constructor(){super(...arguments),this.$matrix=[1,0,0,1,0,0],this.$onLoad=null,this.$onCanvasAction=null,this.$onCanvasActionEnd=null,this.$onCanvasActionStart=null,this.$actionStartTarget=null,this.$style=Fm,this.$image=new Image,this.initialCenterSize="contain",this.rotatable=!1,this.scalable=!1,this.skewable=!1,this.slottable=!1,this.translatable=!1}set $canvas(t){la.set(this,t)}get $canvas(){return la.get(this)}static get observedAttributes(){return super.observedAttributes.concat(aa,["initial-center-size","rotatable","scalable","skewable","translatable"])}attributeChangedCallback(t,s,o){Object.is(o,s)||(super.attributeChangedCallback(t,s,o),aa.includes(t)&&this.$image.setAttribute(t,o))}$propertyChangedCallback(t,s,o){if(!Object.is(o,s))switch(super.$propertyChangedCallback(t,s,o),t){case"initialCenterSize":this.$nextTick(()=>{this.$center(o)});break}}connectedCallback(){super.connectedCallback();const{$image:t}=this,s=this.closest(this.$getTagNameOf(Ct));s&&(this.$canvas=s,this.$setStyles({display:"block",position:"absolute"}),this.$onCanvasActionStart=o=>{var l,a;this.$actionStartTarget=(a=(l=o.detail)===null||l===void 0?void 0:l.relatedEvent)===null||a===void 0?void 0:a.target},this.$onCanvasActionEnd=()=>{this.$actionStartTarget=null},this.$onCanvasAction=this.$handleAction.bind(this),le(s,Ge,this.$onCanvasActionStart),le(s,Ke,this.$onCanvasActionEnd),le(s,it,this.$onCanvasAction)),this.$onLoad=this.$handleLoad.bind(this),le(t,ot,this.$onLoad),this.$getShadowRoot().appendChild(t)}disconnectedCallback(){const{$image:t,$canvas:s}=this;s&&(this.$onCanvasActionStart&&(oe(s,Ge,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(oe(s,Ke,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onCanvasAction&&(oe(s,it,this.$onCanvasAction),this.$onCanvasAction=null)),t&&this.$onLoad&&(oe(t,ot,this.$onLoad),this.$onLoad=null),this.$getShadowRoot().removeChild(t),super.disconnectedCallback()}$handleLoad(){const{$image:t}=this;this.$setStyles({width:t.naturalWidth,height:t.naturalHeight}),this.$canvas&&this.$center(this.initialCenterSize)}$handleAction(t){if(this.hidden||!(this.rotatable||this.scalable||this.translatable))return;const{$canvas:s}=this,{detail:o}=t;if(o){const{relatedEvent:l}=o;let{action:a}=o;switch(a===jt&&(!this.rotatable||!this.scalable)&&(this.rotatable?a=an:this.scalable?a=at:a=De),a){case ja:if(this.translatable){let d=null;l&&(d=l.target.closest(this.$getTagNameOf(Ne))),d||(d=s.querySelector(this.$getTagNameOf(Ne))),d&&d.multiple&&!d.active&&(d=s.querySelector(`${this.$getTagNameOf(Ne)}[active]`)),(!d||d.hidden||!d.movable||d.dynamic||!(this.$actionStartTarget&&d.contains(this.$actionStartTarget)))&&this.$move(o.endX-o.startX,o.endY-o.startY)}break;case an:if(this.rotatable)if(l){const{x:d,y:r}=this.getBoundingClientRect();this.$rotate(o.rotate,l.clientX-d,l.clientY-r)}else this.$rotate(o.rotate);break;case at:if(this.scalable)if(l){const d=l.target.closest(this.$getTagNameOf(Ne));if(!d||!d.zoomable||d.zoomable&&d.dynamic){const{x:r,y:h}=this.getBoundingClientRect();this.$zoom(o.scale,l.clientX-r,l.clientY-h)}}else this.$zoom(o.scale);break;case jt:if(this.rotatable&&this.scalable){const{rotate:d}=o;let{scale:r}=o;r<0?r=1/(1-r):r+=1;const h=Math.cos(d),c=Math.sin(d),[p,$,w,y]=[h*r,c*r,-c*r,h*r];if(l){const k=this.getBoundingClientRect(),S=l.clientX-k.x,T=l.clientY-k.y,[E,M,O,A]=this.$matrix,K=k.width/2,C=k.height/2,U=S-K,_=T-C,R=(U*A-O*_)/(E*A-O*M),B=(_*E-M*U)/(E*A-O*M);this.$transform(p,$,w,y,R*(1-p)+B*w,B*(1-y)+R*$)}else this.$transform(p,$,w,y,0,0)}break}}}$ready(t){const{$image:s}=this,o=new Promise((l,a)=>{const d=new Error("Failed to load the image source");if(s.complete)s.naturalWidth>0&&s.naturalHeight>0?l(s):a(d);else{const r=()=>{oe(s,Gl,h),l(s)},h=()=>{oe(s,ot,r),a(d)};Ql(s,ot,r),Ql(s,Gl,h)}});return Tn(t)&&o.then(l=>(t(l),l)),o}$center(t){const{parentElement:s}=this;if(!s)return this;const o=s.getBoundingClientRect(),l=o.width,a=o.height,{x:d,y:r,width:h,height:c}=this.getBoundingClientRect(),p=d+h/2,$=r+c/2,w=o.x+l/2,y=o.y+a/2;if(this.$move(w-p,y-$),t&&(h!==l||c!==a)){const k=l/h,S=a/c;switch(t){case"cover":this.$scale(Math.max(k,S));break;case"contain":this.$scale(Math.min(k,S));break}}return this}$move(t,s=t){if(this.translatable&&J(t)&&J(s)){const[o,l,a,d]=this.$matrix,r=(t*d-a*s)/(o*d-a*l),h=(s*o-l*t)/(o*d-a*l);this.$translate(r,h)}return this}$moveTo(t,s=t){if(this.translatable&&J(t)&&J(s)){const[o,l,a,d]=this.$matrix,r=(t*d-a*s)/(o*d-a*l),h=(s*o-l*t)/(o*d-a*l);this.$setTransform(o,l,a,d,r,h)}return this}$rotate(t,s,o){if(this.rotatable){const l=nn(t),a=Math.cos(l),d=Math.sin(l),[r,h,c,p]=[a,d,-d,a];if(J(s)&&J(o)){const[$,w,y,k]=this.$matrix,{width:S,height:T}=this.getBoundingClientRect(),E=S/2,M=T/2,O=s-E,A=o-M,K=(O*k-y*A)/($*k-y*w),C=(A*$-w*O)/($*k-y*w);this.$transform(r,h,c,p,K*(1-r)-C*c,C*(1-p)-K*h)}else this.$transform(r,h,c,p,0,0)}return this}$zoom(t,s,o){if(!this.scalable||t===0)return this;if(t<0?t=1/(1-t):t+=1,J(s)&&J(o)){const[l,a,d,r]=this.$matrix,{width:h,height:c}=this.getBoundingClientRect(),p=h/2,$=c/2,w=s-p,y=o-$,k=(w*r-d*y)/(l*r-d*a),S=(y*l-a*w)/(l*r-d*a);this.$transform(t,0,0,t,k*(1-t),S*(1-t))}else this.$scale(t);return this}$scale(t,s=t){return this.scalable&&this.$transform(t,0,0,s,0,0),this}$skew(t,s=0){if(this.skewable){const o=nn(t),l=nn(s);this.$transform(1,Math.tan(l),Math.tan(o),1,0,0)}return this}$translate(t,s=t){return this.translatable&&J(t)&&J(s)&&this.$transform(1,0,0,1,t,s),this}$transform(t,s,o,l,a,d){return J(t)&&J(s)&&J(o)&&J(l)&&J(a)&&J(d)?this.$setTransform(Ka(this.$matrix,[t,s,o,l,a,d])):this}$setTransform(t,s,o,l,a,d){if((this.rotatable||this.scalable||this.skewable||this.translatable)&&(Array.isArray(t)&&([t,s,o,l,a,d]=t),J(t)&&J(s)&&J(o)&&J(l)&&J(a)&&J(d))){const r=[...this.$matrix],h=[t,s,o,l,a,d];if(this.$emit(rn,{matrix:h,oldMatrix:r})===!1)return this;this.$matrix=h,this.style.transform=`matrix(${h.join(", ")})`}return this}$getTransform(){return this.$matrix.slice()}$resetTransform(){return this.$setTransform([1,0,0,1,0,0])}}Sn.$name=Jt;Sn.$version="2.0.0";var Dm=":host{display:block;height:0;left:0;outline:var(--theme-color) solid 1px;position:relative;top:0;width:0}:host([transparent]){outline-color:transparent}";const ia=new WeakMap;class Pn extends Ue{constructor(){super(...arguments),this.$onCanvasChange=null,this.$onCanvasActionEnd=null,this.$onCanvasActionStart=null,this.$style=Dm,this.x=0,this.y=0,this.width=0,this.height=0,this.slottable=!1,this.themeColor="rgba(0, 0, 0, 0.65)"}set $canvas(t){ia.set(this,t)}get $canvas(){return ia.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["height","width","x","y"])}connectedCallback(){super.connectedCallback();const t=this.closest(this.$getTagNameOf(Ct));if(t){this.$canvas=t,this.style.position="absolute";const s=t.querySelector(this.$getTagNameOf(Ne));s&&(this.$onCanvasActionStart=o=>{s.hidden&&o.detail.action===Nt&&(this.hidden=!1)},this.$onCanvasActionEnd=o=>{s.hidden&&o.detail.action===Nt&&(this.hidden=!0)},this.$onCanvasChange=o=>{const{x:l,y:a,width:d,height:r}=o.detail;this.$change(l,a,d,r),(s.hidden||l===0&&a===0&&d===0&&r===0)&&(this.hidden=!0)},le(t,Ge,this.$onCanvasActionStart),le(t,Ke,this.$onCanvasActionEnd),le(t,je,this.$onCanvasChange))}this.$render()}disconnectedCallback(){const{$canvas:t}=this;t&&(this.$onCanvasActionStart&&(oe(t,Ge,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(oe(t,Ke,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onCanvasChange&&(oe(t,je,this.$onCanvasChange),this.$onCanvasChange=null)),super.disconnectedCallback()}$change(t,s,o=this.width,l=this.height){return!J(t)||!J(s)||!J(o)||!J(l)||t===this.x&&s===this.y&&o===this.width&&l===this.height?this:(this.hidden&&(this.hidden=!1),this.x=t,this.y=s,this.width=o,this.height=l,this.$render())}$reset(){return this.$change(0,0,0,0)}$render(){return this.$setStyles({transform:`translate(${this.x}px, ${this.y}px)`,width:this.width,height:this.height,outlineWidth:Ce.innerWidth})}}Pn.$name=vm;Pn.$version="2.0.0";var Nm=':host{background-color:var(--theme-color);display:block}:host([action=move]),:host([action=select]){height:100%;left:0;position:absolute;top:0;width:100%}:host([action=move]){cursor:move}:host([action=select]){cursor:crosshair}:host([action$=-resize]){background-color:transparent;height:15px;position:absolute;width:15px}:host([action$=-resize]):after{background-color:var(--theme-color);content:"";display:block;height:5px;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:5px}:host([action=n-resize]),:host([action=s-resize]){cursor:ns-resize;left:50%;transform:translateX(-50%);width:100%}:host([action=n-resize]){top:-8px}:host([action=s-resize]){bottom:-8px}:host([action=e-resize]),:host([action=w-resize]){cursor:ew-resize;height:100%;top:50%;transform:translateY(-50%)}:host([action=e-resize]){right:-8px}:host([action=w-resize]){left:-8px}:host([action=ne-resize]){cursor:nesw-resize;right:-8px;top:-8px}:host([action=nw-resize]){cursor:nwse-resize;left:-8px;top:-8px}:host([action=se-resize]){bottom:-8px;cursor:nwse-resize;right:-8px}:host([action=se-resize]):after{height:15px;width:15px}@media (pointer:coarse){:host([action=se-resize]):after{height:10px;width:10px}}@media (pointer:fine){:host([action=se-resize]):after{height:5px;width:5px}}:host([action=sw-resize]){bottom:-8px;cursor:nesw-resize;left:-8px}:host([plain]){background-color:transparent}';class In extends Ue{constructor(){super(...arguments),this.$onCanvasCropEnd=null,this.$onCanvasCropStart=null,this.$style=Nm,this.action=De,this.plain=!1,this.slottable=!1,this.themeColor="rgba(51, 153, 255, 0.5)"}static get observedAttributes(){return super.observedAttributes.concat(["action","plain"])}}In.$name=bm;In.$version="2.0.0";var jm=':host{display:block;left:0;position:relative;right:0}:host([outlined]){outline:1px solid var(--theme-color)}:host([multiple]){outline:1px dashed hsla(0,0%,100%,.5)}:host([multiple]):after{bottom:0;content:"";cursor:pointer;display:block;left:0;position:absolute;right:0;top:0}:host([multiple][active]){outline-color:var(--theme-color);z-index:1}:host([multiple])>*{visibility:hidden}:host([multiple][active])>*{visibility:visible}:host([multiple][active]):after{display:none}';const ra=new WeakMap;class En extends Ue{constructor(){super(...arguments),this.$onCanvasAction=null,this.$onCanvasActionStart=null,this.$onCanvasActionEnd=null,this.$onDocumentKeyDown=null,this.$action="",this.$actionStartTarget=null,this.$changing=!1,this.$style=jm,this.$initialSelection={x:0,y:0,width:0,height:0},this.x=0,this.y=0,this.width=0,this.height=0,this.aspectRatio=NaN,this.initialAspectRatio=NaN,this.initialCoverage=NaN,this.active=!1,this.linked=!1,this.dynamic=!1,this.movable=!1,this.resizable=!1,this.zoomable=!1,this.multiple=!1,this.keyboard=!1,this.outlined=!1,this.precise=!1}set $canvas(t){ra.set(this,t)}get $canvas(){return ra.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["active","aspect-ratio","dynamic","height","initial-aspect-ratio","initial-coverage","keyboard","linked","movable","multiple","outlined","precise","resizable","width","x","y","zoomable"])}$propertyChangedCallback(t,s,o){if(!Object.is(o,s))switch(super.$propertyChangedCallback(t,s,o),t){case"x":case"y":case"width":case"height":this.$changing||this.$nextTick(()=>{this.$change(this.x,this.y,this.width,this.height,this.aspectRatio,!0)});break;case"aspectRatio":case"initialAspectRatio":this.$nextTick(()=>{this.$initSelection()});break;case"initialCoverage":this.$nextTick(()=>{ge(o)&&o<=1&&this.$initSelection(!0,!0)});break;case"keyboard":this.$nextTick(()=>{this.$canvas&&(o?this.$onDocumentKeyDown||(this.$onDocumentKeyDown=this.$handleKeyDown.bind(this),le(this.ownerDocument,Yl,this.$onDocumentKeyDown)):this.$onDocumentKeyDown&&(oe(this.ownerDocument,Yl,this.$onDocumentKeyDown),this.$onDocumentKeyDown=null))});break;case"multiple":this.$nextTick(()=>{if(this.$canvas){const l=this.$getSelections();o?(l.forEach(a=>{a.active=!1}),this.active=!0,this.$emit(je,{x:this.x,y:this.y,width:this.width,height:this.height})):(this.active=!1,l.slice(1).forEach(a=>{this.$removeSelection(a)}))}});break;case"precise":this.$nextTick(()=>{this.$change(this.x,this.y)});break;case"linked":o&&(this.dynamic=!0);break}}connectedCallback(){super.connectedCallback();const t=this.closest(this.$getTagNameOf(Ct));t?(this.$canvas=t,this.$setStyles({position:"absolute",transform:`translate(${this.x}px, ${this.y}px)`}),this.hidden||this.$render(),this.$initSelection(!0),this.$onCanvasActionStart=this.$handleActionStart.bind(this),this.$onCanvasActionEnd=this.$handleActionEnd.bind(this),this.$onCanvasAction=this.$handleAction.bind(this),le(t,Ge,this.$onCanvasActionStart),le(t,Ke,this.$onCanvasActionEnd),le(t,it,this.$onCanvasAction)):this.$render()}disconnectedCallback(){const{$canvas:t}=this;t&&(this.$onCanvasActionStart&&(oe(t,Ge,this.$onCanvasActionStart),this.$onCanvasActionStart=null),this.$onCanvasActionEnd&&(oe(t,Ke,this.$onCanvasActionEnd),this.$onCanvasActionEnd=null),this.$onCanvasAction&&(oe(t,it,this.$onCanvasAction),this.$onCanvasAction=null)),super.disconnectedCallback()}$getSelections(){let t=[];return this.parentElement&&(t=Array.from(this.parentElement.querySelectorAll(this.$getTagNameOf(Ne)))),t}$initSelection(t=!1,s=!1){const{initialCoverage:o,parentElement:l}=this;if(ge(o)&&l){const a=this.aspectRatio||this.initialAspectRatio;let d=(s?0:this.width)||l.offsetWidth*o,r=(s?0:this.height)||l.offsetHeight*o;ge(a)&&({width:d,height:r}=Mt({aspectRatio:a,width:d,height:r})),this.$change(this.x,this.y,d,r),t&&this.$center(),this.$initialSelection={x:this.x,y:this.y,width:this.width,height:this.height}}}$createSelection(){const t=this.cloneNode(!0);return this.hasAttribute("id")&&t.removeAttribute("id"),t.initialCoverage=NaN,this.active=!1,this.parentElement&&this.parentElement.insertBefore(t,this.nextSibling),t}$removeSelection(t=this){if(this.parentElement){const s=this.$getSelections();if(s.length>1){const o=s.indexOf(t),l=s[o+1]||s[o-1];l&&(t.active=!1,this.parentElement.removeChild(t),l.active=!0,l.$emit(je,{x:l.x,y:l.y,width:l.width,height:l.height}))}else this.$clear()}}$handleActionStart(t){var s,o;const l=(o=(s=t.detail)===null||s===void 0?void 0:s.relatedEvent)===null||o===void 0?void 0:o.target;this.$action="",this.$actionStartTarget=l,!this.hidden&&this.multiple&&!this.active&&l===this&&this.parentElement&&(this.$getSelections().forEach(a=>{a.active=!1}),this.active=!0,this.$emit(je,{x:this.x,y:this.y,width:this.width,height:this.height}))}$handleAction(t){const{currentTarget:s,detail:o}=t;if(!s||!o)return;const{relatedEvent:l}=o;let{action:a}=o;if(!a&&this.multiple&&(a=this.$action||(l==null?void 0:l.target.action),this.$action=a),!a||this.hidden&&a!==Nt||this.multiple&&!this.active&&a!==at)return;const d=o.endX-o.startX,r=o.endY-o.startY,{width:h,height:c}=this;let{aspectRatio:p}=this;switch(!ge(p)&&l.shiftKey&&(p=ge(h)&&ge(c)?h/c:1),a){case Nt:if(d!==0&&r!==0){const{$canvas:$}=this,w=ea(s);(this.multiple&&!this.hidden?this.$createSelection():this).$change(o.startX-w.left,o.startY-w.top,Math.abs(d),Math.abs(r),p),d<0?r<0?a=ht:r>0&&(a=mt):d>0&&(r<0?a=ct:r>0&&(a=pt)),$&&($.$action=a)}break;case ja:this.movable&&(this.dynamic||this.$actionStartTarget&&this.contains(this.$actionStartTarget))&&this.$move(d,r);break;case at:if(l&&this.zoomable&&(this.dynamic||this.contains(l.target))){const $=ea(s);this.$zoom(o.scale,l.pageX-$.left,l.pageY-$.top)}break;default:this.$resize(a,d,r,p)}}$handleActionEnd(){this.$action="",this.$actionStartTarget=null}$handleKeyDown(t){if(this.hidden||!this.keyboard||this.multiple&&!this.active||t.defaultPrevented)return;const{activeElement:s}=document;if(!(s&&(["INPUT","TEXTAREA"].includes(s.tagName)||["true","plaintext-only"].includes(s.contentEditable))))switch(t.key){case"Backspace":t.metaKey&&(t.preventDefault(),this.$removeSelection());break;case"Delete":t.preventDefault(),this.$removeSelection();break;case"ArrowLeft":t.preventDefault(),this.$move(-1,0);break;case"ArrowRight":t.preventDefault(),this.$move(1,0);break;case"ArrowUp":t.preventDefault(),this.$move(0,-1);break;case"ArrowDown":t.preventDefault(),this.$move(0,1);break;case"+":t.preventDefault(),this.$zoom(.1);break;case"-":t.preventDefault(),this.$zoom(-.1);break}}$center(){const{parentElement:t}=this;if(!t)return this;const s=(t.offsetWidth-this.width)/2,o=(t.offsetHeight-this.height)/2;return this.$change(s,o)}$move(t,s=t){return this.$moveTo(this.x+t,this.y+s)}$moveTo(t,s=t){return this.movable?this.$change(t,s):this}$resize(t,s=0,o=0,l=this.aspectRatio){if(!this.resizable)return this;const a=ge(l),{$canvas:d}=this;let{x:r,y:h,width:c,height:p}=this;switch(t){case Nl:h+=o,p-=o,p<0&&(t=ql,p=-p,h-=p),a&&(s=o*l,r+=s/2,c-=s,c<0&&(c=-c,r-=c));break;case jl:c+=s,c<0&&(t=zl,c=-c,r-=c),a&&(o=s/l,h-=o/2,p+=o,p<0&&(p=-p,h-=p));break;case ql:p+=o,p<0&&(t=Nl,p=-p,h-=p),a&&(s=o*l,r-=s/2,c+=s,c<0&&(c=-c,r-=c));break;case zl:r+=s,c-=s,c<0&&(t=jl,c=-c,r-=c),a&&(o=s/l,h+=o/2,p-=o,p<0&&(p=-p,h-=p));break;case ct:a&&(o=-s/l),h+=o,p-=o,c+=s,c<0&&p<0?(t=mt,c=-c,p=-p,r-=c,h-=p):c<0?(t=ht,c=-c,r-=c):p<0&&(t=pt,p=-p,h-=p);break;case ht:a&&(o=s/l),r+=s,h+=o,c-=s,p-=o,c<0&&p<0?(t=pt,c=-c,p=-p,r-=c,h-=p):c<0?(t=ct,c=-c,r-=c):p<0&&(t=mt,p=-p,h-=p);break;case pt:a&&(o=s/l),c+=s,p+=o,c<0&&p<0?(t=ht,c=-c,p=-p,r-=c,h-=p):c<0?(t=mt,c=-c,r-=c):p<0&&(t=ct,p=-p,h-=p);break;case mt:a&&(o=-s/l),r+=s,c-=s,p+=o,c<0&&p<0?(t=ct,c=-c,p=-p,r-=c,h-=p):c<0?(t=pt,c=-c,r-=c):p<0&&(t=ht,p=-p,h-=p);break}return d&&d.$setAction(t),this.$change(r,h,c,p)}$zoom(t,s,o){if(!this.zoomable||t===0)return this;t<0?t=1/(1-t):t+=1;const{width:l,height:a}=this,d=l*t,r=a*t;let h=this.x,c=this.y;return J(s)&&J(o)?(h-=(d-l)*((s-this.x)/l),c-=(r-a)*((o-this.y)/a)):(h-=(d-l)/2,c-=(r-a)/2),this.$change(h,c,d,r)}$change(t,s,o=this.width,l=this.height,a=this.aspectRatio,d=!1){return this.$changing||!J(t)||!J(s)||!J(o)||!J(l)||o<0||l<0?this:(ge(a)&&({width:o,height:l}=Mt({aspectRatio:a,width:o,height:l},"cover")),this.precise||(t=Math.round(t),s=Math.round(s),o=Math.round(o),l=Math.round(l)),t===this.x&&s===this.y&&o===this.width&&l===this.height&&Object.is(a,this.aspectRatio)&&!d?this:(this.hidden&&(this.hidden=!1),this.$emit(je,{x:t,y:s,width:o,height:l})===!1?this:(this.$changing=!0,this.x=t,this.y=s,this.width=o,this.height=l,this.$changing=!1,this.$render())))}$reset(){const{x:t,y:s,width:o,height:l}=this.$initialSelection;return this.$change(t,s,o,l)}$clear(){return this.$change(0,0,0,0,NaN,!0),this.hidden=!0,this}$render(){return this.$setStyles({transform:`translate(${this.x}px, ${this.y}px)`,width:this.width,height:this.height})}$toCanvas(t){return new Promise((s,o)=>{if(!this.isConnected){o(new Error("The current element is not connected to the DOM."));return}const l=document.createElement("canvas");let{width:a,height:d}=this,r=1;if(qt(t)&&(ge(t.width)||ge(t.height))&&({width:a,height:d}=Mt({aspectRatio:a/d,width:t.width,height:t.height}),r=a/this.width),l.width=a,l.height=d,!this.$canvas){s(l);return}const h=this.$canvas.querySelector(this.$getTagNameOf(Jt));if(!h){s(l);return}h.$ready().then(c=>{const p=l.getContext("2d");if(p){const[$,w,y,k,S,T]=h.$getTransform(),E=-this.x,M=-this.y,O=(E*k-y*M)/($*k-y*w),A=(M*$-w*E)/($*k-y*w);let K=$*O+y*A+S,C=w*O+k*A+T,U=c.naturalWidth,_=c.naturalHeight;r!==1&&(K*=r,C*=r,U*=r,_*=r);const R=U/2,B=_/2;p.fillStyle="transparent",p.fillRect(0,0,a,d),qt(t)&&Tn(t.beforeDraw)&&t.beforeDraw.call(this,p,l),p.save(),p.translate(R,B),p.transform($,w,y,k,K,C),p.translate(-R,-B),p.drawImage(c,0,0,U,_),p.restore()}s(l)}).catch(o)})}}En.$name=Ne;En.$version="2.0.0";var qm=":host{display:flex;flex-direction:column;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}:host([bordered]){border:1px dashed var(--theme-color)}:host([covered]){bottom:0;left:0;position:absolute;right:0;top:0}:host>span{display:flex;flex:1}:host>span+span{border-top:1px dashed var(--theme-color)}:host>span>span{flex:1}:host>span>span+span{border-left:1px dashed var(--theme-color)}";class An extends Ue{constructor(){super(...arguments),this.$style=qm,this.bordered=!1,this.columns=3,this.covered=!1,this.rows=3,this.slottable=!1,this.themeColor="rgba(238, 238, 238, 0.5)"}static get observedAttributes(){return super.observedAttributes.concat(["bordered","columns","covered","rows"])}$propertyChangedCallback(t,s,o){Object.is(o,s)||(super.$propertyChangedCallback(t,s,o),(t==="rows"||t==="columns")&&this.$nextTick(()=>{this.$render()}))}connectedCallback(){super.connectedCallback(),this.$render()}$render(){const t=this.$getShadowRoot(),s=document.createDocumentFragment();for(let o=0;o<this.rows;o+=1){const l=document.createElement("span");l.setAttribute("role","row");for(let a=0;a<this.columns;a+=1){const d=document.createElement("span");d.setAttribute("role","gridcell"),l.appendChild(d)}s.appendChild(l)}t&&(t.innerHTML="",t.appendChild(s))}}An.$name=gm;An.$version="2.0.0";var zm=':host{display:inline-block;height:1em;position:relative;touch-action:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle;width:1em}:host:after,:host:before{background-color:var(--theme-color);content:"";display:block;position:absolute}:host:before{height:1px;left:0;top:50%;transform:translateY(-50%);width:100%}:host:after{height:100%;left:50%;top:0;transform:translateX(-50%);width:1px}:host([centered]){left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}';class _n extends Ue{constructor(){super(...arguments),this.$style=zm,this.centered=!1,this.slottable=!1,this.themeColor="rgba(238, 238, 238, 0.5)"}static get observedAttributes(){return super.observedAttributes.concat(["centered"])}}_n.$name=fm;_n.$version="2.0.0";var Hm=":host{display:block;height:100%;overflow:hidden;position:relative;width:100%}";const da=new WeakMap,ua=new WeakMap,ca=new WeakMap,ha=new WeakMap,Wm="both",Km="horizontal",pa="vertical",Gm="none";class Ln extends Ue{constructor(){super(...arguments),this.$onSelectionChange=null,this.$onSourceImageLoad=null,this.$onSourceImageTransform=null,this.$scale=1,this.$style=Hm,this.resize=pa,this.selection="",this.slottable=!1}set $image(t){ua.set(this,t)}get $image(){return ua.get(this)}set $sourceImage(t){ha.set(this,t)}get $sourceImage(){return ha.get(this)}set $canvas(t){da.set(this,t)}get $canvas(){return da.get(this)}set $selection(t){ca.set(this,t)}get $selection(){return ca.get(this)}static get observedAttributes(){return super.observedAttributes.concat(["resize","selection"])}connectedCallback(){super.connectedCallback();let t=null;if(this.selection?t=this.ownerDocument.querySelector(this.selection):t=this.closest(this.$getTagNameOf(Ne)),Ha(t)){this.$selection=t,this.$onSelectionChange=this.$handleSelectionChange.bind(this),le(t,je,this.$onSelectionChange);const s=t.closest(this.$getTagNameOf(Ct));if(s){this.$canvas=s;const o=s.querySelector(this.$getTagNameOf(Jt));o&&(this.$sourceImage=o,this.$image=o.cloneNode(!0),this.$getShadowRoot().appendChild(this.$image),this.$onSourceImageLoad=this.$handleSourceImageLoad.bind(this),this.$onSourceImageTransform=this.$handleSourceImageTransform.bind(this),le(o.$image,ot,this.$onSourceImageLoad),le(o,rn,this.$onSourceImageTransform))}this.$render()}}disconnectedCallback(){const{$selection:t,$sourceImage:s}=this;t&&this.$onSelectionChange&&(oe(t,je,this.$onSelectionChange),this.$onSelectionChange=null),s&&this.$onSourceImageLoad&&(oe(s.$image,ot,this.$onSourceImageLoad),this.$onSourceImageLoad=null),s&&this.$onSourceImageTransform&&(oe(s,rn,this.$onSourceImageTransform),this.$onSourceImageTransform=null),super.disconnectedCallback()}$handleSelectionChange(t){this.$render(t.detail)}$handleSourceImageLoad(){const{$image:t,$sourceImage:s}=this,o=t.getAttribute("src"),l=s.getAttribute("src");l&&l!==o&&(t.setAttribute("src",l),t.$ready(()=>{setTimeout(()=>{this.$render()},50)}))}$handleSourceImageTransform(t){this.$render(void 0,t.detail.matrix)}$render(t,s){const{$canvas:o,$selection:l}=this;!t&&!l.hidden&&(t=l),(!t||t.x===0&&t.y===0&&t.width===0&&t.height===0)&&(t={x:0,y:0,width:o.offsetWidth,height:o.offsetHeight});const{x:a,y:d,width:r,height:h}=t,c={},{clientWidth:p,clientHeight:$}=this;let w=p,y=$,k=NaN;switch(this.resize){case Wm:k=1,w=r,y=h,c.width=r,c.height=h;break;case Km:k=h>0?$/h:0,w=r*k,c.width=w;break;case pa:k=r>0?p/r:0,y=h*k,c.height=y;break;case Gm:default:p>0?k=r>0?p/r:0:$>0&&(k=h>0?$/h:0)}this.$scale=k,this.$setStyles(c),this.$sourceImage&&this.$transformImageByOffset(s??this.$sourceImage.$getTransform(),-a,-d)}$transformImageByOffset(t,s,o){const{$image:l,$scale:a,$sourceImage:d}=this;if(d&&l&&a>=0){const[r,h,c,p,$,w]=t,y=(s*p-c*o)/(r*p-c*h),k=(o*r-h*s)/(r*p-c*h),S=r*y+c*k+$,T=h*y+p*k+w;l.$ready(E=>{this.$setStyles.call(l,{width:E.naturalWidth*a,height:E.naturalHeight*a})}),l.$setTransform(r,h,c,p,S*a,T*a)}}}Ln.$name=$m;Ln.$version="2.0.0";/*! Cropper.js v2.0.0 | (c) 2015-present Chen Fengyuan | MIT */Vn.$define();_n.$define();An.$define();In.$define();Sn.$define();En.$define();Pn.$define();Ln.$define();ue.add(vt);const Ym={props:{trigger:{type:[String,window.Element],required:!0},submitHandler:{type:Function,required:!0},mimes:{type:String,default:"image/png, image/gif, image/jpeg, image/bmp, image/x-icon"},saveButtonLabel:{type:String},saveWithoutCroppingButtonlabel:{type:String},cancelButtonLabel:{type:String}},data(){return{dataUrl:void 0,filename:void 0,submitting:!1}},computed:{saveText(){return this.saveButtonLabel||this.$t("image_cropper.save")},saveWithoutCroppingText(){return this.saveWithoutCroppingButtonlabel||this.$t("image_cropper.save_without_cropping")},cancelText(){return this.cancelButtonLabel||this.$t("image_cropper.cancel")}},methods:{destroy(){this.$refs.input.value="",this.dataUrl=void 0,this.$emit("close")},submit(e=!0){this.submitting=!0;let t;e?t=this.$refs.cropperSelection.$toCanvas():t=Promise.resolve(),t.then(s=>{this.submitHandler(s,this.file).then(()=>this.destroy()).finally(()=>{this.submitting=!1})})},pickImage(){this.$refs.input.click()},getTriggerDOM(){return typeof this.trigger=="object"?this.trigger:document.querySelector(this.trigger)},readFile(){const e=this.$refs.input;if(e.files!=null&&e.files[0]!=null){this.file=e.files[0];const t=new window.FileReader;t.onload=s=>{this.dataUrl=s.target.result,this.$emit("open")},t.readAsDataURL(this.file),this.$emit("changed",this.file,t)}},inSelection(e,t){return e.x>=t.x&&e.y>=t.y&&e.x+e.width<=t.x+t.width&&e.y+e.height<=t.y+t.height},onCropperSelectionChange(e){const s=this.$refs.cropperCanvas.getBoundingClientRect(),o=e.detail,l={x:0,y:0,width:s.width,height:s.height};this.inSelection(o,l)||e.preventDefault()}},mounted(){const e=this.getTriggerDOM();e?e.addEventListener("click",this.pickImage):this.$emit("error","No image make trigger found.","user"),this.$refs.input.addEventListener("change",this.readFile)},beforeUnmount:function(){const e=this.getTriggerDOM();e&&e.removeEventListener("click",this.pickImage),this.$refs.input.removeEventListener("change",this.readFile)}},Xm={class:"image-cropper"},Jm={key:0},Zm={ref:"cropperCanvas",background:"",class:"image-cropper-canvas",height:"25em"},Qm=["src"],xm={class:"image-cropper-buttons-wrapper"},ef=["disabled","textContent"],tf=["disabled","textContent"],sf=["disabled","textContent"],nf=["accept"];function of(e,t,s,o,l,a){const d=P("FAIcon");return m(),b("div",Xm,[e.dataUrl?(m(),b("div",Jm,[n("cropper-canvas",Zm,[n("cropper-image",{ref:"cropperImage",src:e.dataUrl,alt:"Picture",class:"image-cropper-image",translatable:"",scalable:""},null,8,Qm),t[5]||(t[5]=n("cropper-shade",{hidden:""},null,-1)),t[6]||(t[6]=n("cropper-handle",{action:"select",plain:""},null,-1)),n("cropper-selection",{ref:"cropperSelection","initial-coverage":"1","aspect-ratio":"1",movable:"",resizable:"",onChange:t[0]||(t[0]=(...r)=>e.onCropperSelectionChange&&e.onCropperSelectionChange(...r))},t[4]||(t[4]=[n("cropper-grid",{role:"grid",covered:""},null,-1),n("cropper-crosshair",{centered:""},null,-1),n("cropper-handle",{action:"move","theme-color":"rgba(255, 255, 255, 0.35)"},null,-1),Pi('<cropper-handle action="n-resize"></cropper-handle><cropper-handle action="e-resize"></cropper-handle><cropper-handle action="s-resize"></cropper-handle><cropper-handle action="w-resize"></cropper-handle><cropper-handle action="ne-resize"></cropper-handle><cropper-handle action="nw-resize"></cropper-handle><cropper-handle action="se-resize"></cropper-handle><cropper-handle action="sw-resize"></cropper-handle>',8)]),544)],512),n("div",xm,[n("button",{class:"button-default btn",type:"button",disabled:e.submitting,onClick:t[1]||(t[1]=r=>e.submit()),textContent:i(e.saveText)},null,8,ef),n("button",{class:"button-default btn",type:"button",disabled:e.submitting,onClick:t[2]||(t[2]=(...r)=>e.destroy&&e.destroy(...r)),textContent:i(e.cancelText)},null,8,tf),n("button",{class:"button-default btn",type:"button",disabled:e.submitting,onClick:t[3]||(t[3]=r=>e.submit(!1)),textContent:i(e.saveWithoutCroppingText)},null,8,sf),e.submitting?(m(),H(d,{key:0,spin:"",icon:"circle-notch"})):V("",!0)])])):V("",!0),n("input",{ref:"input",type:"file",class:"input image-cropper-img-input",accept:e.mimes},null,8,nf)])}const lf=X(Ym,[["render",of]]);ue.add(Ht,Ta,vt);const af={data(){return{newName:this.$store.state.users.currentUser.name_unescaped,newBio:jp(this.$store.state.users.currentUser.description),newLocked:this.$store.state.users.currentUser.locked,newBirthday:this.$store.state.users.currentUser.birthday,showBirthday:this.$store.state.users.currentUser.show_birthday,newFields:this.$store.state.users.currentUser.fields.map(e=>({name:e.name,value:e.value})),showRole:this.$store.state.users.currentUser.show_role,role:this.$store.state.users.currentUser.role,bot:this.$store.state.users.currentUser.bot,actorType:this.$store.state.users.currentUser.actor_type,pickAvatarBtnVisible:!0,bannerUploading:!1,backgroundUploading:!1,banner:null,bannerPreview:null,background:null,backgroundPreview:null,emailLanguage:this.$store.state.users.currentUser.language||[""]}},components:{ScopeSelector:Ca,ImageCropper:lf,EmojiInput:Ii,Autosuggest:_a,ProgressButton:Wt,Checkbox:pe,BooleanSetting:wt,InterfaceLanguageSwitcher:ka,Select:qe},computed:{user(){return this.$store.state.users.currentUser},...yt(),emojiUserSuggestor(){return Zt({emoji:[...this.$store.getters.standardEmojiList,...this.$store.state.instance.customEmoji],store:this.$store})},emojiSuggestor(){return Zt({emoji:[...this.$store.getters.standardEmojiList,...this.$store.state.instance.customEmoji]})},userSuggestor(){return Zt({store:this.$store})},fieldsLimits(){return this.$store.state.instance.fieldsLimits},maxFields(){return this.fieldsLimits?this.fieldsLimits.maxFields:0},defaultAvatar(){return this.$store.state.instance.server+this.$store.state.instance.defaultAvatar},defaultBanner(){return this.$store.state.instance.server+this.$store.state.instance.defaultBanner},isDefaultAvatar(){const e=this.$store.state.instance.defaultAvatar;return!this.$store.state.users.currentUser.profile_image_url||this.$store.state.users.currentUser.profile_image_url.includes(e)},isDefaultBanner(){const e=this.$store.state.instance.defaultBanner;return!this.$store.state.users.currentUser.cover_photo||this.$store.state.users.currentUser.cover_photo.includes(e)},isDefaultBackground(){return!this.$store.state.users.currentUser.background_image},avatarImgSrc(){const e=this.$store.state.users.currentUser.profile_image_url_original;return e||this.defaultAvatar},bannerImgSrc(){const e=this.$store.state.users.currentUser.cover_photo;return e||this.defaultBanner},groupActorAvailable(){return this.$store.state.instance.groupActorAvailable},availableActorTypes(){return this.groupActorAvailable?["Person","Service","Group"]:["Person","Service"]}},methods:{updateProfile(){const e={note:this.newBio,locked:this.newLocked,display_name:this.newName,fields_attributes:this.newFields.filter(t=>t!=null),actor_type:this.actorType,show_role:this.showRole,birthday:this.newBirthday||"",show_birthday:this.showBirthday};this.emailLanguage&&(e.language=va.internalToBackendLocaleMulti(this.emailLanguage)),this.$store.state.api.backendInteractor.updateProfile({params:e}).then(t=>{this.newFields.splice(t.fields.length),mm(this.newFields,t.fields),this.$store.commit("addNewUsers",[t]),this.$store.commit("setCurrentUser",t)})},changeVis(e){this.newDefaultScope=e},addField(){return this.newFields.length<this.maxFields?(this.newFields.push({name:"",value:""}),!0):!1},deleteField(e){this.newFields.splice(e,1)},uploadFile(e,t){const s=t.target.files[0];if(!s)return;if(s.size>this.$store.state.instance[e+"limit"]){const l=So.fileSizeFormat(s.size),a=So.fileSizeFormat(this.$store.state.instance[e+"limit"]);Q().pushGlobalNotice({messageKey:"upload.error.message",messageArgs:[this.$t("upload.error.file_too_big",{filesize:l.num,filesizeunit:l.unit,allowedsize:a.num,allowedsizeunit:a.unit})],level:"error"});return}const o=new FileReader;o.onload=({target:l})=>{const a=l.result;this[e+"Preview"]=a,this[e]=s},o.readAsDataURL(s)},resetAvatar(){window.confirm(this.$t("settings.reset_avatar_confirm"))&&this.submitAvatar(void 0,"")},resetBanner(){window.confirm(this.$t("settings.reset_banner_confirm"))&&this.submitBanner("")},resetBackground(){window.confirm(this.$t("settings.reset_background_confirm"))&&this.submitBackground("")},submitAvatar(e,t){const s=this;return new Promise((o,l)=>{function a(d,r){s.$store.state.api.backendInteractor.updateProfileImages({avatar:d,avatarName:r}).then(h=>{s.$store.commit("addNewUsers",[h]),s.$store.commit("setCurrentUser",h),o()}).catch(h=>{s.displayUploadError(h),l(h)})}e?e.toBlob(d=>a(d,t.name),t.type):a(t,t.name)})},submitBanner(e){!this.bannerPreview&&e!==""||(this.bannerUploading=!0,this.$store.state.api.backendInteractor.updateProfileImages({banner:e}).then(t=>{this.$store.commit("addNewUsers",[t]),this.$store.commit("setCurrentUser",t),this.bannerPreview=null}).catch(this.displayUploadError).finally(()=>{this.bannerUploading=!1}))},submitBackground(e){!this.backgroundPreview&&e!==""||(this.backgroundUploading=!0,this.$store.state.api.backendInteractor.updateProfileImages({background:e}).then(t=>{this.$store.commit("addNewUsers",[t]),this.$store.commit("setCurrentUser",t),this.backgroundPreview=null}).catch(this.displayUploadError).finally(()=>{this.backgroundUploading=!1}))},displayUploadError(e){Q().pushGlobalNotice({messageKey:"upload.error.message",messageArgs:[e.message],level:"error"})},propsToNative(e){return Ei(e)}}},rf={class:"profile-tab"},df={class:"setting-item"},uf={key:0},cf={key:1},hf=["onUpdate:modelValue","placeholder"],pf=["onUpdate:modelValue","placeholder"],mf=["onClick"],ff=["value"],gf={key:2},bf=["disabled"],vf={class:"setting-item"},$f={class:"visibility-notice"},yf={class:"current-avatar-container"},wf=["src"],kf=["title"],Cf={class:"setting-item"},Tf={class:"banner-background-preview"},Vf=["src"],Sf=["title"],Pf=["src"],If={class:"setting-item"},Ef={class:"banner-background-preview"},Af=["src"],_f=["title"],Lf=["src"],Of={class:"setting-item"},Uf={class:"setting-list"},Rf={class:"setting-list suboptions"},Bf={class:"setting-list suboptions"};function Mf(e,t,s,o,l,a){const d=P("EmojiInput"),r=P("Checkbox"),h=P("FAIcon"),c=P("Select"),p=P("interface-language-switcher"),$=P("image-cropper"),w=P("BooleanSetting");return m(),b("div",rf,[n("div",df,[n("h2",null,i(e.$t("settings.name_bio")),1),n("p",null,i(e.$t("settings.name")),1),u(d,{modelValue:e.newName,"onUpdate:modelValue":t[1]||(t[1]=y=>e.newName=y),"enable-emoji-picker":"",suggest:e.emojiSuggestor},{default:f(y=>[x(n("input",Et({id:"username","onUpdate:modelValue":t[0]||(t[0]=k=>e.newName=k),class:"input name-changer"},e.propsToNative(y)),null,16),[[Qt,e.newName]])]),_:1},8,["modelValue","suggest"]),n("p",null,i(e.$t("settings.bio")),1),u(d,{modelValue:e.newBio,"onUpdate:modelValue":t[3]||(t[3]=y=>e.newBio=y),"enable-emoji-picker":"",suggest:e.emojiUserSuggestor},{default:f(y=>[x(n("textarea",Et({"onUpdate:modelValue":t[2]||(t[2]=k=>e.newBio=k),class:"input bio resize-height"},e.propsToNative(y)),null,16),[[ie,e.newBio]])]),_:1},8,["modelValue","suggest"]),e.role==="admin"||e.role==="moderator"?(m(),b("p",uf,[u(r,{modelValue:e.showRole,"onUpdate:modelValue":t[4]||(t[4]=y=>e.showRole=y)},{default:f(()=>[e.role==="admin"?(m(),b(Y,{key:0},[v(i(e.$t("settings.show_admin_badge")),1)],64)):V("",!0),e.role==="moderator"?(m(),b(Y,{key:1},[v(i(e.$t("settings.show_moderator_badge")),1)],64)):V("",!0)]),_:1},8,["modelValue"])])):V("",!0),n("div",null,[n("p",null,i(e.$t("settings.birthday.label")),1),x(n("input",{id:"birthday","onUpdate:modelValue":t[5]||(t[5]=y=>e.newBirthday=y),type:"date",class:"input birthday-input"},null,512),[[ie,e.newBirthday]]),u(r,{modelValue:e.showBirthday,"onUpdate:modelValue":t[6]||(t[6]=y=>e.showBirthday=y)},{default:f(()=>[v(i(e.$t("settings.birthday.show_birthday")),1)]),_:1},8,["modelValue"])]),e.maxFields>0?(m(),b("div",cf,[n("p",null,i(e.$t("settings.profile_fields.label")),1),(m(!0),b(Y,null,se(e.newFields,(y,k)=>(m(),b("div",{key:k,class:"profile-fields"},[u(d,{modelValue:e.newFields[k].name,"onUpdate:modelValue":S=>e.newFields[k].name=S,"enable-emoji-picker":"","hide-emoji-button":"",suggest:e.userSuggestor},{default:f(S=>[x(n("input",Et({"onUpdate:modelValue":T=>e.newFields[k].name=T,placeholder:e.$t("settings.profile_fields.name"),ref_for:!0},e.propsToNative(S),{class:"input"}),null,16,hf),[[Qt,e.newFields[k].name]])]),_:2},1032,["modelValue","onUpdate:modelValue","suggest"]),u(d,{modelValue:e.newFields[k].value,"onUpdate:modelValue":S=>e.newFields[k].value=S,"enable-emoji-picker":"","hide-emoji-button":"",suggest:e.userSuggestor},{default:f(S=>[x(n("input",Et({"onUpdate:modelValue":T=>e.newFields[k].value=T,placeholder:e.$t("settings.profile_fields.value"),ref_for:!0},e.propsToNative(S),{class:"input"}),null,16,pf),[[Qt,e.newFields[k].value]])]),_:2},1032,["modelValue","onUpdate:modelValue","suggest"]),n("button",{class:"delete-field button-unstyled -hover-highlight",onClick:S=>e.deleteField(k)},[e.newFields.length>1?(m(),H(h,{key:0,icon:"times"})):V("",!0)],8,mf)]))),128)),e.newFields.length<e.maxFields?(m(),b("button",{key:0,class:"add-field faint button-unstyled -hover-highlight",onClick:t[7]||(t[7]=(...y)=>e.addField&&e.addField(...y))},[u(h,{icon:"plus"}),v(" "+i(e.$t("settings.profile_fields.add_field")),1)])):V("",!0)])):V("",!0),n("p",null,[n("label",null,[v(i(e.$t("settings.actor_type"))+" ",1),u(c,{modelValue:e.actorType,"onUpdate:modelValue":t[8]||(t[8]=y=>e.actorType=y)},{default:f(()=>[(m(!0),b(Y,null,se(e.availableActorTypes,y=>(m(),b("option",{key:y,value:y},i(e.$t("settings.actor_type_"+y)),9,ff))),128))]),_:1},8,["modelValue"])])]),e.groupActorAvailable?(m(),b("div",gf,[n("small",null,i(e.$t("settings.actor_type_description")),1)])):V("",!0),n("p",null,[u(p,{"prompt-text":e.$t("settings.email_language"),language:e.emailLanguage,"set-language":y=>e.emailLanguage=y},null,8,["prompt-text","language","set-language"])]),n("button",{disabled:e.newName&&e.newName.length===0,class:"btn button-default",onClick:t[9]||(t[9]=(...y)=>e.updateProfile&&e.updateProfile(...y))},i(e.$t("settings.save")),9,bf)]),n("div",vf,[n("h2",null,i(e.$t("settings.avatar")),1),n("p",$f,i(e.$t("settings.avatar_size_instruction")),1),n("div",yf,[n("img",{src:e.user.profile_image_url_original,class:"current-avatar"},null,8,wf),!e.isDefaultAvatar&&e.pickAvatarBtnVisible?(m(),b("button",{key:0,title:e.$t("settings.reset_avatar"),class:"button-unstyled reset-button",onClick:t[10]||(t[10]=(...y)=>e.resetAvatar&&e.resetAvatar(...y))},[u(h,{icon:"times",type:"button"})],8,kf)):V("",!0)]),n("p",null,i(e.$t("settings.set_new_avatar")),1),x(n("button",{id:"pick-avatar",class:"button-default btn",type:"button"},i(e.$t("settings.upload_a_photo")),513),[[st,e.pickAvatarBtnVisible]]),u($,{trigger:"#pick-avatar","submit-handler":e.submitAvatar,onOpen:t[11]||(t[11]=y=>e.pickAvatarBtnVisible=!1),onClose:t[12]||(t[12]=y=>e.pickAvatarBtnVisible=!0)},null,8,["submit-handler"])]),n("div",Cf,[n("h2",null,i(e.$t("settings.profile_banner")),1),n("div",Tf,[n("img",{src:e.user.cover_photo},null,8,Vf),e.isDefaultBanner?V("",!0):(m(),b("button",{key:0,class:"button-unstyled reset-button",title:e.$t("settings.reset_profile_banner"),onClick:t[13]||(t[13]=(...y)=>e.resetBanner&&e.resetBanner(...y))},[u(h,{icon:"times",type:"button"})],8,Sf))]),n("p",null,i(e.$t("settings.set_new_profile_banner")),1),e.bannerPreview?(m(),b("img",{key:0,class:"banner-background-preview",src:e.bannerPreview},null,8,Pf)):V("",!0),n("div",null,[n("input",{type:"file",class:"input",onChange:t[14]||(t[14]=y=>e.uploadFile("banner",y))},null,32)]),e.bannerUploading?(m(),H(h,{key:1,class:"uploading",spin:"",icon:"circle-notch"})):e.bannerPreview?(m(),b("button",{key:2,class:"btn button-default",onClick:t[15]||(t[15]=y=>e.submitBanner(e.banner))},i(e.$t("settings.save")),1)):V("",!0)]),n("div",If,[n("h2",null,i(e.$t("settings.profile_background")),1),n("div",Ef,[n("img",{src:e.user.background_image},null,8,Af),e.isDefaultBackground?V("",!0):(m(),b("button",{key:0,class:"button-unstyled reset-button",title:e.$t("settings.reset_profile_background"),onClick:t[16]||(t[16]=(...y)=>e.resetBackground&&e.resetBackground(...y))},[u(h,{icon:"times",type:"button"})],8,_f))]),n("p",null,i(e.$t("settings.set_new_profile_background")),1),e.backgroundPreview?(m(),b("img",{key:0,class:"banner-background-preview",src:e.backgroundPreview},null,8,Lf)):V("",!0),n("div",null,[n("input",{type:"file",class:"input",onChange:t[17]||(t[17]=y=>e.uploadFile("background",y))},null,32)]),e.backgroundUploading?(m(),H(h,{key:1,class:"uploading",spin:"",icon:"circle-notch"})):e.backgroundPreview?(m(),b("button",{key:2,class:"btn button-default",onClick:t[18]||(t[18]=y=>e.submitBackground(e.background))},i(e.$t("settings.save")),1)):V("",!0)]),n("div",Of,[n("h2",null,i(e.$t("settings.account_privacy")),1),n("ul",Uf,[n("li",null,[u(w,{source:"profile",path:"locked"},{default:f(()=>[v(i(e.$t("settings.lock_account_description")),1)]),_:1})]),n("li",null,[u(w,{source:"profile",path:"discoverable"},{default:f(()=>[v(i(e.$t("settings.discoverable")),1)]),_:1})]),n("li",null,[u(w,{source:"profile",path:"allowFollowingMove"},{default:f(()=>[v(i(e.$t("settings.allow_following_move")),1)]),_:1})]),n("li",null,[u(w,{source:"profile",path:"hideFavorites"},{default:f(()=>[v(i(e.$t("settings.hide_favorites_description")),1)]),_:1})]),n("li",null,[u(w,{source:"profile",path:"hideFollowers"},{default:f(()=>[v(i(e.$t("settings.hide_followers_description")),1)]),_:1}),n("ul",Rf,[n("li",null,[u(w,{source:"profile",path:"hideFollowersCount","parent-path":"hideFollowers"},{default:f(()=>[v(i(e.$t("settings.hide_followers_count_description")),1)]),_:1})])])]),n("li",null,[u(w,{source:"profile",path:"hideFollows"},{default:f(()=>[v(i(e.$t("settings.hide_follows_description")),1)]),_:1}),n("ul",Bf,[n("li",null,[u(w,{source:"profile",path:"hideFollowsCount","parent-path":"hideFollows"},{default:f(()=>[v(i(e.$t("settings.hide_follows_count_description")),1)]),_:1})])])])])])])}const Ff=X(af,[["render",Mf]]),Df={components:{NumberSetting:sd}};function Nf(e,t,s,o,l,a){const d=P("NumberSetting");return m(),H(d,Ai(_i(e.$attrs)),{default:f(()=>[Le(e.$slots,"default")]),_:3},16)}const Ga=X(Df,[["render",Nf]]);ue.add(Va);const jf={data(){return{subjectLineOptions:["email","noop","masto"].map(e=>({key:e,value:e,label:this.$t(`settings.subject_line_${e==="masto"?"mastodon":e}`)})),conversationDisplayOptions:["tree","linear"].map(e=>({key:e,value:e,label:this.$t(`settings.conversation_display_${e}`)})),absoluteTime12hOptions:["24h","12h"].map(e=>({key:e,value:e,label:this.$t(`settings.absolute_time_format_12h_${e}`)})),conversationOtherRepliesButtonOptions:["below","inside"].map(e=>({key:e,value:e,label:this.$t(`settings.conversation_other_replies_button_${e}`)})),mentionLinkDisplayOptions:["short","full_for_remote","full"].map(e=>({key:e,value:e,label:this.$t(`settings.mention_link_display_${e}`)})),userPopoverAvatarActionOptions:["close","zoom","open"].map(e=>({key:e,value:e,label:this.$t(`settings.user_popover_avatar_action_${e}`)})),unsavedPostActionOptions:["save","discard","confirm"].map(e=>({key:e,value:e,label:this.$t(`settings.unsaved_post_action_${e}`)})),loopSilentAvailable:Object.getOwnPropertyDescriptor(HTMLVideoElement.prototype,"mozHasAudio")||Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"webkitAudioDecodedByteCount")||Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"audioTracks")}},components:{BooleanSetting:wt,ChoiceSetting:vn,IntegerSetting:bn,FloatSetting:Ga,UnitSetting:yn,InterfaceLanguageSwitcher:ka,ScopeSelector:Ca,ProfileSettingIndicator:Aa},computed:{postFormats(){return this.$store.state.instance.postFormats||[]},postContentOptions(){return this.postFormats.map(e=>({key:e,value:e,label:this.$t(`post_status.content_type["${e}"]`)}))},language:{get:function(){return this.$store.getters.mergedConfig.interfaceLanguage},set:function(e){this.$store.dispatch("setOption",{name:"interfaceLanguage",value:e})}},instanceShoutboxPresent(){return this.$store.state.instance.shoutAvailable},instanceSpecificPanelPresent(){return this.$store.state.instance.showInstanceSpecificPanel},...yt()},methods:{changeDefaultScope(e){this.$store.dispatch("setProfileOption",{name:"defaultScope",value:e})}}},qf=["label"],zf={class:"setting-item"},Hf={class:"setting-list"},Wf={key:0},Kf={class:"setting-list suboptions"},Gf={key:1},Yf={class:"select-multiple"},Xf={class:"label"},Jf={class:"option-list"},Zf={class:"setting-item"},Qf={class:"setting-list"},xf={key:0,class:"setting-list suboptions"},eg={key:1,class:"setting-list suboptions"},tg={class:"setting-list suboptions"},sg={class:"setting-list suboptions"},ng={class:"setting-list suboptions"},og={key:0,class:"unavailable"},lg={key:2},ag={key:3},ig={key:4},rg={key:0,class:"setting-item"},dg={class:"setting-list"},ug={for:"default-vis"},cg={key:0},hg={key:1};function pg(e,t,s,o,l,a){const d=P("interface-language-switcher"),r=P("BooleanSetting"),h=P("ChoiceSetting"),c=P("IntegerSetting"),p=P("UnitSetting"),$=P("FAIcon"),w=P("ProfileSettingIndicator"),y=P("ScopeSelector");return m(),b("div",{label:e.$t("settings.general")},[n("div",zf,[n("h2",null,i(e.$t("settings.interface")),1),n("ul",Hf,[n("li",null,[u(d,{"prompt-text":e.$t("settings.interfaceLanguage"),language:e.language,"set-language":k=>e.language=k},null,8,["prompt-text","language","set-language"])]),e.instanceSpecificPanelPresent?(m(),b("li",Wf,[u(r,{path:"hideISP"},{default:f(()=>[v(i(e.$t("settings.hide_isp")),1)]),_:1})])):V("",!0),n("li",null,[u(r,{path:"stopGifs"},{default:f(()=>[v(i(e.$t("settings.stop_gifs")),1)]),_:1})]),n("li",null,[u(r,{path:"streaming"},{default:f(()=>[v(i(e.$t("settings.streaming")),1)]),_:1}),n("ul",Kf,[n("li",null,[u(r,{path:"pauseOnUnfocused","parent-path":"streaming"},{default:f(()=>[v(i(e.$t("settings.pause_on_unfocused")),1)]),_:1})])])]),n("li",null,[u(r,{path:"useStreamingApi",expert:"1"},{default:f(()=>[v(i(e.$t("settings.useStreamingApi")),1)]),_:1})]),n("li",null,[u(r,{path:"virtualScrolling",expert:"1"},{default:f(()=>[v(i(e.$t("settings.virtual_scrolling")),1)]),_:1})]),n("li",null,[u(h,{id:"userPopoverAvatarAction",path:"userPopoverAvatarAction",options:e.userPopoverAvatarActionOptions,expert:"1"},{default:f(()=>[v(i(e.$t("settings.user_popover_avatar_action")),1)]),_:1},8,["options"])]),n("li",null,[u(r,{path:"userPopoverOverlay",expert:"1"},{default:f(()=>[v(i(e.$t("settings.user_popover_avatar_overlay")),1)]),_:1})]),n("li",null,[u(r,{path:"alwaysShowNewPostButton",expert:"1"},{default:f(()=>[v(i(e.$t("settings.always_show_post_button")),1)]),_:1})]),n("li",null,[u(r,{path:"autohideFloatingPostButton",expert:"1"},{default:f(()=>[v(i(e.$t("settings.autohide_floating_post_button")),1)]),_:1})]),e.instanceShoutboxPresent?(m(),b("li",Gf,[u(r,{path:"hideShoutbox",expert:"1"},{default:f(()=>[v(i(e.$t("settings.hide_shoutbox")),1)]),_:1})])):V("",!0),n("li",Yf,[n("span",Xf,i(e.$t("settings.confirm_dialogs")),1),n("ul",Jf,[n("li",null,[u(r,{path:"modalOnRepeat"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_repeat")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnUnfollow"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_unfollow")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnBlock"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_block")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnMute"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_mute")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnMuteConversation"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_mute_conversation")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnMuteDomain"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_mute_domain")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnDelete"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_delete")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnLogout"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_logout")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnApproveFollow"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_approve_follow")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnDenyFollow"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_deny_follow")),1)]),_:1})]),n("li",null,[u(r,{path:"modalOnRemoveUserFromFollowers"},{default:f(()=>[v(i(e.$t("settings.confirm_dialogs_remove_follower")),1)]),_:1})])])])])]),n("div",Zf,[n("h2",null,i(e.$t("settings.post_look_feel")),1),n("ul",Qf,[n("li",null,[u(h,{id:"conversationDisplay",path:"conversationDisplay",options:e.conversationDisplayOptions},{default:f(()=>[v(i(e.$t("settings.conversation_display")),1)]),_:1},8,["options"])]),e.mergedConfig.conversationDisplay!=="linear"?(m(),b("ul",xf,[n("li",null,[u(r,{path:"conversationTreeAdvanced"},{default:f(()=>[v(i(e.$t("settings.tree_advanced")),1)]),_:1})]),n("li",null,[u(r,{path:"conversationTreeFadeAncestors",expert:1},{default:f(()=>[v(i(e.$t("settings.tree_fade_ancestors")),1)]),_:1})]),n("li",null,[u(c,{path:"maxDepthInThread",min:3,expert:1},{default:f(()=>[v(i(e.$t("settings.max_depth_in_thread")),1)]),_:1})]),n("li",null,[u(h,{id:"conversationOtherRepliesButton",path:"conversationOtherRepliesButton",options:e.conversationOtherRepliesButtonOptions,expert:1},{default:f(()=>[v(i(e.$t("settings.conversation_other_replies_button")),1)]),_:1},8,["options"])])])):V("",!0),n("li",null,[u(r,{path:"collapseMessageWithSubject"},{default:f(()=>[v(i(e.$t("settings.collapse_subject")),1)]),_:1})]),n("li",null,[u(r,{path:"emojiReactionsOnTimeline",expert:"1"},{default:f(()=>[v(i(e.$t("settings.emoji_reactions_on_timeline")),1)]),_:1})]),n("li",null,[e.user?(m(),H(r,{key:0,source:"profile",path:"stripRichContent",expert:"1"},{default:f(()=>[v(i(e.$t("settings.no_rich_text_description")),1)]),_:1})):V("",!0)]),n("li",null,[u(r,{path:"useAbsoluteTimeFormat",expert:"1"},{default:f(()=>[v(i(e.$t("settings.absolute_time_format")),1)]),_:1})]),e.mergedConfig.useAbsoluteTimeFormat?(m(),b("ul",eg,[n("li",null,[u(p,{path:"absoluteTimeFormatMinAge","unit-set":"time",units:["s","m","h","d"],min:0},{default:f(()=>[v(i(e.$t("settings.absolute_time_format_min_age")),1)]),_:1})]),n("li",null,[u(h,{id:"absoluteTime12h",path:"absoluteTime12h",options:e.absoluteTime12hOptions,expert:1},{default:f(()=>[v(i(e.$t("settings.absolute_time_format_12h")),1)]),_:1},8,["options"])])])):V("",!0),n("h3",null,i(e.$t("settings.attachments")),1),n("li",null,[u(r,{path:"imageCompression",expert:"1"},{default:f(()=>[v(i(e.$t("settings.image_compression")),1)]),_:1})]),n("ul",tg,[n("li",null,[u(r,{path:"alwaysUseJpeg",expert:"1","parent-path":"imageCompression"},{default:f(()=>[v(i(e.$t("settings.always_use_jpeg")),1)]),_:1})])]),n("li",null,[u(r,{path:"useContainFit",expert:"1"},{default:f(()=>[v(i(e.$t("settings.use_contain_fit")),1)]),_:1})]),n("li",null,[u(r,{path:"hideNsfw"},{default:f(()=>[v(i(e.$t("settings.nsfw_clickthrough")),1)]),_:1})]),n("ul",sg,[n("li",null,[u(r,{path:"preloadImage",expert:"1","parent-path":"hideNsfw"},{default:f(()=>[v(i(e.$t("settings.preload_images")),1)]),_:1})]),n("li",null,[u(r,{path:"useOneClickNsfw",expert:"1","parent-path":"hideNsfw"},{default:f(()=>[v(i(e.$t("settings.use_one_click_nsfw")),1)]),_:1})])]),n("li",null,[u(r,{path:"loopVideo",expert:"1"},{default:f(()=>[v(i(e.$t("settings.loop_video")),1)]),_:1}),n("ul",ng,[n("li",null,[u(r,{path:"loopVideoSilentOnly",expert:"1","parent-path":"loopVideo",disabled:!e.loopSilentAvailable},{default:f(()=>[v(i(e.$t("settings.loop_video_silent_only")),1)]),_:1},8,["disabled"]),e.loopSilentAvailable?V("",!0):(m(),b("div",og,[u($,{icon:"globe"}),v("! "+i(e.$t("settings.limited_availability")),1)]))])])]),n("li",null,[u(r,{path:"playVideosInModal",expert:"1"},{default:f(()=>[v(i(e.$t("settings.play_videos_in_modal")),1)]),_:1})]),n("h3",null,i(e.$t("settings.mention_links")),1),n("li",null,[u(h,{id:"mentionLinkDisplay",path:"mentionLinkDisplay",options:e.mentionLinkDisplayOptions},{default:f(()=>[v(i(e.$t("settings.mention_link_display")),1)]),_:1},8,["options"])]),n("li",null,[u(r,{path:"mentionLinkShowTooltip",expert:"1"},{default:f(()=>[v(i(e.$t("settings.mention_link_use_tooltip")),1)]),_:1})]),n("li",null,[u(r,{path:"mentionLinkShowAvatar"},{default:f(()=>[v(i(e.$t("settings.mention_link_show_avatar")),1)]),_:1})]),n("li",null,[u(r,{path:"mentionLinkFadeDomain",expert:"1"},{default:f(()=>[v(i(e.$t("settings.mention_link_fade_domain")),1)]),_:1})]),e.user?(m(),b("li",lg,[u(r,{path:"mentionLinkBoldenYou",expert:"1"},{default:f(()=>[v(i(e.$t("settings.mention_link_bolden_you")),1)]),_:1})])):V("",!0),e.expertLevel>0?(m(),b("h3",ag,i(e.$t("settings.fun")),1)):V("",!0),n("li",null,[u(r,{path:"greentext",expert:"1"},{default:f(()=>[v(i(e.$t("settings.greentext")),1)]),_:1})]),e.user?(m(),b("li",ig,[u(r,{path:"mentionLinkShowYous",expert:"1"},{default:f(()=>[v(i(e.$t("settings.show_yous")),1)]),_:1})])):V("",!0)])]),e.user?(m(),b("div",rg,[n("h2",null,i(e.$t("settings.composing")),1),n("ul",dg,[n("li",null,[n("label",ug,[v(i(e.$t("settings.default_vis"))+" ",1),u(w,{"is-profile":!0}),u(y,{class:"scope-selector","show-all":!0,"user-default":e.$store.state.profileConfig.defaultScope,"initial-scope":e.$store.state.profileConfig.defaultScope,"on-scope-change":e.changeDefaultScope},null,8,["user-default","initial-scope","on-scope-change"])])]),n("li",null,[u(r,{path:"sensitiveByDefault"},{default:f(()=>[v(i(e.$t("settings.sensitive_by_default")),1)]),_:1})]),n("li",null,[u(r,{path:"scopeCopy",expert:"1"},{default:f(()=>[v(i(e.$t("settings.scope_copy")),1)]),_:1})]),n("li",null,[u(r,{path:"alwaysShowSubjectInput",expert:"1"},{default:f(()=>[v(i(e.$t("settings.subject_input_always_show")),1)]),_:1})]),n("li",null,[u(h,{id:"subjectLineBehavior",path:"subjectLineBehavior",options:e.subjectLineOptions,expert:"1"},{default:f(()=>[v(i(e.$t("settings.subject_line_behavior")),1)]),_:1},8,["options"])]),e.postFormats.length>0?(m(),b("li",cg,[u(h,{id:"postContentType",path:"postContentType",options:e.postContentOptions},{default:f(()=>[v(i(e.$t("settings.post_status_content_type")),1)]),_:1},8,["options"])])):V("",!0),n("li",null,[u(r,{path:"minimalScopesMode",expert:"1"},{default:f(()=>[v(i(e.$t("settings.minimal_scopes_mode")),1)]),_:1})]),n("li",null,[u(r,{path:"padEmoji",expert:"1"},{default:f(()=>[v(i(e.$t("settings.pad_emoji")),1)]),_:1})]),n("li",null,[u(r,{path:"autocompleteSelect",expert:"1"},{default:f(()=>[v(i(e.$t("settings.autocomplete_select_first")),1)]),_:1})]),n("li",null,[u(r,{path:"autoSaveDraft"},{default:f(()=>[v(i(e.$t("settings.auto_save_draft")),1)]),_:1})]),e.mergedConfig.autoSaveDraft?V("",!0):(m(),b("li",hg,[u(h,{id:"unsavedPostAction",path:"unsavedPostAction",options:e.unsavedPostActionOptions},{default:f(()=>[v(i(e.$t("settings.unsaved_post_action")),1)]),_:1},8,["options"])]))])])):V("",!0)],8,qf)}const mg=X(jf,[["render",pg]]),fg=["px","rem","vw"];({..._e.components},{..._e.props}),{..._e.computed},{..._e.methods};ue.add(Li);const gg={components:{Checkbox:pe},props:{name:{required:!0,type:String},label:{required:!0,type:String},modelValue:{required:!1,type:String,default:void 0},fallback:{required:!1,type:String,default:void 0},disabled:{required:!1,type:Boolean,default:!1},showOptionalCheckbox:{required:!1,type:Boolean,default:!0},hideOptionalCheckbox:{required:!1,type:Boolean,default:!1}},emits:["update:modelValue"],computed:{present(){return typeof this.modelValue<"u"},validColor(){return Ft(this.modelValue||this.fallback)},transparentColor(){return this.modelValue==="transparent"},computedColor(){return this.modelValue&&(this.modelValue.startsWith("--")||this.modelValue.startsWith("$"))}},methods:{updateValue:ae.throttle(function(e){this.$emit("update:modelValue",e)},100)}},bg=["for"],vg=["id","value","disabled"],$g={key:1,class:"transparentIndicator"},yg={key:3,class:"invalidIndicator"},wg={class:"nativeColor"},kg=["id","value","disabled"];function Cg(e,t,s,o,l,a){const d=P("Checkbox"),r=P("FAIcon");return m(),b("div",{class:W(["color-input style-control",{disabled:!a.present||s.disabled}])},[n("label",{for:s.name,class:W(["label",{faint:!a.present||s.disabled}])},i(s.label),11,bg),typeof s.fallback<"u"&&s.showOptionalCheckbox&&!s.hideOptionalCheckbox?(m(),H(d,{key:0,"model-value":a.present,disabled:s.disabled,class:"opt","onUpdate:modelValue":t[0]||(t[0]=h=>a.updateValue(typeof s.modelValue>"u"?s.fallback:void 0))},null,8,["model-value","disabled"])):V("",!0),n("div",{class:W(["input color-input-field",{disabled:!a.present||s.disabled}])},[n("input",{id:s.name+"-t",class:W(["textColor unstyled",{disabled:!a.present||s.disabled}]),type:"text",value:s.modelValue||s.fallback,disabled:!a.present||s.disabled,onInput:t[1]||(t[1]=h=>a.updateValue(h.target.value))},null,42,vg),a.validColor?(m(),b("div",{key:0,class:"validIndicator",style:Oe({backgroundColor:s.modelValue||s.fallback})},null,4)):a.transparentColor?(m(),b("div",$g)):a.computedColor?(m(),b("div",{key:2,class:"computedIndicator",style:Oe({backgroundColor:s.fallback})},null,4)):(m(),b("div",yg)),n("label",wg,[u(r,{icon:"eye-dropper"}),n("input",{id:s.name,class:W(["unstyled",{disabled:!a.present||s.disabled}]),type:"color",value:s.modelValue||s.fallback,disabled:!a.present||s.disabled,onInput:t[2]||(t[2]=h=>a.updateValue(h.target.value))},null,42,kg)])],2)],2)}const rt=X(gg,[["render",Cg]]),Tg=["disabled"],Ya={__name:"palette_editor",props:["modelValue","compact","apply","disabled"],emits:["update:modelValue","applyPalette"],setup(e,{emit:t}){ue.add(Oi,Ui);const s=["bg","fg","text","link","accent","cRed","cBlue","cGreen","cOrange","wallpaper"],o=e,l=t,a=()=>s.reduce((y,k)=>o.modelValue[k]==null?y:{...y,[k]:o.modelValue[k]},{}),d=Yt({filename:"pleroma_palette",extension:"json",getExportedObject:a}),r=kt({accept:".json",onImport(y){l("update:modelValue",y)}}),h=()=>{d.exportData()},c=()=>{r.importData()},p=()=>{l("applyPalette",a())},$=y=>{if(y==="accent")return o.modelValue.link;if(y==="link")return o.modelValue.accent;if(y.startsWith("extra"))return"#FF00FF";if(y.startsWith("wallpaper"))return"#008080"},w=(y,k)=>{l("update:modelValue",{...o.modelValue,[y]:k})};return(y,k)=>{const S=P("FAIcon");return m(),b("div",{class:W(["PaletteEditor",{"-compact":e.compact,"-apply":e.apply}])},[(m(),b(Y,null,se(s,T=>u(rt,{key:T,name:T,"model-value":o.modelValue[T],fallback:$(T),label:y.$t("settings.style.themes3.palette."+T),"onUpdate:modelValue":E=>w(T,E)},null,8,["name","model-value","fallback","label","onUpdate:modelValue"])),64)),n("button",{class:"btn button-default palette-import-button",onClick:c},[u(S,{icon:"file-import"}),v(" "+i(y.$t("settings.style.themes3.palette.import")),1)]),n("button",{class:"btn button-default palette-export-button",onClick:h},[u(S,{icon:"file-export"}),v(" "+i(y.$t("settings.style.themes3.palette.export")),1)]),e.apply?(m(),b("button",{key:0,class:W(["btn button-default palette-apply-button",{disabled:e.disabled}]),disabled:e.disabled,onClick:p},i(y.$t("settings.style.themes3.palette.apply")),11,Tg)):V("",!0)],2)}}};ue.add(Ht,Ri,Bi,Mi);const Vg={components:{Checkbox:pe}},Sg={class:"theme-preview-container"},Pg={class:"panel dummy"},Ig={class:"panel-heading"},Eg={class:"title"},Ag={class:"faint"},_g={class:"alert error"},Lg={class:"btn button-default"},Og={class:"panel-body theme-preview-content"},Ug={class:"post"},Rg={class:"content"},Bg={style:{"font-family":"var(--postCodeFont)"}},Mg={style:{color:"var(--link)"}},Fg={class:"icons"},Dg={class:"after-post"},Ng={class:"content"},jg={style:{color:"var(--linkFaint)"}},qg={class:"alert error"},zg=["value"],Hg={class:"actions"},Wg={class:"btn button-default"};function Kg(e,t,s,o,l,a){const d=P("i18n-t"),r=P("FAIcon"),h=P("Checkbox");return m(),b("div",Sg,[t[4]||(t[4]=n("div",{class:"underlay underlay-preview"},null,-1)),n("div",Pg,[n("div",Ig,[n("h1",Eg,[v(i(e.$t("settings.style.preview.header"))+" ",1),t[0]||(t[0]=n("span",{class:"badge -notification"}," 99 ",-1))]),n("span",Ag,i(e.$t("settings.style.preview.header_faint")),1),n("span",_g,i(e.$t("settings.style.preview.error")),1),n("button",Lg,i(e.$t("settings.style.preview.button")),1)]),n("div",Og,[n("div",Ug,[t[1]||(t[1]=n("div",{class:"avatar still-image"}," ( ͡° ͜ʖ ͡°) ",-1)),n("div",Rg,[n("h4",null,i(e.$t("settings.style.preview.content")),1),u(d,{scope:"global",keypath:"settings.style.preview.text"},{default:f(()=>[n("code",Bg,i(e.$t("settings.style.preview.mono")),1),n("a",Mg,i(e.$t("settings.style.preview.link")),1)]),_:1}),n("div",Fg,[u(r,{"fixed-width":"",style:{color:"var(--cBlue)"},class:"fa-scale-110 fa-old-padding",icon:"reply"}),u(r,{"fixed-width":"",style:{color:"var(--cGreen)"},class:"fa-scale-110 fa-old-padding",icon:"retweet"}),u(r,{"fixed-width":"",style:{color:"var(--cOrange)"},class:"fa-scale-110 fa-old-padding",icon:"star"}),u(r,{"fixed-width":"",style:{color:"var(--cRed)"},class:"fa-scale-110 fa-old-padding",icon:"times"})])])]),n("div",Dg,[t[2]||(t[2]=n("div",{class:"avatar-alt"}," :^) ",-1)),n("div",Ng,[u(d,{keypath:"settings.style.preview.fine_print",tag:"span",class:"faint",scope:"global"},{default:f(()=>[n("a",jg,i(e.$t("settings.style.preview.faint_link")),1)]),_:1})])]),t[3]||(t[3]=n("div",{class:"separator"},null,-1)),n("span",qg,i(e.$t("settings.style.preview.error")),1),n("input",{value:e.$t("settings.style.preview.input"),type:"text",class:"input"},null,8,zg),n("div",Hg,[u(h,null,{default:f(()=>[v(i(e.$t("settings.style.preview.checkbox")),1)]),_:1}),n("button",Wg,i(e.$t("settings.style.preview.button")),1)])])])])}const On=X(Vg,[["render",Kg]]);ue.add(Sa,Fi,Di);const Gg={components:{Select:qe,Checkbox:pe,Popover:Gt},props:["name","label","modelValue","fallback","options","no-inherit"],mounted(){Q().queryLocalFonts()},emits:["update:modelValue"],data(){return{manualEntry:!1,availableOptions:[this.noInherit?"":"inherit","serif","sans-serif","monospace",...this.options||[]].filter(e=>e)}},methods:{toggleManualEntry(){this.manualEntry=!this.manualEntry}},computed:{present(){return typeof this.modelValue<"u"},localFontsList(){return Q().localFonts},localFontsSize(){var e;return(e=Q().localFonts)==null?void 0:e.length}}},Yg={class:"font-control"},Xg=["id","for"],Jg={key:1,class:"font-input"},Zg=["id","for"],Qg=["id","for"],xg={key:2,class:"btn-group"},eb=["title"],tb=["id","model-value"],sb={key:3,class:"btn-group"},nb=["title"],ob=["label"],lb=["value"],ab=["label"],ib=["value"],rb=["label"],db={disabled:""},ub={disabled:""};function cb(e,t,s,o,l,a){var p,$;const d=P("Checkbox"),r=P("i18n-t"),h=P("FAIcon"),c=P("Select");return m(),b("div",Yg,[n("label",{id:e.name+"-label",for:e.manualEntry?e.name:e.name+"-font-switcher",class:"label"},i(e.$t("settings.style.themes3.font.label",{label:e.label})),9,Xg),t[7]||(t[7]=v(" "+i(" ")+" ")),typeof e.fallback<"u"?(m(),H(d,{key:0,id:e.name+"-o",class:"font-checkbox","model-value":e.present,onChange:t[0]||(t[0]=w=>e.$emit("update:modelValue",typeof e.modelValue>"u"?e.fallback:void 0))},{default:f(()=>[v(i(e.$t("settings.style.themes3.define")),1)]),_:1},8,["id","model-value"])):V("",!0),(p=e.modelValue)!=null&&p.family?(m(),b("div",Jg,[e.manualEntry?(m(),b("label",{key:0,id:e.name+"-label",for:e.manualEntry?e.name:e.name+"-font-switcher",class:"label"},[u(r,{keypath:"settings.style.themes3.font.entry",tag:"span",scope:"global"},{fontFamily:f(()=>t[5]||(t[5]=[n("code",null,"font-family",-1)])),_:1})],8,Zg)):(m(),b("label",{key:1,id:e.name+"-label",for:e.manualEntry?e.name:e.name+"-font-switcher",class:"label"},i(e.$t("settings.style.themes3.font.select")),9,Qg)),t[6]||(t[6]=v(" "+i(" ")+" ")),e.manualEntry?(m(),b("span",xg,[n("button",{class:"btn button-default",title:e.$t("settings.style.themes3.font.lookup_local_fonts"),onClick:t[1]||(t[1]=(...w)=>e.toggleManualEntry&&e.toggleManualEntry(...w))},[u(h,{"fixed-width":"",icon:"font"})],8,eb),n("input",{id:e.name,"model-value":e.modelValue.family,class:"input custom-font",type:"text","on:update:modelValue":t[2]||(t[2]=w=>e.$emit("update:modelValue",{...e.modelValue||{},family:w.target.value}))},null,40,tb)])):(m(),b("span",sb,[n("button",{class:"btn button-default",title:e.$t("settings.style.themes3.font.enter_manually"),onClick:t[3]||(t[3]=(...w)=>e.toggleManualEntry&&e.toggleManualEntry(...w))},[u(h,{"fixed-width":"",icon:"keyboard"})],8,nb),u(c,{id:e.name+"-local-font-switcher","model-value":($=e.modelValue)==null?void 0:$.family,class:"custom-font","onUpdate:modelValue":t[4]||(t[4]=w=>e.$emit("update:modelValue",{...e.modelValue||{},family:w}))},{default:f(()=>[n("optgroup",{label:e.$t("settings.style.themes3.font.group-builtin")},[(m(!0),b(Y,null,se(e.availableOptions,w=>(m(),b("option",{key:w,value:w,style:Oe({fontFamily:w==="inherit"?null:w})},i(e.$t("settings.style.themes3.font.builtin."+w)),13,lb))),128))],8,ob),e.localFontsSize>0?(m(),b("optgroup",{key:0,label:e.$t("settings.style.themes3.font.group-local")},[(m(!0),b(Y,null,se(e.localFontsList,w=>(m(),b("option",{key:w,value:w,style:Oe({fontFamily:w})},i(w),13,ib))),128))],8,ab)):(m(),b("optgroup",{key:1,label:e.$t("settings.style.themes3.font.group-local")},[n("option",db,i(e.$t("settings.style.themes3.font.local-unavailable1")),1),n("option",ub,i(e.$t("settings.style.themes3.font.local-unavailable2")),1)],8,rb))]),_:1},8,["id","model-value"])]))])):V("",!0)])}const Xa=X(Gg,[["render",cb]]);ue.add(Va);const hb={data(){return{availableThemesV3:[],availableThemesV2:[],bundledPalettes:[],compilationCache:{},fileImporter:kt({accept:".json, .iss",validator:this.importValidator,onImport:this.onImport,parser:this.importParser,onImportFailure:this.onImportFailure}),palettesKeys:["bg","fg","link","text","cRed","cGreen","cBlue","cOrange"],userPalette:{},intersectionObserver:null,thirdColumnModeOptions:["none","notifications","postform"].map(e=>({key:e,value:e,label:this.$t(`settings.third_column_mode_${e}`)})),forcedRoundnessOptions:["disabled","sharp","nonsharp","round"].map((e,t)=>({key:e,value:t-1,label:this.$t(`settings.style.themes3.hacks.forced_roundness_mode_${e}`)})),underlayOverrideModes:["none","opaque","transparent"].map(e=>({key:e,value:e,label:this.$t(`settings.style.themes3.hacks.underlay_override_mode_${e}`)}))}},components:{BooleanSetting:wt,ChoiceSetting:vn,IntegerSetting:bn,FloatSetting:Ga,UnitSetting:yn,ProfileSettingIndicator:Aa,FontControl:Xa,Preview:On,PaletteEditor:Ya},mounted(){Q().getThemeData();const e=t=>{const s=t[0].toUpperCase()+t.slice(1),o=this.$store.state.instance[`${t}sIndex`];let l;return o?l=Promise.resolve(o):l=Q()[`fetch${s}sIndex`](),l.then(a=>Object.entries(a).map(([d,r])=>[d,r()]))};e("style").then(t=>{t.forEach(([s,o])=>o.then(l=>{const a=l.find(d=>d.component==="@meta");this.availableThemesV3.push({key:s,data:l,name:a.directives.name,version:"v3"})}))}),e("theme").then(t=>{t.forEach(([s,o])=>o.then(l=>{l?Array.isArray(l)?console.warn(`Theme with key ${s} is a v1 theme and should be moved to static/palettes/index.json`):!l.source&&!l.theme?console.warn(`Theme with key ${s} is malformed`):this.availableThemesV2.push({key:s,data:l,name:l.name,version:"v2"}):console.warn(`Theme with key ${s} is empty or malformed`)}))}),this.userPalette=Q().paletteDataUsed||{},e("palette").then(t=>{t.forEach(([s,o])=>o.then(l=>{let a;if(Array.isArray(l)){const[d,r,h,c,p,$="#FF0000",w="#00FF00",y="#0000FF",k="#E3FF00"]=l;a={key:s,name:d,bg:r,fg:h,text:c,link:p,cRed:$,cBlue:y,cGreen:w,cOrange:k}}else a={key:s,...l};a.key.startsWith("style.")||this.bundledPalettes.push(a)}))}),window.IntersectionObserver&&(this.intersectionObserver=new IntersectionObserver((t,s)=>{t.forEach(({target:o,isIntersecting:l})=>{if(!l)return;const a=this.availableStyles.find(d=>d.key===o.dataset.themeKey);this.$nextTick(()=>{a&&(a.ready=!0)}),s.unobserve(o)})},{root:this.$refs.themeList}))},updated(){this.$nextTick(()=>{this.$refs.themeList.querySelectorAll(".theme-preview").forEach(e=>{this.intersectionObserver.observe(e)})})},watch:{paletteDataUsed(){this.userPalette=this.paletteDataUsed||{}}},computed:{switchInProgress(){return Q().themeChangeInProgress},paletteDataUsed(){return Q().paletteDataUsed},availableStyles(){return[...this.availableThemesV3,...this.availableThemesV2]},availablePalettes(){return[...this.bundledPalettes,...this.stylePalettes]},stylePalettes(){const e=Q().styleDataUsed||[];if(!e&&e.length===0)return;const t=e.find(o=>o.component==="@meta");return e.filter(o=>o.component.startsWith("@palette")).map(o=>{const{variant:l,directives:a}=o,{bg:d,fg:r,text:h,link:c,accent:p,cRed:$,cBlue:w,cGreen:y,cOrange:k,wallpaper:S}=a,T={name:`${t.directives.name||this.$t("settings.style.themes3.palette.imported")}: ${l}`,key:`style.${l.toLowerCase().replace(/ /g,"_")}`,bg:d,fg:r,text:h,link:c,accent:p,cRed:$,cBlue:w,cGreen:y,cOrange:k,wallpaper:S};return Object.fromEntries(Object.entries(T).filter(([,E])=>E))})},noIntersectionObserver(){return!window.IntersectionObserver},horizontalUnits(){return fg},fontsOverride(){return this.$store.getters.mergedConfig.fontsOverride},columns(){const e=this.$store.getters.mergedConfig.thirdColumnMode,t=e==="none"?[]:["notifs"];return this.$store.getters.mergedConfig.sidebarRight||e==="postform"?[...t,"content","sidebar"]:["sidebar","content",...t]},instanceWallpaperUsed(){return this.$store.state.instance.background&&!this.$store.state.users.currentUser.background_image},language:{get:function(){return this.$store.getters.mergedConfig.interfaceLanguage},set:function(e){this.$store.dispatch("setOption",{name:"interfaceLanguage",value:e})}},customThemeVersion(){const{themeVersion:e}=Q();return e},isCustomThemeUsed(){const{customTheme:e,customThemeSource:t}=this.mergedConfig;return e!=null||t!=null},isCustomStyleUsed(){const{styleCustomData:e}=this.mergedConfig;return e!=null},...yt()},methods:{updateFont(e,t){this.$store.dispatch("setOption",{name:"theme3hacks",value:{...this.mergedConfig.theme3hacks,fonts:{...this.mergedConfig.theme3hacks.fonts,[e]:t}}})},importFile(){this.fileImporter.importData()},importParser(e,t){if(t.endsWith(".json"))return JSON.parse(e);if(t.endsWith(".iss"))return Ia(e)},onImport(e,t){t.endsWith(".json")?Q().setThemeCustom(e.source||e.theme):t.endsWith(".iss")&&Q().setStyleCustom(e)},onImportFailure(e){console.error("Failure importing theme:",e),Q().pushGlobalNotice({messageKey:"settings.invalid_theme_imported",level:"error"})},importValidator(e,t){if(t.endsWith(".json")){const s=e._pleroma_theme_version;return s>=1||s<=2}else if(t.endsWith(".iss"))return!(!Array.isArray(e)||e.length<1||e.find(s=>s.component==="@meta")==null)},isThemeActive(e){return e===(this.mergedConfig.theme||this.$store.state.instance.theme)},isStyleActive(e){return e===(this.mergedConfig.style||this.$store.state.instance.style)},isPaletteActive(e){return e===(this.mergedConfig.palette||this.$store.state.instance.palette)},...ba(Q,["setStyle","setTheme"]),setPalette(e,t){Q().setPalette(e),this.userPalette=t},setPaletteCustom(e){Q().setPaletteCustom(e),this.userPalette=e},resetTheming(){Q().setStyle("stock")},previewTheme(e,t,s){let o;if(this.compilationCache[e])o=this.compilationCache[e];else if(s){if(t==="v2"){const l=Ni(s),a=Pa(l);o=bt({inputRuleset:a,ultimateBackgroundColor:"#000000",liteMode:!0,debug:!0,onlyNormalState:!0})}else if(t==="v3"){const l=s.find(d=>d.component==="@palette");let a;if(l){const{directives:d}=l;d.link=d.link||d.accent,d.accent=d.accent||d.link,a={component:"Root",directives:Object.fromEntries(Object.entries(d).filter(([r])=>r&&r!=="name").map(([r,h])=>["--"+r,"color | "+h]))}}else a=null;o=bt({inputRuleset:[...s,a].filter(d=>d),ultimateBackgroundColor:"#000000",liteMode:!0,debug:!0,onlyNormalState:!0})}}else o=bt({inputRuleset:[],ultimateBackgroundColor:"#000000",liteMode:!0,debug:!0,onlyNormalState:!0});return this.compilationCache[e]||(this.compilationCache[e]=o),fn(Dt(o.eager),"#theme-preview-"+e).join(`
`)}}},pb=["label"],mb={class:"setting-item"},fb={ref:"themeList",class:"theme-list"},gb=["disabled"],bb={class:"theme-name"},vb={key:0,disabled:"",class:"button-default theme-preview toggled"},$b={class:"theme-name"},yb={key:1,disabled:"",class:"button-default theme-preview toggled"},wb={class:"theme-name"},kb=["data-theme-key","disabled","onClick"],Cb={key:0},Tb={class:"theme-name"},Vb={class:"alert neutral version"},Sb={class:"import-file-container"},Pb=["disabled"],Ib={class:"setting-item"},Eb={key:0,class:"palettes-container"},Ab={key:0},_b={class:"palettes"},Lb=["disabled","onClick"],Ob={class:"palette-label"},Ub={class:"palette-preview"},Rb=["disabled","onClick"],Bb={class:"palette-label"},Mb={class:"palette-preview"},Fb={key:0},Db={key:1,class:"alert neutral theme-notice unsupported-theme-v2"},Nb={class:"setting-item"},jb={class:"alert neutral theme-notice"},qb={class:"setting-list"},zb={class:"setting-list suboptions"},Hb={key:0},Wb={class:"column-settings"},Kb={class:"setting-item"},Gb={class:"setting-list"},Yb={key:0};function Xb(e,t,s,o,l,a){var S;const d=P("preview"),r=P("FAIcon"),h=P("PaletteEditor"),c=P("UnitSetting"),p=P("i18n-t"),$=P("FloatSetting"),w=P("FontControl"),y=P("BooleanSetting"),k=P("ChoiceSetting");return m(),b("div",{class:"appearance-tab",label:e.$t("settings.general")},[n("div",mb,[n("h2",null,i(e.$t("settings.theme")),1),n("ul",fb,[n("button",{class:W(["button-default theme-preview",{toggled:e.isStyleActive("stock"),disabled:e.switchInProgress}]),"data-theme-key":"stock",disabled:e.switchInProgress,onClick:t[0]||(t[0]=(...T)=>e.resetTheming&&e.resetTheming(...T))},[(m(),H(lt("style"),{innerHTML:e.previewTheme("stock","v3")},null,8,["innerHTML"])),u(d,{id:"theme-preview-stock"}),n("h4",bb,[v(i(e.$t("settings.style.stock_theme_used"))+" ",1),t[8]||(t[8]=n("span",{class:"alert neutral version"},"v3",-1))])],10,gb),e.isCustomThemeUsed?(m(),b("button",vb,[u(d),n("h4",$b,[v(i(e.$t("settings.style.custom_theme_used"))+" ",1),t[9]||(t[9]=n("span",{class:"alert neutral version"},"v2",-1))])])):V("",!0),e.isCustomStyleUsed?(m(),b("button",yb,[u(d),n("h4",wb,[v(i(e.$t("settings.style.custom_style_used"))+" ",1),t[10]||(t[10]=n("span",{class:"alert neutral version"},"v3",-1))])])):V("",!0),(m(!0),b(Y,null,se(e.availableStyles,T=>(m(),b("button",{key:T.key,"data-theme-key":T.key,class:W(["button-default theme-preview",{toggled:e.isThemeActive(T.key),disabled:e.switchInProgress}]),disabled:e.switchInProgress,onClick:E=>T.version==="v2"?e.setTheme(T.key):e.setStyle(T.key)},[T.ready||e.noIntersectionObserver?(m(),b("div",Cb,[(m(),H(lt("style"),{innerHTML:e.previewTheme(T.key,T.version,T.data)},null,8,["innerHTML"]))])):V("",!0),u(d,{id:"theme-preview-"+T.key},null,8,["id"]),n("h4",Tb,[v(i(T.name)+" ",1),n("span",Vb,i(T.version),1)])],10,kb))),128))],512),n("div",Sb,[n("button",{class:W(["btn button-default",{disabled:e.switchInProgress}]),disabled:e.switchInProgress,onClick:t[1]||(t[1]=(...T)=>e.importFile&&e.importFile(...T))},[u(r,{icon:"folder-open"}),v(" "+i(e.$t("settings.style.themes3.editor.load_style")),1)],10,Pb)]),n("div",Ib,[n("h2",null,i(e.$t("settings.style.themes3.palette.label")),1),e.customThemeVersion==="v3"?(m(),b("div",Eb,[((S=e.stylePalettes)==null?void 0:S.length)>0?(m(),b("h4",Ab,i(e.$t("settings.style.themes3.palette.style")),1)):V("",!0),n("div",_b,[(m(!0),b(Y,null,se(e.stylePalettes||[],T=>(m(),b("button",{key:T.name,class:W(["btn button-default palette-entry",{toggled:e.isPaletteActive(T.key),disabled:e.switchInProgress}]),disabled:e.switchInProgress,onClick:()=>e.setPalette(T.key,T)},[n("div",Ob,[n("label",null,i(T.name??e.$t("settings.style.themes3.palette.user")),1)]),n("div",Ub,[(m(!0),b(Y,null,se(e.palettesKeys,E=>(m(),b("span",{key:E,class:"palette-square",style:Oe({backgroundColor:T[E],border:"1px solid "+(T[E]??"var(--text)")})},null,4))),128))])],10,Lb))),128)),n("h4",null,i(e.$t("settings.style.themes3.palette.bundled")),1),(m(!0),b(Y,null,se(e.bundledPalettes,T=>(m(),b("button",{key:T.name,class:W(["btn button-default palette-entry",{toggled:e.isPaletteActive(T.key),disabled:e.switchInProgress}]),disabled:e.switchInProgress,onClick:()=>e.setPalette(T.key,T)},[n("div",Bb,[n("label",null,i(T.name),1)]),n("div",Mb,[(m(!0),b(Y,null,se(e.palettesKeys,E=>(m(),b("span",{key:E,class:"palette-square",style:Oe({backgroundColor:T[E],border:"1px solid "+(T[E]??"var(--text)")})},null,4))),128))])],10,Rb))),128))])])):V("",!0),n("div",null,[e.customThemeVersion==="v3"?(m(),b(Y,{key:0},[e.expertLevel>0?(m(),b("h4",Fb,i(e.$t("settings.style.themes3.palette.user")),1)):V("",!0),e.expertLevel>0?(m(),H(h,{key:1,modelValue:e.userPalette,"onUpdate:modelValue":t[2]||(t[2]=T=>e.userPalette=T),class:"userPalette",compact:!0,apply:!0,disabled:e.switchInProgress,onApplyPalette:t[3]||(t[3]=T=>e.setPaletteCustom(T))},null,8,["modelValue","disabled"])):V("",!0)],64)):e.customThemeVersion==="v2"?(m(),b("div",Db,i(e.$t("settings.style.themes3.palette.v2_unsupported")),1)):V("",!0)])])]),n("div",Nb,[n("h2",null,i(e.$t("settings.scale_and_layout")),1),n("div",jb,i(e.$t("settings.style.appearance_tab_note")),1),n("ul",qb,[n("li",null,[u(c,{path:"textSize",step:.1,units:["px","rem"],"reset-default":{px:14,rem:1},"timed-apply-mode":""},{default:f(()=>[v(i(e.$t("settings.text_size")),1)]),_:1}),n("div",null,[n("small",null,[u(p,{scope:"global",keypath:"settings.text_size_tip",tag:"span"},{default:f(()=>t[11]||(t[11]=[n("code",null,"px",-1),n("code",null,"rem",-1)])),_:1}),t[13]||(t[13]=n("br",null,null,-1)),u(p,{scope:"global",keypath:"settings.text_size_tip2",tag:"span"},{default:f(()=>t[12]||(t[12]=[n("code",null,"14px",-1)])),_:1})])])]),n("li",null,[u(c,{path:"emojiSize",step:.1,units:["px","rem"],"reset-default":{px:32,rem:2.2}},{default:f(()=>[v(i(e.$t("settings.emoji_size")),1)]),_:1}),n("ul",zb,[n("li",null,[e.user?(m(),H($,{key:0,path:"emojiReactionsScale",expert:"1"},{default:f(()=>[v(i(e.$t("settings.emoji_reactions_scale")),1)]),_:1})):V("",!0)])])]),n("li",null,[u(c,{path:"navbarSize",step:.1,units:["px","rem"],"reset-default":{px:55,rem:3.5}},{default:f(()=>[v(i(e.$t("settings.navbar_size")),1)]),_:1})]),n("h3",null,i(e.$t("settings.style.interface_font_user_override")),1),n("li",null,[u(w,{"model-value":e.mergedConfig.theme3hacks.fonts.interface,name:"ui",label:e.$t("settings.style.fonts.components.interface"),fallback:{family:"sans-serif"},"no-inherit":"1","onUpdate:modelValue":t[4]||(t[4]=T=>e.updateFont("interface",T))},null,8,["model-value","label"])]),n("li",null,[e.expertLevel>0?(m(),H(w,{key:0,"model-value":e.mergedConfig.theme3hacks.fonts.input,name:"input",fallback:{family:"inherit"},label:e.$t("settings.style.fonts.components.input"),"onUpdate:modelValue":t[5]||(t[5]=T=>e.updateFont("input",T))},null,8,["model-value","label"])):V("",!0)]),n("li",null,[e.expertLevel>0?(m(),H(w,{key:0,"model-value":e.mergedConfig.theme3hacks.fonts.post,name:"post",fallback:{family:"inherit"},label:e.$t("settings.style.fonts.components.post"),"onUpdate:modelValue":t[6]||(t[6]=T=>e.updateFont("post",T))},null,8,["model-value","label"])):V("",!0)]),n("li",null,[e.expertLevel>0?(m(),H(w,{key:0,"model-value":e.mergedConfig.theme3hacks.fonts.monospace,name:"postCode",fallback:{family:"monospace"},label:e.$t("settings.style.fonts.components.monospace"),"onUpdate:modelValue":t[7]||(t[7]=T=>e.updateFont("monospace",T))},null,8,["model-value","label"])):V("",!0)]),n("h3",null,i(e.$t("settings.columns")),1),n("li",null,[u(c,{path:"panelHeaderSize",step:.1,units:["px","rem"],"reset-default":{px:52,rem:3.2},"timed-apply-mode":""},{default:f(()=>[v(i(e.$t("settings.panel_header_size")),1)]),_:1})]),n("li",null,[u(y,{path:"sidebarRight"},{default:f(()=>[v(i(e.$t("settings.right_sidebar")),1)]),_:1})]),n("li",null,[u(y,{path:"navbarColumnStretch"},{default:f(()=>[v(i(e.$t("settings.navbar_column_stretch")),1)]),_:1})]),n("li",null,[e.user?(m(),H(k,{key:0,id:"thirdColumnMode",path:"thirdColumnMode",options:e.thirdColumnModeOptions},{default:f(()=>[v(i(e.$t("settings.third_column_mode")),1)]),_:1},8,["options"])):V("",!0)]),e.expertLevel>0?(m(),b("li",Hb,[v(i(e.$t("settings.column_sizes"))+" ",1),n("div",Wb,[(m(!0),b(Y,null,se(e.columns,T=>(m(),H(c,{key:T,path:T+"ColumnWidth",units:e.horizontalUnits,expert:"1"},{default:f(()=>[v(i(e.$t("settings.column_sizes_"+T)),1)]),_:2},1032,["path","units"]))),128))])])):V("",!0),n("li",null,[u(y,{path:"disableStickyHeaders"},{default:f(()=>[v(i(e.$t("settings.disable_sticky_headers")),1)]),_:1})]),n("li",null,[u(y,{path:"showScrollbars"},{default:f(()=>[v(i(e.$t("settings.show_scrollbars")),1)]),_:1})]),n("li",null,[u(c,{path:"themeEditorMinWidth",units:["px","rem"],expert:"1"},{default:f(()=>[v(i(e.$t("settings.theme_editor_min_width")),1)]),_:1})])])]),n("div",Kb,[n("h2",null,i(e.$t("settings.visual_tweaks")),1),n("ul",Gb,[n("li",null,[u(y,{path:"modalMobileCenter"},{default:f(()=>[v(i(e.$t("settings.mobile_center_dialog")),1)]),_:1})]),n("li",null,[u(k,{id:"forcedRoundness",path:"forcedRoundness",options:e.forcedRoundnessOptions},{default:f(()=>[v(i(e.$t("settings.style.themes3.hacks.force_interface_roundness")),1)]),_:1},8,["options"])]),n("li",null,[u(k,{id:"underlayOverride",path:"theme3hacks.underlay",options:e.underlayOverrideModes},{default:f(()=>[v(i(e.$t("settings.style.themes3.hacks.underlay_overrides")),1)]),_:1},8,["options"])]),e.instanceWallpaperUsed?(m(),b("li",Yb,[u(y,{path:"hideInstanceWallpaper"},{default:f(()=>[v(i(e.$t("settings.hide_wallpaper")),1)]),_:1})])):V("",!0),n("li",null,[u(y,{path:"forceThemeRecompilation",expert:1},{default:f(()=>[v(i(e.$t("settings.force_theme_recompilation_debug")),1)]),_:1})]),n("li",null,[u(y,{path:"themeDebug",expert:1},{default:f(()=>[v(i(e.$t("settings.theme_debug")),1)]),_:1})])])])],8,pb)}const Jb=X(hb,[["render",Xb]]),Zb="https://git.pleroma.social/pleroma/pleroma-fe/commit/",Qb={data(){const e=this.$store.state.instance;return{backendVersion:e.backendVersion,backendRepository:e.backendRepository,frontendVersion:e.frontendVersion}},computed:{frontendVersionLink(){return Zb+this.frontendVersion}}},xb=["label"],ev={class:"setting-item"},tv={class:"setting-list"},sv={class:"option-list"},nv=["href"],ov={class:"option-list"},lv=["href"];function av(e,t,s,o,l,a){return m(),b("div",{label:e.$t("settings.version.title")},[n("div",ev,[n("ul",tv,[n("li",null,[n("p",null,i(e.$t("settings.version.backend_version")),1),n("ul",sv,[n("li",null,[n("a",{href:e.backendRepository,target:"_blank"},i(e.backendVersion),9,nv)])])]),n("li",null,[n("p",null,i(e.$t("settings.version.frontend_version")),1),n("ul",ov,[n("li",null,[n("a",{href:e.frontendVersionLink,target:"_blank"},i(e.frontendVersion),9,lv)])])])])])],8,xb)}const iv=X(Qb,[["render",av]]),rv={props:["name","modelValue","fallback","disabled","label","max","min","step","hardMin","hardMax"],emits:["update:modelValue"],computed:{present(){return typeof this.modelValue<"u"}}},dv=["id","for"],uv=["id","aria-labelledby","checked"],cv=["for"],hv=["id","value","disabled","max","min","step"],pv=["id","aria-labelledby","value","disabled","max","min","step"];function mv(e,t,s,o,l,a){return m(),b("div",{class:W(["range-control style-control",{disabled:!a.present||s.disabled}])},[n("label",{id:s.name+"-label",for:s.name,class:"label"},i(s.label),9,dv),typeof s.fallback<"u"?(m(),b("input",{key:0,id:s.name+"-o","aria-labelledby":s.name+"-label",class:"input -checkbox opt visible-for-screenreader-only",type:"checkbox",checked:a.present,onChange:t[0]||(t[0]=d=>e.$emit("update:modelValue",a.present?void 0:s.fallback))},null,40,uv)):V("",!0),typeof s.fallback<"u"?(m(),b("label",{key:1,class:"opt-l",for:s.name+"-o","aria-hidden":!0},null,8,cv)):V("",!0),n("input",{id:s.name,class:"input input-number",type:"range",value:s.modelValue||s.fallback,disabled:!a.present||s.disabled,max:s.max||s.hardMax||100,min:s.min||s.hardMin||0,step:s.step||1,onInput:t[1]||(t[1]=d=>e.$emit("update:modelValue",d.target.value))},null,40,hv),n("input",{id:s.name+"-numeric",class:"input input-number",type:"number","aria-labelledby":s.name+"-label",value:s.modelValue||s.fallback,disabled:!a.present||s.disabled,max:s.hardMax,min:s.hardMin,step:s.step||1,onInput:t[2]||(t[2]=d=>e.$emit("update:modelValue",d.target.value))},null,40,pv)],2)}const fv=X(rv,[["render",mv]]),gv={components:{Checkbox:pe},props:["name","label","modelValue","fallback","disabled"],emits:["update:modelValue"],computed:{present(){return typeof this.modelValue<"u"}}},bv=["for"],vv=["id","value","disabled"];function $v(e,t,s,o,l,a){const d=P("Checkbox");return m(),b("div",{class:W(["opacity-control style-control",{disabled:!a.present||s.disabled}])},[n("label",{for:s.name,class:W(["label",{faint:!a.present||s.disabled}])},i(s.label),11,bv),typeof s.fallback<"u"?(m(),H(d,{key:0,"model-value":a.present,disabled:s.disabled,class:"opt","onUpdate:modelValue":t[0]||(t[0]=r=>e.$emit("update:modelValue",a.present?void 0:s.fallback))},null,8,["model-value","disabled"])):V("",!0),n("input",{id:s.name,class:W(["input input-number",{disabled:!a.present||s.disabled}]),type:"number",value:s.modelValue||s.fallback,disabled:!a.present||s.disabled,max:"1",min:"0",step:".05",onInput:t[1]||(t[1]=r=>e.$emit("update:modelValue",r.target.value))},null,42,vv)],2)}const Un=X(gv,[["render",$v]]),yv={class:"SelectMotion btn-group"},wv=["disabled"],kv=["disabled"],Cv=["disabled"],Tv=["disabled"],Rn={__name:"select_motion",props:{modelValue:{type:Array,required:!0},selectedId:{type:Number,required:!0},disabled:{type:Boolean,default:!1},getAddValue:{type:Function,required:!0}},emits:["update:modelValue","update:selectedId"],setup(e,{emit:t}){const s=e,o=t,l=Z(()=>s.selectedId>0),a=Z(()=>s.modelValue[s.selectedId]!=null),d=async()=>{const $=[...s.modelValue],w=$.splice(s.selectedId,1)[0];$.splice(s.selectedId-1,0,w),o("update:modelValue",$),await At(),o("update:selectedId",s.selectedId-1)},r=Z(()=>s.selectedId<s.modelValue.length-1),h=async()=>{const $=[...s.modelValue],w=$.splice(s.selectedId.value,1)[0];$.splice(s.selectedId+1,0,w),o("update:modelValue",$),await At(),o("update:selectedId",s.selectedId+1)},c=async()=>{const $=[...s.modelValue,s.getAddValue()];o("update:modelValue",$),await At(),o("update:selectedId",Math.max($.length-1,0))},p=async()=>{const $=[...s.modelValue];$.splice(s.selectedId,1),o("update:modelValue",$),await At(),o("update:selectedId",$.length===0?void 0:Math.max(s.selectedId-1,0))};return($,w)=>{const y=P("FAIcon");return m(),b("div",yv,[n("button",{class:"btn button-default",disabled:e.disabled,onClick:c},[u(y,{"fixed-width":"",icon:"plus"})],8,wv),n("button",{class:W(["btn button-default",{disabled:e.disabled||!l.value}]),disabled:e.disabled||!l.value,onClick:d},[u(y,{"fixed-width":"",icon:"chevron-up"})],10,kv),n("button",{class:W(["btn button-default",{disabled:e.disabled||!r.value}]),disabled:e.disabled||!r.value,onClick:h},[u(y,{"fixed-width":"",icon:"chevron-down"})],10,Cv),n("button",{class:W(["btn button-default",{disabled:e.disabled||!a.value}]),disabled:e.disabled||!a.value,onClick:p},[u(y,{"fixed-width":"",icon:"times"})],10,Tv)])}}},Vv={components:{Checkbox:pe,ColorInput:rt},props:["shadow","shadowControl","previewClass","previewStyle","previewCss","disabled","invalid","noColorControl"],emits:["update:shadow"],data(){return{colorOverride:void 0,lightGrid:!1,zoom:100}},computed:{style(){const e=[this.previewStyle,`zoom: ${this.zoom/100}`];return this.colorOverride&&e.push(`--background: ${this.colorOverride}`),e},hideControls(){return typeof this.shadow=="string"}},methods:{updateProperty(e,t){this.$emit("update:shadow",{axis:e,value:Number(t)})}}},Sv={class:"x-shift-number"},Pv=["value","disabled"],Iv={class:"y-shift-number"},Ev=["value","disabled"],Av=["value","disabled"],_v=["value","disabled"],Lv={key:0,class:"invalid-container"},Ov={class:"alert error invalid-label"},Uv={class:"assists"},Rv={class:"style-control"},Bv={class:"label"};function Mv(e,t,s,o,l,a){var h,c,p,$;const d=P("Checkbox"),r=P("ColorInput");return m(),b("div",{class:W(["ComponentPreview",{"-shadow-controls":s.shadowControl}])},[(m(),H(lt("style"),{innerHTML:s.previewCss},null,8,["innerHTML"])),x(n("label",{role:"heading",class:W(["header",{faint:s.disabled}])},i(e.$t("settings.style.shadows.offset")),3),[[st,s.shadowControl]]),x(n("label",Sv,[v(i(e.$t("settings.style.shadows.offset-x"))+" ",1),n("input",{value:(h=s.shadow)==null?void 0:h.x,disabled:s.disabled,class:W([{disabled:s.disabled},"input input-number"]),type:"number",onInput:t[0]||(t[0]=w=>a.updateProperty("x",w.target.value))},null,42,Pv)],512),[[st,s.shadowControl&&!a.hideControls]]),x(n("label",Iv,[v(i(e.$t("settings.style.shadows.offset-y"))+" ",1),n("input",{value:(c=s.shadow)==null?void 0:c.y,disabled:s.disabled,class:W([{disabled:s.disabled},"input input-number"]),type:"number",onInput:t[1]||(t[1]=w=>a.updateProperty("y",w.target.value))},null,42,Ev)],512),[[st,s.shadowControl&&!a.hideControls]]),x(n("input",{value:(p=s.shadow)==null?void 0:p.x,disabled:s.disabled,class:W([{disabled:s.disabled},"input input-range x-shift-slider"]),type:"range",max:"20",min:"-20",onInput:t[2]||(t[2]=w=>a.updateProperty("x",w.target.value))},null,42,Av),[[st,s.shadowControl&&!a.hideControls]]),x(n("input",{value:($=s.shadow)==null?void 0:$.y,disabled:s.disabled,class:W([{disabled:s.disabled},"input input-range y-shift-slider"]),type:"range",max:"20",min:"-20",onInput:t[3]||(t[3]=w=>a.updateProperty("y",w.target.value))},null,42,_v),[[st,s.shadowControl&&!a.hideControls]]),n("div",{class:W(["preview-window",{"-light-grid":l.lightGrid}])},[n("div",{class:W(["preview-block",s.previewClass]),style:Oe(a.style)},i(e.$t("settings.style.themes3.editor.test_string")),7),s.invalid?(m(),b("div",Lv,[n("div",Ov,i(e.$t("settings.style.themes3.editor.invalid")),1)])):V("",!0)],2),n("div",Uv,[u(d,{modelValue:l.lightGrid,"onUpdate:modelValue":t[4]||(t[4]=w=>l.lightGrid=w),name:"lightGrid",class:"input-light-grid"},{default:f(()=>[v(i(e.$t("settings.style.shadows.light_grid")),1)]),_:1},8,["modelValue"]),n("div",Rv,[n("label",Bv,i(e.$t("settings.style.shadows.zoom")),1),x(n("input",{"onUpdate:modelValue":t[5]||(t[5]=w=>l.zoom=w),class:"input input-number y-shift-number",type:"number"},null,512),[[ie,l.zoom]])]),s.noColorControl?V("",!0):(m(),H(r,{key:0,modelValue:l.colorOverride,"onUpdate:modelValue":t[6]||(t[6]=w=>l.colorOverride=w),class:"input-color-input",fallback:"#606060",label:e.$t("settings.style.shadows.color_override")},null,8,["modelValue","label"]))])],2)}const Ja=X(Vv,[["render",Mv]]),zt=e=>{if(typeof e=="object"){const t=e.inset?"inset ":"",s=e.name?` #${e.name} `:"",o=`${t}${e.x} ${e.y} ${e.blur} ${e.spread} ${e.color} / ${e.alpha}${s}`;return gn(o),o}else return e},Fv=e=>e.map(t=>{if(Object.keys(t.directives||{}).length===0)return!1;const s=ji(t).reverse().map(l=>{const{component:a}=l,d=l.variant==null||l.variant==="normal"?"":"."+l.variant,r=(l.state||[]).filter(h=>h!=="normal");return`${a}${d}${r.map(h=>":"+h).join("")}`}).join(" "),o=Object.entries(t.directives).map(([l,a])=>{if(l.startsWith("--")){const[d,r]=a.split("|");switch(d){case"shadow":return`  ${l}: ${d.trim()} | ${r.map(zt).map(h=>h.trim()).join(", ")}`;default:return`  ${l}: ${d.trim()} | ${r.trim()}`}}else switch(l){case"shadow":return a.length>0?`  ${l}: ${a.map(zt).join(", ")}`:`  ${l}: none`;default:return`  ${l}: ${a}`}});return`${s} {
${o.join(`;
`)}
}`}).filter(t=>t).join(`

`);ue.add(Hi,Wi,Ht,Ta);const Bt=e=>{if(typeof e=="object")return{x:0,y:0,blur:0,spread:0,inset:!1,color:"#000000",alpha:1,...e};if(typeof e=="string")return e},Dv={props:["modelValue","fallback","separateInset","noPreview","disabled","staticVars","compact"],emits:["update:modelValue","subShadowSelected"],data(){return{selectedId:0,invalid:!1}},components:{ColorInput:rt,OpacityInput:Un,Select:qe,SelectMotion:Rn,Checkbox:pe,Popover:Gt,ComponentPreview:Ja},computed:{cValue:{get(){return(this.modelValue??this.fallback??[]).map(Bt)},set(e){this.$emit("update:modelValue",e)}},selectedType:{get(){return typeof this.selected},set(e){this.selected=Bt(e==="object"?{}:"")}},selected:{get(){const e=this.cValue[this.selectedId];return e&&typeof e=="object"?{...e}:typeof e=="string"?e:null},set(e){this.cValue[this.selectedId]=Bt(e),this.$emit("update:modelValue",this.cValue)}},present(){return this.selected!=null&&this.modelValue!=null},shadowsAreNull(){return this.modelValue==null},currentFallback(){var e;return(e=this.fallback)==null?void 0:e[this.selectedId]},getColorFallback(){var e,t;if(this.staticVars&&((e=this.selected)!=null&&e.color))try{const s=ln(this.selected.color,{dynamicVars:{},staticVars:this.staticVars},!0);return s?We(s):null}catch(s){return console.warn(s),null}else return(t=this.currentFallback)==null?void 0:t.color},style(){try{let e;this.cValue.map(l=>zt(l)).join(",").split(/,/).map(gn);const o=ae.flattenDeep(qi(this.cValue,{dynamicVars:{},staticVars:this.staticVars})).map(l=>({...l,color:We(l.color)}));return this.separateInset?e={filter:zi(o),boxShadow:Po(o,!0)}:e={boxShadow:Po(o)},this.invalid=!1,e}catch(e){console.error("Invalid shadow",e),this.invalid=!0}}},watch:{selected(){this.$emit("subShadowSelected",this.selectedId)}},methods:{getNewSubshadow(){return Bt(this.selected)},onSelectChange(e){this.selectedId=e},getSubshadowLabel(e,t){if(typeof e=="object")return(e==null?void 0:e.name)??this.$t("settings.style.shadows.shadow_id",{value:t});if(typeof e=="string")return e||this.$t("settings.style.shadows.empty_expression")},updateProperty:ae.throttle(function(e,t){this.cValue[this.selectedId][e]=t,e==="inset"&&t===!1&&this.separateInset&&(this.cValue[this.selectedId].spread=0),this.$emit("update:modelValue",this.cValue)},100)}},Nv={class:"shadow-switcher"},jv=["value"],qv={class:"shadow-tweak"},zv={value:"object"},Hv={value:"string"},Wv=["disabled"],Kv=["value","disabled"],Gv=["disabled"],Yv=["disabled"],Xv=["value","disabled"],Jv=["value","disabled"],Zv=["value","disabled"],Qv=["value","disabled"],xv={class:"inset-alert alert warning"},e1={class:"inset-tooltip tooltip"};function t1(e,t,s,o,l,a){var S,T,E,M,O,A,K,C,U,_,R,B,D,z;const d=P("ComponentPreview"),r=P("Select"),h=P("SelectMotion"),c=P("Checkbox"),p=P("ColorInput"),$=P("OpacityInput"),w=P("i18n-t"),y=P("FAIcon"),k=P("Popover");return m(),b("div",{class:W(["ShadowControl label shadow-control",{disabled:e.disabled||!e.present,"-no-preview":e.noPreview,"-compact":e.compact}])},[e.noPreview?V("",!0):(m(),H(d,{key:0,invalid:e.invalid,class:"shadow-preview","shadow-control":!0,shadow:e.selected,"preview-style":e.style,disabled:e.disabled||!e.present,"onUpdate:shadow":t[0]||(t[0]=({axis:L,value:j})=>e.updateProperty(L,j))},null,8,["invalid","shadow","preview-style","disabled"])),n("div",Nv,[u(r,{id:"shadow-list",modelValue:e.selectedId,"onUpdate:modelValue":t[1]||(t[1]=L=>e.selectedId=L),class:"shadow-list",size:"4",disabled:e.disabled||e.shadowsAreNull},{default:f(()=>[(m(!0),b(Y,null,se(e.cValue,(L,j)=>(m(),b("option",{key:j,value:j,class:W({"-active":j===Number(e.selectedId)})},i(e.getSubshadowLabel(L,j)),11,jv))),128))]),_:1},8,["modelValue","disabled"]),u(h,{modelValue:e.cValue,"onUpdate:modelValue":t[2]||(t[2]=L=>e.cValue=L),"selected-id":e.selectedId,"get-add-value":e.getNewSubshadow,disabled:e.disabled,"onUpdate:selectedId":e.onSelectChange},null,8,["modelValue","selected-id","get-add-value","disabled","onUpdate:selectedId"])]),n("div",qv,[u(r,{modelValue:e.selectedType,"onUpdate:modelValue":t[3]||(t[3]=L=>e.selectedType=L),disabled:e.disabled||!e.present},{default:f(()=>[n("option",zv,i(e.$t("settings.style.shadows.raw")),1),n("option",Hv,i(e.$t("settings.style.shadows.expression")),1)]),_:1},8,["modelValue","disabled"]),e.selectedType==="string"?x((m(),b("textarea",{key:0,"onUpdate:modelValue":t[4]||(t[4]=L=>e.selected=L),class:W(["input shadow-expression",{disabled:e.disabled||e.shadowsAreNull}]),disabled:e.disabled||e.shadowsAreNull},null,10,Wv)),[[ie,e.selected]]):e.selectedType==="object"?(m(),b(Y,{key:1},[n("div",{class:W([{disabled:e.disabled||!e.present},"name-control style-control"])},[n("label",{for:"name",class:W(["label",{faint:e.disabled||!e.present}])},i(e.$t("settings.style.shadows.name")),3),n("input",{id:"name",value:(S=e.selected)==null?void 0:S.name,disabled:e.disabled||!e.present,class:W([{disabled:e.disabled||!e.present},"input input-string"]),name:"name",onInput:t[5]||(t[5]=L=>e.updateProperty("name",L.target.value))},null,42,Kv)],2),n("div",{disabled:e.disabled||!e.present,class:"inset-control style-control"},[u(c,{id:"inset",value:(T=e.selected)==null?void 0:T.inset,disabled:e.disabled||!e.present,name:"inset",class:"input-inset input-boolean",onInput:t[6]||(t[6]=L=>e.updateProperty("inset",L.target.checked))},{before:f(()=>[v(i(e.$t("settings.style.shadows.inset")),1)]),_:1},8,["value","disabled"])],8,Gv),n("div",{disabled:e.disabled||!e.present,class:W([{disabled:e.disabled||!e.present},"blur-control style-control"])},[n("label",{for:"blur",class:W(["label",{faint:e.disabled||!e.present}])},i(e.$t("settings.style.shadows.blur")),3),n("input",{id:"blur",value:(E=e.selected)==null?void 0:E.blur,disabled:e.disabled||!e.present,class:W([{disabled:e.disabled||!e.present},"input input-range"]),name:"blur",type:"range",max:"20",min:"0",onInput:t[7]||(t[7]=L=>e.updateProperty("blur",L.target.value))},null,42,Xv),n("input",{value:(M=e.selected)==null?void 0:M.blur,class:W(["input input-number -small",{disabled:e.disabled||!e.present}]),disabled:e.disabled||!e.present,type:"number",min:"0",onInput:t[8]||(t[8]=L=>e.updateProperty("blur",L.target.value))},null,42,Jv)],10,Yv),n("div",{class:W(["spread-control style-control",{disabled:e.disabled||!e.present||e.separateInset&&!((O=e.selected)!=null&&O.inset)}])},[n("label",{for:"spread",class:W(["label",{faint:e.disabled||!e.present||e.separateInset&&!((A=e.selected)!=null&&A.inset)}])},i(e.$t("settings.style.shadows.spread")),3),n("input",{id:"spread",value:(K=e.selected)==null?void 0:K.spread,class:W([{disabled:e.disabled||!e.present||e.separateInset&&!((C=e.selected)!=null&&C.inset)},"input input-range"]),disabled:e.disabled||!e.present||e.separateInset&&!((U=e.selected)!=null&&U.inset),name:"spread",type:"range",max:"20",min:"-20",onInput:t[9]||(t[9]=L=>e.updateProperty("spread",L.target.value))},null,42,Zv),n("input",{value:(_=e.selected)==null?void 0:_.spread,class:W(["input input-number -small",{disabled:e.disabled||!e.present||e.separateInset&&!((R=e.selected)!=null&&R.inset)}]),disabled:e.disabled||!e.present||e.separateInset&&!((B=e.selected)!=null&&B.inset),type:"number",onInput:t[10]||(t[10]=L=>e.updateProperty("spread",L.target.value))},null,42,Qv)],2),u(p,{"model-value":(D=e.selected)==null?void 0:D.color,disabled:e.disabled||!e.present,label:e.$t("settings.style.common.color"),fallback:e.getColorFallback,"show-optional-checkbox":!1,name:"shadow","onUpdate:modelValue":t[11]||(t[11]=L=>e.updateProperty("color",L))},null,8,["model-value","disabled","label","fallback"]),u($,{"model-value":(z=e.selected)==null?void 0:z.alpha,disabled:e.disabled||!e.present,"onUpdate:modelValue":t[12]||(t[12]=L=>e.updateProperty("alpha",L))},null,8,["model-value","disabled"]),u(w,{scope:"global",keypath:"settings.style.shadows.hintV3",class:W({faint:e.disabled||!e.present}),tag:"p"},{default:f(()=>t[13]||(t[13]=[n("code",null,"--variable,mod",-1)])),_:1},8,["class"]),e.separateInset?(m(),H(k,{key:0,trigger:"hover"},{trigger:f(()=>[n("div",xv,[u(y,{icon:"exclamation-triangle"}),v("   "+i(e.$t("settings.style.shadows.filter_hint.avatar_inset_short")),1)])]),content:f(()=>[n("div",e1,[u(w,{scope:"global",keypath:"settings.style.shadows.filter_hint.always_drop_shadow",tag:"p"},{default:f(()=>t[14]||(t[14]=[n("code",null,"filter: drop-shadow()",-1)])),_:1}),n("p",null,i(e.$t("settings.style.shadows.filter_hint.avatar_inset")),1),u(w,{scope:"global",keypath:"settings.style.shadows.filter_hint.drop_shadow_syntax",tag:"p"},{default:f(()=>t[15]||(t[15]=[n("code",null,"drop-shadow",-1),n("code",null,"spread-radius",-1),n("code",null,"inset",-1)])),_:1}),u(w,{scope:"global",keypath:"settings.style.shadows.filter_hint.inset_classic",tag:"p"},{default:f(()=>t[16]||(t[16]=[n("code",null,"box-shadow",-1)])),_:1}),n("p",null,i(e.$t("settings.style.shadows.filter_hint.spread_zero")),1)])]),_:1})):V("",!0)],64)):V("",!0)])],2)}const Bn=X(Dv,[["render",t1]]),s1={class:"tooltip"},Za={__name:"tooltip",props:["text"],setup(e){const t=e;return(s,o)=>(m(),H(Gt,{trigger:"hover"},{trigger:f(()=>[Le(s.$slots,"default")]),content:f(()=>[n("div",s1,i(t.text),1)]),_:3}))}};ue.add(Ki,Sa,Gi);const n1={components:{Tooltip:Za},props:{large:{required:!1,type:Boolean,default:!1},contrast:{required:!1,type:Object,default:()=>({})},showRatio:{required:!1,type:Boolean,default:!1}},computed:{hint(){const e=this.contrast.aaa?"aaa":this.contrast.aa?"aa":"bad",t=this.$t(`settings.style.common.contrast.level.${e}`),s=this.$t("settings.style.common.contrast.context.text"),o=this.contrast.text;return this.$t("settings.style.common.contrast.hint",{level:t,context:s,ratio:o})},hint_18pt(){const e=this.contrast.laaa?"aaa":this.contrast.laa?"aa":"bad",t=this.$t(`settings.style.common.contrast.level.${e}`),s=this.$t("settings.style.common.contrast.context.18pt"),o=this.contrast.text;return this.$t("settings.style.common.contrast.hint",{level:t,context:s,ratio:o})}}},o1={key:0,class:"contrast-ratio"},l1={key:0},a1={key:0},i1={key:1},r1={key:2},d1={key:0},u1={key:1},c1={key:2};function h1(e,t,s,o,l,a){const d=P("FAIcon"),r=P("Tooltip");return s.contrast?(m(),b("span",o1,[s.showRatio?(m(),b("span",l1,i(s.contrast.text),1)):V("",!0),u(r,{text:a.hint,class:"rating"},{default:f(()=>[s.contrast.aaa?(m(),b("span",a1,[u(d,{icon:"thumbs-up",size:s.showRatio?"lg":""},null,8,["size"])])):V("",!0),!s.contrast.aaa&&s.contrast.aa?(m(),b("span",i1,[u(d,{icon:"adjust",size:s.showRatio?"lg":""},null,8,["size"])])):V("",!0),!s.contrast.aaa&&!s.contrast.aa?(m(),b("span",r1,[u(d,{icon:"exclamation-triangle",size:s.showRatio?"lg":""},null,8,["size"])])):V("",!0)]),_:1},8,["text"]),s.contrast&&s.large?(m(),H(r,{key:1,text:a.hint_18pt,class:"rating"},{default:f(()=>[s.contrast.laaa?(m(),b("span",d1,[u(d,{icon:"thumbs-up",size:s.showRatio?"large":""},null,8,["size"])])):V("",!0),!s.contrast.laaa&&s.contrast.laa?(m(),b("span",u1,[u(d,{icon:"adjust",size:s.showRatio?"lg":""},null,8,["size"])])):V("",!0),!s.contrast.laaa&&!s.contrast.laa?(m(),b("span",c1,[u(d,{icon:"exclamation-triangle",size:s.showRatio?"lg":""},null,8,["size"])])):V("",!0)]),_:1},8,["text"])):V("",!0)])):V("",!0)}const Qa=X(n1,[["render",h1]]),p1=["bg","fg","text","link","cRed","cGreen","cBlue","cOrange"].map(e=>e+"ColorLocal"),m1=e=>e.startsWith("--")||e==="transparent"?e:Ft(e),f1={data(){return{themeV3Preview:[],themeImporter:kt({validator:this.importValidator,onImport:this.onImport,onImportFailure:this.onImportFailure}),themeExporter:Yt({filename:"pleroma_theme",getExportedObject:()=>this.exportedTheme}),availableStyles:[],selected:"",selectedTheme:this.$store.getters.mergedConfig.theme,themeWarning:void 0,tempImportFile:void 0,engineVersion:0,previewTheme:{},shadowsInvalid:!0,colorsInvalid:!0,radiiInvalid:!0,keepColor:!1,keepShadows:!1,keepOpacity:!1,keepRoundness:!1,keepFonts:!1,...Object.keys(_t).map(e=>[e,""]).reduce((e,[t,s])=>({...e,[t+"ColorLocal"]:s}),{}),...Object.keys(Io).map(e=>[e,""]).reduce((e,[t,s])=>({...e,[t+"OpacityLocal"]:s}),{}),shadowSelected:void 0,shadowsLocal:{},fontsLocal:{},btnRadiusLocal:"",inputRadiusLocal:"",checkboxRadiusLocal:"",panelRadiusLocal:"",avatarRadiusLocal:"",avatarAltRadiusLocal:"",attachmentRadiusLocal:"",tooltipRadiusLocal:"",chatMessageRadiusLocal:""}},created(){const e=this.$store.state.instance.themesIndex;let t;e?t=Promise.resolve(e):t=Q().fetchThemesIndex(),t.then(s=>{Object.values(s).forEach(o=>{o().then(l=>l&&this.availableStyles.push(l))})})},mounted(){typeof this.shadowSelected>"u"&&(this.shadowSelected=this.shadowsAvailable[0])},computed:{themeWarningHelp(){if(!this.themeWarning)return;const e=this.$t,t="settings.style.switcher.help.",{origin:s,themeEngineVersion:o,type:l,noActionsPossible:a}=this.themeWarning;if(s==="file"){if(o===2&&l==="wrong_version")return e(t+"v2_imported");if(o>Ve||o<Ve)return e(t+"future_version_imported")+" "+e(a?t+"snapshot_missing":t+"snapshot_present")}else if(s==="localStorage"){if(l==="snapshot_source_mismatch")return e(t+"snapshot_source_mismatch");if(o===2)return e(t+"upgraded_from_v2");if(o>Ve)return e(t+"fe_downgraded")+" "+e(a?t+"migration_snapshot_ok":t+"migration_snapshot_gone");if(o<Ve)return e(t+"fe_upgraded")+" "+e(a?t+"migration_snapshot_ok":t+"migration_snapshot_gone")}},selectedVersion(){return Array.isArray(this.selectedTheme)?1:2},currentColors(){return Object.keys(_t).map(e=>[e,this[e+"ColorLocal"]]).reduce((e,[t,s])=>({...e,[t]:s}),{})},currentOpacity(){return Object.keys(Io).map(e=>[e,this[e+"OpacityLocal"]]).reduce((e,[t,s])=>({...e,[t]:s}),{})},currentRadii(){return{btn:this.btnRadiusLocal,input:this.inputRadiusLocal,checkbox:this.checkboxRadiusLocal,panel:this.panelRadiusLocal,avatar:this.avatarRadiusLocal,avatarAlt:this.avatarAltRadiusLocal,tooltip:this.tooltipRadiusLocal,attachment:this.attachmentRadiusLocal,chatMessage:this.chatMessageRadiusLocal}},previewContrast(){try{if(!this.previewTheme.colors.bg)return{};const e=this.previewTheme.colors,t=this.previewTheme.opacity;if(!e.bg)return{};const s=a=>({text:a.toPrecision(3)+":1",aa:a>=4.5,aaa:a>=7,laa:a>=3,laaa:a>=4.5}),o=Object.entries(e).reduce((a,[d,r])=>({...a,[d]:m1(r)}),{}),l=Object.entries(_t).reduce((a,[d,r])=>{const h=d==="text"||d==="link";if(!(h||typeof r=="object"&&r!==null&&r.textColor))return a;const{layer:p,variant:$}=h?{layer:"bg"}:r,w=$||p,y=sr(w),k=[d,...w==="bg"?["cRed","cGreen","cBlue","cOrange"]:[]],S=nr(p,$||p,y,o,t);return S.flat().some(T=>T==null)?a:{...a,...k.reduce((T,E)=>{const M=h?"bg"+E[0].toUpperCase()+E.slice(1):E;return{...T,[M]:or(o[E],S,o[E])}},{})}},{});return Object.entries(l).reduce((a,[d,r])=>(a[d]=s(r),a),{})}catch(e){return console.warn("Failure computing contrasts",e),{}}},themeDataUsed(){return Q().themeDataUsed},shadowsAvailable(){return Object.keys(tr).sort()},currentShadowOverriden:{get(){return!!this.currentShadow},set(e){e?this.shadowsLocal[this.shadowSelected]=(this.currentShadowFallback||[]).map(t=>({name:null,x:0,y:0,blur:0,spread:0,inset:!1,color:"#000000",alpha:1,...t})):delete this.shadowsLocal[this.shadowSelected]}},currentShadowFallback(){return(this.previewTheme.shadows||{})[this.shadowSelected]},currentShadow:{get(){return this.shadowsLocal[this.shadowSelected]},set(e){this.shadowsLocal[this.shadowSelected]=e}},themeValid(){return!this.shadowsInvalid&&!this.colorsInvalid&&!this.radiiInvalid},exportedTheme(){const e=!this.keepFonts&&!this.keepShadows&&!this.keepOpacity&&!this.keepRoundness&&!this.keepColor,t={themeEngineVersion:Ve};return(this.keepFonts||e)&&(t.fonts=this.fontsLocal),(this.keepShadows||e)&&(t.shadows=this.shadowsLocal),(this.keepOpacity||e)&&(t.opacity=this.currentOpacity),(this.keepColor||e)&&(t.colors=this.currentColors),(this.keepRoundness||e)&&(t.radii=this.currentRadii),{_pleroma_theme_version:2,theme:{themeEngineVersion:Ve,...this.previewTheme},source:t}},isActive(){const e=this.$parent;return e?e.isActive("theme"):!1}},components:{ColorInput:rt,OpacityInput:Un,RangeInput:fv,ContrastRatio:Qa,ShadowControl:Bn,FontControl:Xa,TabSwitcher:Kt,Preview:On,Checkbox:pe,Select:qe},methods:{loadTheme({theme:e,source:t,_pleroma_theme_version:s},o,l=!1){this.dismissWarning();const a=o==="localStorage"&&!e.colors?"l1":s,d=(e||{}).themeEngineVersion,r=(t||{}).themeEngineVersion||2,h=r===Ve,c=e!==void 0&&t!==void 0&&r!==d,p=t&&l||!e;!(h&&!c)&&!p&&a!=="l1"&&o!=="defaults"&&(c&&o==="localStorage"?this.themeWarning={origin:o,themeEngineVersion:r,type:"snapshot_source_mismatch"}:e?h||(this.themeWarning={origin:o,noActionsPossible:!t,themeEngineVersion:r,type:"wrong_version"}):this.themeWarning={origin:o,noActionsPossible:!0,themeEngineVersion:r,type:"no_snapshot_old_version"}),this.normalizeLocalState(e,a,t,p)},forceLoadLocalStorage(){this.loadThemeFromLocalStorage(!0)},dismissWarning(){this.themeWarning=void 0,this.tempImportFile=void 0},forceLoad(){const{origin:e}=this.themeWarning;switch(e){case"localStorage":this.loadThemeFromLocalStorage(!0);break;case"file":this.onImport(this.tempImportFile,!0);break}this.dismissWarning()},forceSnapshot(){const{origin:e}=this.themeWarning;switch(e){case"localStorage":this.loadThemeFromLocalStorage(!1,!0);break;case"file":console.error("Forcing snapshot from file is not supported yet");break}this.dismissWarning()},loadThemeFromLocalStorage(e=!1){var s;const t=(s=this.themeDataUsed)==null?void 0:s.source;t&&this.loadTheme({theme:t},"localStorage",e)},setCustomTheme(){Q().setThemeV2({customTheme:{ignore:!0,themeFileVersion:this.selectedVersion,themeEngineVersion:Ve,...this.previewTheme},customThemeSource:{themeFileVersion:this.selectedVersion,themeEngineVersion:Ve,shadows:this.shadowsLocal,fonts:this.fontsLocal,opacity:this.currentOpacity,colors:this.currentColors,radii:this.currentRadii}})},updatePreviewColors(){const e=er({opacity:this.currentOpacity,colors:this.currentColors});this.previewTheme.colors=e.theme.colors,this.previewTheme.opacity=e.theme.opacity},updatePreviewShadows(){this.previewTheme.shadows=Qi({shadows:this.shadowsLocal,opacity:this.previewTheme.opacity,themeEngineVersion:this.engineVersion},this.previewTheme.colors,xi(this.previewTheme.colors.bg)<.5?1:-1).theme.shadows},importTheme(){this.themeImporter.importData()},exportTheme(){this.themeExporter.exportData()},onImport(e,t=!1){this.tempImportFile=e,this.loadTheme(e,"file",t)},onImportFailure(){Q().pushGlobalNotice({messageKey:"settings.invalid_theme_imported",level:"error"})},importValidator(e){const t=e._pleroma_theme_version;return t>=1||t<=2},clearAll(){this.loadThemeFromLocalStorage()},clearV1(){Object.keys(this.$data).filter(e=>e.endsWith("ColorLocal")||e.endsWith("OpacityLocal")).filter(e=>!p1.includes(e)).forEach(e=>{this.$data[e]=void 0})},clearRoundness(){Object.keys(this.$data).filter(e=>e.endsWith("RadiusLocal")).forEach(e=>{this.$data[e]=void 0})},clearOpacity(){Object.keys(this.$data).filter(e=>e.endsWith("OpacityLocal")).forEach(e=>{this.$data[e]=void 0})},clearShadows(){this.shadowsLocal={}},clearFonts(){this.fontsLocal={}},normalizeLocalState(e,t=0,s,o=!1){let l;typeof s<"u"&&(o||(s==null?void 0:s.themeEngineVersion)===Ve)?(l=s,t=s.themeEngineVersion):l=e;const a=l.radii||l,d=l.opacity,r=l.shadows||{},h=l.fonts||{},c=l.themeEngineVersion?l.colors||l:Ji(l.colors||l);if(t===0&&(l.version&&(t=l.version),typeof c.text>"u"&&typeof c.fg<"u"&&(t=1),typeof c.text<"u"&&typeof c.fg<"u"&&(t=2)),this.engineVersion=t,t===1&&(this.fgColorLocal=We(c.btn),this.textColorLocal=We(c.fg)),!this.keepColor){this.clearV1();const p=new Set(t!==1?Object.keys(_t):[]);(t===1||t==="l1")&&p.add("bg").add("link").add("cRed").add("cBlue").add("cGreen").add("cOrange"),p.forEach($=>{const w=c[$],y=We(c[$]);this[$+"ColorLocal"]=y==="#aN"?w:y})}d&&!this.keepOpacity&&(this.clearOpacity(),Object.entries(d).forEach(([p,$])=>{typeof $>"u"||$===null||Number.isNaN($)||(this[p+"OpacityLocal"]=$)})),this.keepRoundness||(this.clearRoundness(),Object.entries(a).forEach(([p,$])=>{const w=p.endsWith("Radius")?p.split("Radius")[0]:p;this[w+"RadiusLocal"]=$})),this.keepShadows||(this.clearShadows(),t===2?this.shadowsLocal=Zi(r,this.previewTheme.opacity):this.shadowsLocal=r,this.updatePreviewColors(),this.updatePreviewShadows(),this.shadowSelected=this.shadowsAvailable[0]),this.keepFonts||(this.clearFonts(),this.fontsLocal=h)},updateTheme3Preview(){const e=Pa(this.previewTheme),t=bt({inputRuleset:e,ultimateBackgroundColor:"#000000",liteMode:!0});this.themeV3Preview=fn(Dt(t.eager),"#theme-preview").join(`
`)}},watch:{themeDataUsed(){this.loadThemeFromLocalStorage()},currentRadii(){try{this.previewTheme.radii=Xi({radii:this.currentRadii}).theme.radii,this.radiiInvalid=!1}catch(e){this.radiiInvalid=!0,console.warn(e)}},shadowsLocal:{handler(){try{this.updatePreviewShadows(),this.shadowsInvalid=!1}catch(e){this.shadowsInvalid=!0,console.warn(e)}},deep:!0},fontsLocal:{handler(){try{this.previewTheme.fonts=Yi({fonts:this.fontsLocal}).theme.fonts,this.fontsInvalid=!1}catch(e){this.fontsInvalid=!0,console.warn(e)}},deep:!0},currentColors(){try{this.updatePreviewColors(),this.colorsInvalid=!1}catch(e){this.colorsInvalid=!0,console.warn(e)}},currentOpacity(){try{this.updatePreviewColors()}catch(e){console.warn(e)}},selected(){this.selectedTheme=Object.entries(this.availableStyles).find(([,e])=>Array.isArray(e)?e[0]===this.selected:e.name===this.selected)[1]},selectedTheme(){this.dismissWarning(),this.selectedVersion===1?(this.keepRoundness||this.clearRoundness(),this.keepShadows||this.clearShadows(),this.keepOpacity||this.clearOpacity(),this.keepColor||(this.clearV1(),this.bgColorLocal=this.selectedTheme[1],this.fgColorLocal=this.selectedTheme[2],this.textColorLocal=this.selectedTheme[3],this.linkColorLocal=this.selectedTheme[4],this.cRedColorLocal=this.selectedTheme[5],this.cGreenColorLocal=this.selectedTheme[6],this.cBlueColorLocal=this.selectedTheme[7],this.cOrangeColorLocal=this.selectedTheme[8])):this.selectedVersion>=2&&this.normalizeLocalState(this.selectedTheme.theme,2,this.selectedTheme.source)}}},g1={class:"theme-tab"},b1={class:"alert warning deprecation-warning"},v1={class:"presets-container"},$1={class:"save-load"},y1={key:0,class:"theme-warning"},w1={class:"alert warning"},k1={class:"buttons"},C1={class:"top"},T1={class:"presets"},V1={for:"preset-switcher",class:"select"},S1=["value"],P1={class:"export-import"},I1={class:"save-load-options"},E1={class:"keep-option"},A1={class:"keep-option"},_1={class:"keep-option"},L1={class:"keep-option"},O1={class:"keep-option"},U1=["label"],R1={class:"tab-header"},B1={class:"tab-header-buttons"},M1={class:"color-item"},F1={class:"color-item"},D1={class:"color-item"},N1={class:"color-item"},j1=["label"],q1={class:"tab-header"},z1={class:"color-item"},H1={class:"color-item"},W1={class:"color-item"},K1={class:"color-item"},G1={class:"color-item"},Y1={class:"color-item"},X1={class:"color-item"},J1={class:"color-item"},Z1={class:"color-item"},Q1={class:"color-item"},x1={class:"color-item"},e$={class:"color-item"},t$={class:"color-item"},s$={class:"color-item"},n$={class:"color-item"},o$={class:"color-item"},l$={class:"color-item"},a$={class:"color-item"},i$=["label"],r$={class:"tab-header"},d$=["label"],u$={class:"tab-header shadow-selector"},c$={class:"select-container"},h$=["value"],p$={class:"override"},m$=["label"],f$={class:"tab-header"},g$={class:"apply-container"},b$=["disabled"];function v$(e,t,s,o,l,a){const d=P("Select"),r=P("Checkbox"),h=P("preview"),c=P("ColorInput"),p=P("OpacityInput"),$=P("ContrastRatio"),w=P("RangeInput"),y=P("ShadowControl"),k=P("FontControl"),S=P("tab-switcher");return m(),b("div",g1,[n("div",b1,i(e.$t("settings.style.themes2_outdated")),1),n("div",v1,[n("div",$1,[e.themeWarning?(m(),b("div",y1,[n("div",w1,i(e.themeWarningHelp),1),n("div",k1,[e.themeWarning.type==="snapshot_source_mismatch"?(m(),b(Y,{key:0},[n("button",{class:"btn button-default",onClick:t[0]||(t[0]=(...T)=>e.forceLoad&&e.forceLoad(...T))},i(e.$t("settings.style.switcher.use_source")),1),n("button",{class:"btn button-default",onClick:t[1]||(t[1]=(...T)=>e.forceSnapshot&&e.forceSnapshot(...T))},i(e.$t("settings.style.switcher.use_snapshot")),1)],64)):e.themeWarning.noActionsPossible?(m(),b("button",{key:1,class:"btn button-default",onClick:t[2]||(t[2]=(...T)=>e.dismissWarning&&e.dismissWarning(...T))},i(e.$t("general.dismiss")),1)):(m(),b(Y,{key:2},[n("button",{class:"btn button-default",onClick:t[3]||(t[3]=(...T)=>e.forceLoad&&e.forceLoad(...T))},i(e.$t("settings.style.switcher.load_theme")),1),n("button",{class:"btn button-default",onClick:t[4]||(t[4]=(...T)=>e.dismissWarning&&e.dismissWarning(...T))},i(e.$t("settings.style.switcher.keep_as_is")),1)],64))])])):V("",!0),n("div",C1,[n("div",T1,[v(i(e.$t("settings.presets"))+" ",1),n("label",V1,[u(d,{id:"preset-switcher",modelValue:e.selected,"onUpdate:modelValue":t[5]||(t[5]=T=>e.selected=T),class:"preset-switcher"},{default:f(()=>[(m(!0),b(Y,null,se(e.availableStyles,T=>(m(),b("option",{key:T.name,value:T.name||T[0],style:Oe({backgroundColor:T[1]||(T.theme||T.source).colors.bg,color:T[3]||(T.theme||T.source).colors.text})},i(T[0]||T.name),13,S1))),128))]),_:1},8,["modelValue"])])]),n("div",P1,[n("button",{class:"btn button-default",onClick:t[6]||(t[6]=(...T)=>e.importTheme&&e.importTheme(...T))},i(e.$t("settings.import_theme")),1),n("button",{class:"btn button-default",onClick:t[7]||(t[7]=(...T)=>e.exportTheme&&e.exportTheme(...T))},i(e.$t("settings.export_theme")),1)])])]),n("div",I1,[n("span",E1,[u(r,{modelValue:e.keepColor,"onUpdate:modelValue":t[8]||(t[8]=T=>e.keepColor=T)},{default:f(()=>[v(i(e.$t("settings.style.switcher.keep_color")),1)]),_:1},8,["modelValue"])]),n("span",A1,[u(r,{modelValue:e.keepShadows,"onUpdate:modelValue":t[9]||(t[9]=T=>e.keepShadows=T)},{default:f(()=>[v(i(e.$t("settings.style.switcher.keep_shadows")),1)]),_:1},8,["modelValue"])]),n("span",_1,[u(r,{modelValue:e.keepOpacity,"onUpdate:modelValue":t[10]||(t[10]=T=>e.keepOpacity=T)},{default:f(()=>[v(i(e.$t("settings.style.switcher.keep_opacity")),1)]),_:1},8,["modelValue"])]),n("span",L1,[u(r,{modelValue:e.keepRoundness,"onUpdate:modelValue":t[11]||(t[11]=T=>e.keepRoundness=T)},{default:f(()=>[v(i(e.$t("settings.style.switcher.keep_roundness")),1)]),_:1},8,["modelValue"])]),n("span",O1,[u(r,{modelValue:e.keepFonts,"onUpdate:modelValue":t[12]||(t[12]=T=>e.keepFonts=T)},{default:f(()=>[v(i(e.$t("settings.style.switcher.keep_fonts")),1)]),_:1},8,["modelValue"])]),n("p",null,i(e.$t("settings.style.switcher.save_load_hint")),1)])]),(m(),H(lt("style"),{innerHTML:e.themeV3Preview},null,8,["innerHTML"])),u(h,{id:"theme-preview"}),n("div",null,[n("button",{class:"btn button-default",onClick:t[13]||(t[13]=(...T)=>e.updateTheme3Preview&&e.updateTheme3Preview(...T))},i(e.$t("settings.style.update_preview")),1)]),(m(),H(lr,null,[u(S,{key:"style-tweak"},{default:f(()=>{var T,E,M,O,A,K,C,U,_,R,B,D,z,L,j,ce,$e,Je,ye,Ze,Re,Pe,Ie,Be,He,Me,we,he,re,be,me,dt,Qe,xe,I,F,q,N,G,ne,te,ee,Ee,Te,ve,fe,Ae,ke,et,Tt,Vt,St,Pt,Mn,Fn,Dn,Nn,jn,qn,zn,Hn,Wn,Kn,Gn,Yn,Xn,Jn,Zn,Qn,xn,eo,to,so,no,oo,lo,ao,io,ro,uo,co,ho,po,mo,fo,go,bo,vo,$o,yo,wo,ko,Co;return[n("div",{label:e.$t("settings.style.common_colors._tab_label"),class:"color-container"},[n("div",R1,[n("p",null,i(e.$t("settings.theme_help")),1),n("div",B1,[n("button",{class:"btn button-default",onClick:t[14]||(t[14]=(...g)=>e.clearOpacity&&e.clearOpacity(...g))},i(e.$t("settings.style.switcher.clear_opacity")),1),n("button",{class:"btn button-default",onClick:t[15]||(t[15]=(...g)=>e.clearV1&&e.clearV1(...g))},i(e.$t("settings.style.switcher.clear_all")),1)])]),n("p",null,i(e.$t("settings.theme_help_v2_1")),1),n("h4",null,i(e.$t("settings.style.common_colors.main")),1),n("div",M1,[u(c,{modelValue:e.bgColorLocal,"onUpdate:modelValue":t[16]||(t[16]=g=>e.bgColorLocal=g),name:"bgColor",label:e.$t("settings.background")},null,8,["modelValue","label"]),u(p,{modelValue:e.bgOpacityLocal,"onUpdate:modelValue":t[17]||(t[17]=g=>e.bgOpacityLocal=g),name:"bgOpacity",fallback:(T=e.previewTheme.opacity)==null?void 0:T.bg},null,8,["modelValue","fallback"]),u(c,{modelValue:e.textColorLocal,"onUpdate:modelValue":t[18]||(t[18]=g=>e.textColorLocal=g),name:"textColor",label:e.$t("settings.text")},null,8,["modelValue","label"]),u($,{contrast:e.previewContrast.bgText},null,8,["contrast"]),u(c,{modelValue:e.accentColorLocal,"onUpdate:modelValue":t[19]||(t[19]=g=>e.accentColorLocal=g),name:"accentColor",fallback:(E=e.previewTheme.colors)==null?void 0:E.link,label:e.$t("settings.accent"),"show-optional-checkbox":typeof e.linkColorLocal<"u"},null,8,["modelValue","fallback","label","show-optional-checkbox"]),u(c,{modelValue:e.linkColorLocal,"onUpdate:modelValue":t[20]||(t[20]=g=>e.linkColorLocal=g),name:"linkColor",fallback:(M=e.previewTheme.colors)==null?void 0:M.accent,label:e.$t("settings.links"),"show-optional-checkbox":typeof e.accentColorLocal<"u"},null,8,["modelValue","fallback","label","show-optional-checkbox"]),u($,{contrast:e.previewContrast.bgLink},null,8,["contrast"])]),n("div",F1,[u(c,{modelValue:e.fgColorLocal,"onUpdate:modelValue":t[21]||(t[21]=g=>e.fgColorLocal=g),name:"fgColor",label:e.$t("settings.foreground")},null,8,["modelValue","label"]),u(c,{modelValue:e.fgTextColorLocal,"onUpdate:modelValue":t[22]||(t[22]=g=>e.fgTextColorLocal=g),name:"fgTextColor",label:e.$t("settings.text"),fallback:(O=e.previewTheme.colors)==null?void 0:O.fgText},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.fgLinkColorLocal,"onUpdate:modelValue":t[23]||(t[23]=g=>e.fgLinkColorLocal=g),name:"fgLinkColor",label:e.$t("settings.links"),fallback:(A=e.previewTheme.colors)==null?void 0:A.fgLink},null,8,["modelValue","label","fallback"]),n("p",null,i(e.$t("settings.style.common_colors.foreground_hint")),1)]),n("h4",null,i(e.$t("settings.style.common_colors.rgbo")),1),n("div",D1,[u(c,{modelValue:e.cRedColorLocal,"onUpdate:modelValue":t[24]||(t[24]=g=>e.cRedColorLocal=g),name:"cRedColor",label:e.$t("settings.cRed")},null,8,["modelValue","label"]),u($,{contrast:e.previewContrast.bgCRed},null,8,["contrast"]),u(c,{modelValue:e.cBlueColorLocal,"onUpdate:modelValue":t[25]||(t[25]=g=>e.cBlueColorLocal=g),name:"cBlueColor",label:e.$t("settings.cBlue")},null,8,["modelValue","label"]),u($,{contrast:e.previewContrast.bgCBlue},null,8,["contrast"])]),n("div",N1,[u(c,{modelValue:e.cGreenColorLocal,"onUpdate:modelValue":t[26]||(t[26]=g=>e.cGreenColorLocal=g),name:"cGreenColor",label:e.$t("settings.cGreen")},null,8,["modelValue","label"]),u($,{contrast:e.previewContrast.bgCGreen},null,8,["contrast"]),u(c,{modelValue:e.cOrangeColorLocal,"onUpdate:modelValue":t[27]||(t[27]=g=>e.cOrangeColorLocal=g),name:"cOrangeColor",label:e.$t("settings.cOrange")},null,8,["modelValue","label"]),u($,{contrast:e.previewContrast.bgCOrange},null,8,["contrast"])]),n("p",null,i(e.$t("settings.theme_help_v2_2")),1)],8,U1),n("div",{label:e.$t("settings.style.advanced_colors._tab_label"),class:"color-container"},[n("div",q1,[n("p",null,i(e.$t("settings.theme_help")),1),n("button",{class:"btn button-default",onClick:t[28]||(t[28]=(...g)=>e.clearOpacity&&e.clearOpacity(...g))},i(e.$t("settings.style.switcher.clear_opacity")),1),n("button",{class:"btn button-default",onClick:t[29]||(t[29]=(...g)=>e.clearV1&&e.clearV1(...g))},i(e.$t("settings.style.switcher.clear_all")),1)]),n("div",z1,[n("h4",null,i(e.$t("settings.style.advanced_colors.post")),1),u(c,{modelValue:e.postLinkColorLocal,"onUpdate:modelValue":t[30]||(t[30]=g=>e.postLinkColorLocal=g),name:"postLinkColor",fallback:(K=e.previewTheme.colors)==null?void 0:K.accent,label:e.$t("settings.links")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.postLink},null,8,["contrast"]),u(c,{modelValue:e.postGreentextColorLocal,"onUpdate:modelValue":t[31]||(t[31]=g=>e.postGreentextColorLocal=g),name:"postGreentextColor",fallback:(C=e.previewTheme.colors)==null?void 0:C.cGreen,label:e.$t("settings.greentext")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.postGreentext},null,8,["contrast"]),n("h4",null,i(e.$t("settings.style.advanced_colors.alert")),1),u(c,{modelValue:e.alertErrorColorLocal,"onUpdate:modelValue":t[32]||(t[32]=g=>e.alertErrorColorLocal=g),name:"alertError",label:e.$t("settings.style.advanced_colors.alert_error"),fallback:(U=e.previewTheme.colors)==null?void 0:U.alertError},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.alertErrorTextColorLocal,"onUpdate:modelValue":t[33]||(t[33]=g=>e.alertErrorTextColorLocal=g),name:"alertErrorText",label:e.$t("settings.text"),fallback:(_=e.previewTheme.colors)==null?void 0:_.alertErrorText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.alertErrorText,large:""},null,8,["contrast"]),u(c,{modelValue:e.alertWarningColorLocal,"onUpdate:modelValue":t[34]||(t[34]=g=>e.alertWarningColorLocal=g),name:"alertWarning",label:e.$t("settings.style.advanced_colors.alert_warning"),fallback:(R=e.previewTheme.colors)==null?void 0:R.alertWarning},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.alertWarningTextColorLocal,"onUpdate:modelValue":t[35]||(t[35]=g=>e.alertWarningTextColorLocal=g),name:"alertWarningText",label:e.$t("settings.text"),fallback:(B=e.previewTheme.colors)==null?void 0:B.alertWarningText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.alertWarningText,large:""},null,8,["contrast"]),u(c,{modelValue:e.alertNeutralColorLocal,"onUpdate:modelValue":t[36]||(t[36]=g=>e.alertNeutralColorLocal=g),name:"alertNeutral",label:e.$t("settings.style.advanced_colors.alert_neutral"),fallback:(D=e.previewTheme.colors)==null?void 0:D.alertNeutral},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.alertNeutralTextColorLocal,"onUpdate:modelValue":t[37]||(t[37]=g=>e.alertNeutralTextColorLocal=g),name:"alertNeutralText",label:e.$t("settings.text"),fallback:(z=e.previewTheme.colors)==null?void 0:z.alertNeutralText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.alertNeutralText,large:""},null,8,["contrast"]),u(p,{modelValue:e.alertOpacityLocal,"onUpdate:modelValue":t[38]||(t[38]=g=>e.alertOpacityLocal=g),name:"alertOpacity",fallback:(L=e.previewTheme.opacity)==null?void 0:L.alert},null,8,["modelValue","fallback"])]),n("div",H1,[n("h4",null,i(e.$t("settings.style.advanced_colors.badge")),1),u(c,{modelValue:e.badgeNotificationColorLocal,"onUpdate:modelValue":t[39]||(t[39]=g=>e.badgeNotificationColorLocal=g),name:"badgeNotification",label:e.$t("settings.style.advanced_colors.badge_notification"),fallback:(j=e.previewTheme.colors)==null?void 0:j.badgeNotification},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.badgeNotificationTextColorLocal,"onUpdate:modelValue":t[40]||(t[40]=g=>e.badgeNotificationTextColorLocal=g),name:"badgeNotificationText",label:e.$t("settings.text"),fallback:(ce=e.previewTheme.colors)==null?void 0:ce.badgeNotificationText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.badgeNotificationText,large:""},null,8,["contrast"])]),n("div",W1,[n("h4",null,i(e.$t("settings.style.advanced_colors.panel_header")),1),u(c,{modelValue:e.panelColorLocal,"onUpdate:modelValue":t[41]||(t[41]=g=>e.panelColorLocal=g),name:"panelColor",fallback:($e=e.previewTheme.colors)==null?void 0:$e.panel,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(p,{modelValue:e.panelOpacityLocal,"onUpdate:modelValue":t[42]||(t[42]=g=>e.panelOpacityLocal=g),name:"panelOpacity",fallback:(Je=e.previewTheme.opacity)==null?void 0:Je.panel,disabled:e.panelColorLocal==="transparent"},null,8,["modelValue","fallback","disabled"]),u(c,{modelValue:e.panelTextColorLocal,"onUpdate:modelValue":t[43]||(t[43]=g=>e.panelTextColorLocal=g),name:"panelTextColor",fallback:(ye=e.previewTheme.colors)==null?void 0:ye.panelText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.panelText,large:""},null,8,["contrast"]),u(c,{modelValue:e.panelLinkColorLocal,"onUpdate:modelValue":t[44]||(t[44]=g=>e.panelLinkColorLocal=g),name:"panelLinkColor",fallback:(Ze=e.previewTheme.colors)==null?void 0:Ze.panelLink,label:e.$t("settings.links")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.panelLink,large:""},null,8,["contrast"])]),n("div",K1,[n("h4",null,i(e.$t("settings.style.advanced_colors.top_bar")),1),u(c,{modelValue:e.topBarColorLocal,"onUpdate:modelValue":t[45]||(t[45]=g=>e.topBarColorLocal=g),name:"topBarColor",fallback:(Re=e.previewTheme.colors)==null?void 0:Re.topBar,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.topBarTextColorLocal,"onUpdate:modelValue":t[46]||(t[46]=g=>e.topBarTextColorLocal=g),name:"topBarTextColor",fallback:(Pe=e.previewTheme.colors)==null?void 0:Pe.topBarText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.topBarText},null,8,["contrast"]),u(c,{modelValue:e.topBarLinkColorLocal,"onUpdate:modelValue":t[47]||(t[47]=g=>e.topBarLinkColorLocal=g),name:"topBarLinkColor",fallback:(Ie=e.previewTheme.colors)==null?void 0:Ie.topBarLink,label:e.$t("settings.links")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.topBarLink},null,8,["contrast"])]),n("div",G1,[n("h4",null,i(e.$t("settings.style.advanced_colors.inputs")),1),u(c,{modelValue:e.inputColorLocal,"onUpdate:modelValue":t[48]||(t[48]=g=>e.inputColorLocal=g),name:"inputColor",fallback:(Be=e.previewTheme.colors)==null?void 0:Be.input,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(p,{modelValue:e.inputOpacityLocal,"onUpdate:modelValue":t[49]||(t[49]=g=>e.inputOpacityLocal=g),name:"inputOpacity",fallback:(He=e.previewTheme.opacity)==null?void 0:He.input,disabled:e.inputColorLocal==="transparent"},null,8,["modelValue","fallback","disabled"]),u(c,{modelValue:e.inputTextColorLocal,"onUpdate:modelValue":t[50]||(t[50]=g=>e.inputTextColorLocal=g),name:"inputTextColor",fallback:(Me=e.previewTheme.colors)==null?void 0:Me.inputText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.inputText},null,8,["contrast"])]),n("div",Y1,[n("h4",null,i(e.$t("settings.style.advanced_colors.buttons")),1),u(c,{modelValue:e.btnColorLocal,"onUpdate:modelValue":t[51]||(t[51]=g=>e.btnColorLocal=g),name:"btnColor",fallback:(we=e.previewTheme.colors)==null?void 0:we.btn,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(p,{modelValue:e.btnOpacityLocal,"onUpdate:modelValue":t[52]||(t[52]=g=>e.btnOpacityLocal=g),name:"btnOpacity",fallback:(he=e.previewTheme.opacity)==null?void 0:he.btn,disabled:e.btnColorLocal==="transparent"},null,8,["modelValue","fallback","disabled"]),u(c,{modelValue:e.btnTextColorLocal,"onUpdate:modelValue":t[53]||(t[53]=g=>e.btnTextColorLocal=g),name:"btnTextColor",fallback:(re=e.previewTheme.colors)==null?void 0:re.btnText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnText},null,8,["contrast"]),u(c,{modelValue:e.btnPanelTextColorLocal,"onUpdate:modelValue":t[54]||(t[54]=g=>e.btnPanelTextColorLocal=g),name:"btnPanelTextColor",fallback:(be=e.previewTheme.colors)==null?void 0:be.btnPanelText,label:e.$t("settings.style.advanced_colors.panel_header")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnPanelText},null,8,["contrast"]),u(c,{modelValue:e.btnTopBarTextColorLocal,"onUpdate:modelValue":t[55]||(t[55]=g=>e.btnTopBarTextColorLocal=g),name:"btnTopBarTextColor",fallback:(me=e.previewTheme.colors)==null?void 0:me.btnTopBarText,label:e.$t("settings.style.advanced_colors.top_bar")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnTopBarText},null,8,["contrast"]),n("h5",null,i(e.$t("settings.style.advanced_colors.pressed")),1),u(c,{modelValue:e.btnPressedColorLocal,"onUpdate:modelValue":t[56]||(t[56]=g=>e.btnPressedColorLocal=g),name:"btnPressedColor",fallback:(dt=e.previewTheme.colors)==null?void 0:dt.btnPressed,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.btnPressedTextColorLocal,"onUpdate:modelValue":t[57]||(t[57]=g=>e.btnPressedTextColorLocal=g),name:"btnPressedTextColor",fallback:(Qe=e.previewTheme.colors)==null?void 0:Qe.btnPressedText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnPressedText},null,8,["contrast"]),u(c,{modelValue:e.btnPressedPanelTextColorLocal,"onUpdate:modelValue":t[58]||(t[58]=g=>e.btnPressedPanelTextColorLocal=g),name:"btnPressedPanelTextColor",fallback:(xe=e.previewTheme.colors)==null?void 0:xe.btnPressedPanelText,label:e.$t("settings.style.advanced_colors.panel_header")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnPressedPanelText},null,8,["contrast"]),u(c,{modelValue:e.btnPressedTopBarTextColorLocal,"onUpdate:modelValue":t[59]||(t[59]=g=>e.btnPressedTopBarTextColorLocal=g),name:"btnPressedTopBarTextColor",fallback:(I=e.previewTheme.colors)==null?void 0:I.btnPressedTopBarText,label:e.$t("settings.style.advanced_colors.top_bar")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnPressedTopBarText},null,8,["contrast"]),n("h5",null,i(e.$t("settings.style.advanced_colors.disabled")),1),u(c,{modelValue:e.btnDisabledColorLocal,"onUpdate:modelValue":t[60]||(t[60]=g=>e.btnDisabledColorLocal=g),name:"btnDisabledColor",fallback:(F=e.previewTheme.colors)==null?void 0:F.btnDisabled,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.btnDisabledTextColorLocal,"onUpdate:modelValue":t[61]||(t[61]=g=>e.btnDisabledTextColorLocal=g),name:"btnDisabledTextColor",fallback:(q=e.previewTheme.colors)==null?void 0:q.btnDisabledText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.btnDisabledPanelTextColorLocal,"onUpdate:modelValue":t[62]||(t[62]=g=>e.btnDisabledPanelTextColorLocal=g),name:"btnDisabledPanelTextColor",fallback:(N=e.previewTheme.colors)==null?void 0:N.btnDisabledPanelText,label:e.$t("settings.style.advanced_colors.panel_header")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.btnDisabledTopBarTextColorLocal,"onUpdate:modelValue":t[63]||(t[63]=g=>e.btnDisabledTopBarTextColorLocal=g),name:"btnDisabledTopBarTextColor",fallback:(G=e.previewTheme.colors)==null?void 0:G.btnDisabledTopBarText,label:e.$t("settings.style.advanced_colors.top_bar")},null,8,["modelValue","fallback","label"]),n("h5",null,i(e.$t("settings.style.advanced_colors.toggled")),1),u(c,{modelValue:e.btnToggledColorLocal,"onUpdate:modelValue":t[64]||(t[64]=g=>e.btnToggledColorLocal=g),name:"btnToggledColor",fallback:(ne=e.previewTheme.colors)==null?void 0:ne.btnToggled,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.btnToggledTextColorLocal,"onUpdate:modelValue":t[65]||(t[65]=g=>e.btnToggledTextColorLocal=g),name:"btnToggledTextColor",fallback:(te=e.previewTheme.colors)==null?void 0:te.btnToggledText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnToggledText},null,8,["contrast"]),u(c,{modelValue:e.btnToggledPanelTextColorLocal,"onUpdate:modelValue":t[66]||(t[66]=g=>e.btnToggledPanelTextColorLocal=g),name:"btnToggledPanelTextColor",fallback:(ee=e.previewTheme.colors)==null?void 0:ee.btnToggledPanelText,label:e.$t("settings.style.advanced_colors.panel_header")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnToggledPanelText},null,8,["contrast"]),u(c,{modelValue:e.btnToggledTopBarTextColorLocal,"onUpdate:modelValue":t[67]||(t[67]=g=>e.btnToggledTopBarTextColorLocal=g),name:"btnToggledTopBarTextColor",fallback:(Ee=e.previewTheme.colors)==null?void 0:Ee.btnToggledTopBarText,label:e.$t("settings.style.advanced_colors.top_bar")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.btnToggledTopBarText},null,8,["contrast"])]),n("div",X1,[n("h4",null,i(e.$t("settings.style.advanced_colors.tabs")),1),u(c,{modelValue:e.tabColorLocal,"onUpdate:modelValue":t[68]||(t[68]=g=>e.tabColorLocal=g),name:"tabColor",fallback:(Te=e.previewTheme.colors)==null?void 0:Te.tab,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.tabTextColorLocal,"onUpdate:modelValue":t[69]||(t[69]=g=>e.tabTextColorLocal=g),name:"tabTextColor",fallback:(ve=e.previewTheme.colors)==null?void 0:ve.tabText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.tabText},null,8,["contrast"]),u(c,{modelValue:e.tabActiveTextColorLocal,"onUpdate:modelValue":t[70]||(t[70]=g=>e.tabActiveTextColorLocal=g),name:"tabActiveTextColor",fallback:(fe=e.previewTheme.colors)==null?void 0:fe.tabActiveText,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u($,{contrast:e.previewContrast.tabActiveText},null,8,["contrast"])]),n("div",J1,[n("h4",null,i(e.$t("settings.style.advanced_colors.borders")),1),u(c,{modelValue:e.borderColorLocal,"onUpdate:modelValue":t[71]||(t[71]=g=>e.borderColorLocal=g),name:"borderColor",fallback:(Ae=e.previewTheme.colors)==null?void 0:Ae.border,label:e.$t("settings.style.common.color")},null,8,["modelValue","fallback","label"]),u(p,{modelValue:e.borderOpacityLocal,"onUpdate:modelValue":t[72]||(t[72]=g=>e.borderOpacityLocal=g),name:"borderOpacity",fallback:(ke=e.previewTheme.opacity)==null?void 0:ke.border,disabled:e.borderColorLocal==="transparent"},null,8,["modelValue","fallback","disabled"])]),n("div",Z1,[n("h4",null,i(e.$t("settings.style.advanced_colors.faint_text")),1),u(c,{modelValue:e.faintColorLocal,"onUpdate:modelValue":t[73]||(t[73]=g=>e.faintColorLocal=g),name:"faintColor",fallback:(et=e.previewTheme.colors)==null?void 0:et.faint,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.faintLinkColorLocal,"onUpdate:modelValue":t[74]||(t[74]=g=>e.faintLinkColorLocal=g),name:"faintLinkColor",fallback:(Tt=e.previewTheme.colors)==null?void 0:Tt.faintLink,label:e.$t("settings.links")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.panelFaintColorLocal,"onUpdate:modelValue":t[75]||(t[75]=g=>e.panelFaintColorLocal=g),name:"panelFaintColor",fallback:(Vt=e.previewTheme.colors)==null?void 0:Vt.panelFaint,label:e.$t("settings.style.advanced_colors.panel_header")},null,8,["modelValue","fallback","label"]),u(p,{modelValue:e.faintOpacityLocal,"onUpdate:modelValue":t[76]||(t[76]=g=>e.faintOpacityLocal=g),name:"faintOpacity",fallback:(St=e.previewTheme.opacity)==null?void 0:St.faint},null,8,["modelValue","fallback"])]),n("div",Q1,[n("h4",null,i(e.$t("settings.style.advanced_colors.underlay")),1),u(c,{modelValue:e.underlayColorLocal,"onUpdate:modelValue":t[77]||(t[77]=g=>e.underlayColorLocal=g),name:"underlay",label:e.$t("settings.style.advanced_colors.underlay"),fallback:(Pt=e.previewTheme.colors)==null?void 0:Pt.underlay},null,8,["modelValue","label","fallback"]),u(p,{modelValue:e.underlayOpacityLocal,"onUpdate:modelValue":t[78]||(t[78]=g=>e.underlayOpacityLocal=g),name:"underlayOpacity",fallback:(Mn=e.previewTheme.opacity)==null?void 0:Mn.underlay,disabled:e.underlayOpacityLocal==="transparent"},null,8,["modelValue","fallback","disabled"])]),n("div",x1,[n("h4",null,i(e.$t("settings.style.advanced_colors.wallpaper")),1),u(c,{modelValue:e.wallpaperColorLocal,"onUpdate:modelValue":t[79]||(t[79]=g=>e.wallpaperColorLocal=g),name:"wallpaper",label:e.$t("settings.style.advanced_colors.wallpaper"),fallback:(Fn=e.previewTheme.colors)==null?void 0:Fn.wallpaper},null,8,["modelValue","label","fallback"])]),n("div",e$,[n("h4",null,i(e.$t("settings.style.advanced_colors.poll")),1),u(c,{modelValue:e.pollColorLocal,"onUpdate:modelValue":t[80]||(t[80]=g=>e.pollColorLocal=g),name:"poll",label:e.$t("settings.background"),fallback:(Dn=e.previewTheme.colors)==null?void 0:Dn.poll},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.pollTextColorLocal,"onUpdate:modelValue":t[81]||(t[81]=g=>e.pollTextColorLocal=g),name:"pollText",label:e.$t("settings.text"),fallback:(Nn=e.previewTheme.colors)==null?void 0:Nn.pollText},null,8,["modelValue","label","fallback"])]),n("div",t$,[n("h4",null,i(e.$t("settings.style.advanced_colors.icons")),1),u(c,{modelValue:e.iconColorLocal,"onUpdate:modelValue":t[82]||(t[82]=g=>e.iconColorLocal=g),name:"icon",label:e.$t("settings.style.advanced_colors.icons"),fallback:(jn=e.previewTheme.colors)==null?void 0:jn.icon},null,8,["modelValue","label","fallback"])]),n("div",s$,[n("h4",null,i(e.$t("settings.style.advanced_colors.highlight")),1),u(c,{modelValue:e.highlightColorLocal,"onUpdate:modelValue":t[83]||(t[83]=g=>e.highlightColorLocal=g),name:"highlight",label:e.$t("settings.background"),fallback:(qn=e.previewTheme.colors)==null?void 0:qn.highlight},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.highlightTextColorLocal,"onUpdate:modelValue":t[84]||(t[84]=g=>e.highlightTextColorLocal=g),name:"highlightText",label:e.$t("settings.text"),fallback:(zn=e.previewTheme.colors)==null?void 0:zn.highlightText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.highlightText},null,8,["contrast"]),u(c,{modelValue:e.highlightLinkColorLocal,"onUpdate:modelValue":t[85]||(t[85]=g=>e.highlightLinkColorLocal=g),name:"highlightLink",label:e.$t("settings.links"),fallback:(Hn=e.previewTheme.colors)==null?void 0:Hn.highlightLink},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.highlightLink},null,8,["contrast"])]),n("div",n$,[n("h4",null,i(e.$t("settings.style.advanced_colors.popover")),1),u(c,{modelValue:e.popoverColorLocal,"onUpdate:modelValue":t[86]||(t[86]=g=>e.popoverColorLocal=g),name:"popover",label:e.$t("settings.background"),fallback:(Wn=e.previewTheme.colors)==null?void 0:Wn.popover},null,8,["modelValue","label","fallback"]),u(p,{modelValue:e.popoverOpacityLocal,"onUpdate:modelValue":t[87]||(t[87]=g=>e.popoverOpacityLocal=g),name:"popoverOpacity",fallback:(Kn=e.previewTheme.opacity)==null?void 0:Kn.popover,disabled:e.popoverOpacityLocal==="transparent"},null,8,["modelValue","fallback","disabled"]),u(c,{modelValue:e.popoverTextColorLocal,"onUpdate:modelValue":t[88]||(t[88]=g=>e.popoverTextColorLocal=g),name:"popoverText",label:e.$t("settings.text"),fallback:(Gn=e.previewTheme.colors)==null?void 0:Gn.popoverText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.popoverText},null,8,["contrast"]),u(c,{modelValue:e.popoverLinkColorLocal,"onUpdate:modelValue":t[89]||(t[89]=g=>e.popoverLinkColorLocal=g),name:"popoverLink",label:e.$t("settings.links"),fallback:(Yn=e.previewTheme.colors)==null?void 0:Yn.popoverLink},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.popoverLink},null,8,["contrast"])]),n("div",o$,[n("h4",null,i(e.$t("settings.style.advanced_colors.selectedPost")),1),u(c,{modelValue:e.selectedPostColorLocal,"onUpdate:modelValue":t[90]||(t[90]=g=>e.selectedPostColorLocal=g),name:"selectedPost",label:e.$t("settings.background"),fallback:(Xn=e.previewTheme.colors)==null?void 0:Xn.selectedPost},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.selectedPostTextColorLocal,"onUpdate:modelValue":t[91]||(t[91]=g=>e.selectedPostTextColorLocal=g),name:"selectedPostText",label:e.$t("settings.text"),fallback:(Jn=e.previewTheme.colors)==null?void 0:Jn.selectedPostText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.selectedPostText},null,8,["contrast"]),u(c,{modelValue:e.selectedPostLinkColorLocal,"onUpdate:modelValue":t[92]||(t[92]=g=>e.selectedPostLinkColorLocal=g),name:"selectedPostLink",label:e.$t("settings.links"),fallback:(Zn=e.previewTheme.colors)==null?void 0:Zn.selectedPostLink},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.selectedPostLink},null,8,["contrast"])]),n("div",l$,[n("h4",null,i(e.$t("settings.style.advanced_colors.selectedMenu")),1),u(c,{modelValue:e.selectedMenuColorLocal,"onUpdate:modelValue":t[93]||(t[93]=g=>e.selectedMenuColorLocal=g),name:"selectedMenu",label:e.$t("settings.background"),fallback:(Qn=e.previewTheme.colors)==null?void 0:Qn.selectedMenu},null,8,["modelValue","label","fallback"]),u(c,{modelValue:e.selectedMenuTextColorLocal,"onUpdate:modelValue":t[94]||(t[94]=g=>e.selectedMenuTextColorLocal=g),name:"selectedMenuText",label:e.$t("settings.text"),fallback:(xn=e.previewTheme.colors)==null?void 0:xn.selectedMenuText},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.selectedMenuText},null,8,["contrast"]),u(c,{modelValue:e.selectedMenuLinkColorLocal,"onUpdate:modelValue":t[95]||(t[95]=g=>e.selectedMenuLinkColorLocal=g),name:"selectedMenuLink",label:e.$t("settings.links"),fallback:(eo=e.previewTheme.colors)==null?void 0:eo.selectedMenuLink},null,8,["modelValue","label","fallback"]),u($,{contrast:e.previewContrast.selectedMenuLink},null,8,["contrast"])]),n("div",a$,[n("h4",null,i(e.$t("chats.chats")),1),u(c,{modelValue:e.chatBgColorLocal,"onUpdate:modelValue":t[96]||(t[96]=g=>e.chatBgColorLocal=g),name:"chatBgColor",fallback:(to=e.previewTheme.colors)==null?void 0:to.bg,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),n("h5",null,i(e.$t("settings.style.advanced_colors.chat.incoming")),1),u(c,{modelValue:e.chatMessageIncomingBgColorLocal,"onUpdate:modelValue":t[97]||(t[97]=g=>e.chatMessageIncomingBgColorLocal=g),name:"chatMessageIncomingBgColor",fallback:(so=e.previewTheme.colors)==null?void 0:so.bg,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.chatMessageIncomingTextColorLocal,"onUpdate:modelValue":t[98]||(t[98]=g=>e.chatMessageIncomingTextColorLocal=g),name:"chatMessageIncomingTextColor",fallback:(no=e.previewTheme.colors)==null?void 0:no.text,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.chatMessageIncomingLinkColorLocal,"onUpdate:modelValue":t[99]||(t[99]=g=>e.chatMessageIncomingLinkColorLocal=g),name:"chatMessageIncomingLinkColor",fallback:(oo=e.previewTheme.colors)==null?void 0:oo.link,label:e.$t("settings.links")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.chatMessageIncomingBorderColorLocal,"onUpdate:modelValue":t[100]||(t[100]=g=>e.chatMessageIncomingBorderColorLocal=g),name:"chatMessageIncomingBorderLinkColor",fallback:(lo=e.previewTheme.colors)==null?void 0:lo.fg,label:e.$t("settings.style.advanced_colors.chat.border")},null,8,["modelValue","fallback","label"]),n("h5",null,i(e.$t("settings.style.advanced_colors.chat.outgoing")),1),u(c,{modelValue:e.chatMessageOutgoingBgColorLocal,"onUpdate:modelValue":t[101]||(t[101]=g=>e.chatMessageOutgoingBgColorLocal=g),name:"chatMessageOutgoingBgColor",fallback:(ao=e.previewTheme.colors)==null?void 0:ao.bg,label:e.$t("settings.background")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.chatMessageOutgoingTextColorLocal,"onUpdate:modelValue":t[102]||(t[102]=g=>e.chatMessageOutgoingTextColorLocal=g),name:"chatMessageOutgoingTextColor",fallback:(io=e.previewTheme.colors)==null?void 0:io.text,label:e.$t("settings.text")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.chatMessageOutgoingLinkColorLocal,"onUpdate:modelValue":t[103]||(t[103]=g=>e.chatMessageOutgoingLinkColorLocal=g),name:"chatMessageOutgoingLinkColor",fallback:(ro=e.previewTheme.colors)==null?void 0:ro.link,label:e.$t("settings.links")},null,8,["modelValue","fallback","label"]),u(c,{modelValue:e.chatMessageOutgoingBorderColorLocal,"onUpdate:modelValue":t[104]||(t[104]=g=>e.chatMessageOutgoingBorderColorLocal=g),name:"chatMessageOutgoingBorderLinkColor",fallback:(uo=e.previewTheme.colors)==null?void 0:uo.bg,label:e.$t("settings.style.advanced_colors.chat.border")},null,8,["modelValue","fallback","label"])])],8,j1),n("div",{label:e.$t("settings.style.radii._tab_label"),class:"radius-container"},[n("div",r$,[n("p",null,i(e.$t("settings.radii_help")),1),n("button",{class:"btn button-default",onClick:t[105]||(t[105]=(...g)=>e.clearRoundness&&e.clearRoundness(...g))},i(e.$t("settings.style.switcher.clear_all")),1)]),u(w,{modelValue:e.btnRadiusLocal,"onUpdate:modelValue":t[106]||(t[106]=g=>e.btnRadiusLocal=g),name:"btnRadius",label:e.$t("settings.btnRadius"),fallback:(co=e.previewTheme.radii)==null?void 0:co.btn,max:"16","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.inputRadiusLocal,"onUpdate:modelValue":t[107]||(t[107]=g=>e.inputRadiusLocal=g),name:"inputRadius",label:e.$t("settings.inputRadius"),fallback:(ho=e.previewTheme.radii)==null?void 0:ho.input,max:"9","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.checkboxRadiusLocal,"onUpdate:modelValue":t[108]||(t[108]=g=>e.checkboxRadiusLocal=g),name:"checkboxRadius",label:e.$t("settings.checkboxRadius"),fallback:(po=e.previewTheme.radii)==null?void 0:po.checkbox,max:"16","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.panelRadiusLocal,"onUpdate:modelValue":t[109]||(t[109]=g=>e.panelRadiusLocal=g),name:"panelRadius",label:e.$t("settings.panelRadius"),fallback:(mo=e.previewTheme.radii)==null?void 0:mo.panel,max:"50","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.avatarRadiusLocal,"onUpdate:modelValue":t[110]||(t[110]=g=>e.avatarRadiusLocal=g),name:"avatarRadius",label:e.$t("settings.avatarRadius"),fallback:(fo=e.previewTheme.radii)==null?void 0:fo.avatar,max:"28","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.avatarAltRadiusLocal,"onUpdate:modelValue":t[111]||(t[111]=g=>e.avatarAltRadiusLocal=g),name:"avatarAltRadius",label:e.$t("settings.avatarAltRadius"),fallback:(go=e.previewTheme.radii)==null?void 0:go.avatarAlt,max:"28","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.attachmentRadiusLocal,"onUpdate:modelValue":t[112]||(t[112]=g=>e.attachmentRadiusLocal=g),name:"attachmentRadius",label:e.$t("settings.attachmentRadius"),fallback:(bo=e.previewTheme.radii)==null?void 0:bo.attachment,max:"50","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.tooltipRadiusLocal,"onUpdate:modelValue":t[113]||(t[113]=g=>e.tooltipRadiusLocal=g),name:"tooltipRadius",label:e.$t("settings.tooltipRadius"),fallback:(vo=e.previewTheme.radii)==null?void 0:vo.tooltip,max:"50","hard-min":"0"},null,8,["modelValue","label","fallback"]),u(w,{modelValue:e.chatMessageRadiusLocal,"onUpdate:modelValue":t[114]||(t[114]=g=>e.chatMessageRadiusLocal=g),name:"chatMessageRadius",label:e.$t("settings.chatMessageRadius"),fallback:(($o=e.previewTheme.radii)==null?void 0:$o.chatMessage)||2,max:"50","hard-min":"0"},null,8,["modelValue","label","fallback"])],8,i$),n("div",{label:e.$t("settings.style.shadows._tab_label"),class:"shadow-container"},[n("div",u$,[n("div",c$,[v(i(e.$t("settings.style.shadows.component"))+" "+i(" ")+" ",1),u(d,{id:"shadow-switcher",modelValue:e.shadowSelected,"onUpdate:modelValue":t[115]||(t[115]=g=>e.shadowSelected=g),class:"shadow-switcher"},{default:f(()=>[(m(!0),b(Y,null,se(e.shadowsAvailable,g=>(m(),b("option",{key:g,value:g},i(e.$t("settings.style.shadows.components."+g)),9,h$))),128))]),_:1},8,["modelValue"])]),n("div",p$,[u(r,{id:"override",modelValue:e.currentShadowOverriden,"onUpdate:modelValue":t[116]||(t[116]=g=>e.currentShadowOverriden=g),name:"override",class:"input-override"},{default:f(()=>[v(i(e.$t("settings.style.shadows.override")),1)]),_:1},8,["modelValue"])]),n("button",{class:"btn button-default",onClick:t[117]||(t[117]=(...g)=>e.clearShadows&&e.clearShadows(...g))},i(e.$t("settings.style.switcher.clear_all")),1)]),u(y,{modelValue:e.currentShadow,"onUpdate:modelValue":t[118]||(t[118]=g=>e.currentShadow=g),"separate-inset":e.shadowSelected==="avatar"||e.shadowSelected==="avatarStatus",fallback:e.currentShadowFallback,"static-vars":e.previewTheme.colors,compact:!0},null,8,["modelValue","separate-inset","fallback","static-vars"])],8,d$),n("div",{label:e.$t("settings.style.fonts._tab_label"),class:"fonts-container"},[n("div",f$,[n("p",null,i(e.$t("settings.style.fonts.help")),1),n("button",{class:"btn button-default",onClick:t[119]||(t[119]=(...g)=>e.clearFonts&&e.clearFonts(...g))},i(e.$t("settings.style.switcher.clear_all")),1)]),u(k,{modelValue:e.fontsLocal.interface,"onUpdate:modelValue":t[120]||(t[120]=g=>e.fontsLocal.interface=g),name:"ui",label:e.$t("settings.style.fonts.components.interface"),fallback:(yo=e.previewTheme.fonts)==null?void 0:yo.interface,"no-inherit":"1"},null,8,["modelValue","label","fallback"]),u(k,{modelValue:e.fontsLocal.input,"onUpdate:modelValue":t[121]||(t[121]=g=>e.fontsLocal.input=g),name:"input",label:e.$t("settings.style.fonts.components.input"),fallback:(wo=e.previewTheme.fonts)==null?void 0:wo.input},null,8,["modelValue","label","fallback"]),u(k,{modelValue:e.fontsLocal.post,"onUpdate:modelValue":t[122]||(t[122]=g=>e.fontsLocal.post=g),name:"post",label:e.$t("settings.style.fonts.components.post"),fallback:(ko=e.previewTheme.fonts)==null?void 0:ko.post},null,8,["modelValue","label","fallback"]),u(k,{modelValue:e.fontsLocal.postCode,"onUpdate:modelValue":t[123]||(t[123]=g=>e.fontsLocal.postCode=g),name:"postCode",label:e.$t("settings.style.fonts.components.postCode"),fallback:(Co=e.previewTheme.fonts)==null?void 0:Co.postCode},null,8,["modelValue","label","fallback"])],8,m$)]}),_:1})],1024)),e.isActive?(m(),H(Ea,{key:0,to:"#unscrolled-content"},[n("div",g$,[n("button",{class:"btn button-default submit",disabled:!e.themeValid,onClick:t[124]||(t[124]=(...T)=>e.setCustomTheme&&e.setCustomTheme(...T))},i(e.$t("general.apply")),9,b$),n("button",{class:"btn button-default",onClick:t[125]||(t[125]=(...T)=>e.clearAll&&e.clearAll(...T))},i(e.$t("settings.style.switcher.reset")),1)])])):V("",!0)])}const $$=X(f1,[["render",v$]]),y$={components:{Checkbox:pe},props:["name","label","modelValue","fallback","disabled"],emits:["update:modelValue"],computed:{present(){return typeof this.modelValue<"u"}}},w$=["for"],k$=["id","value","disabled"];function C$(e,t,s,o,l,a){const d=P("Checkbox");return m(),b("div",{class:W(["roundness-control style-control",{disabled:!a.present||s.disabled}])},[n("label",{for:s.name,class:W(["label",{faint:!a.present||s.disabled}])},i(s.label),11,w$),typeof s.fallback<"u"?(m(),H(d,{key:0,"model-value":a.present,disabled:s.disabled,class:"opt","onUpdate:modelValue":t[0]||(t[0]=r=>e.$emit("update:modelValue",a.present?void 0:s.fallback))},null,8,["model-value","disabled"])):V("",!0),n("input",{id:s.name,class:W(["input input-number",{disabled:!a.present||s.disabled}]),type:"number",value:s.modelValue||s.fallback,disabled:!a.present||s.disabled,max:"999",min:"0",step:"1",onInput:t[1]||(t[1]=r=>e.$emit("update:modelValue",r.target.value))},null,42,k$)],2)}const T$=X(y$,[["render",C$]]),V$={components:{Select:qe,SelectMotion:Rn,ShadowControl:Bn,ColorInput:rt},props:["modelValue"],emits:["update:modelValue"],setup(e,t){const s={},o=t.emit;s.emit=o,s.computeColor=xt("computeColor"),s.staticVars=xt("staticVars");const l=de(0);s.selectedVirtualDirectiveId=l;const a=Z({get(){return e.modelValue[l.value]},set(c){const p=[...e.modelValue];p[l.value]=c,o("update:modelValue",p)}});s.selectedVirtualDirective=a,s.selectedVirtualDirectiveValType=Z({get(){return e.modelValue[l.value].valType},set(c){const p=c;let $;switch(c){case"shadow":$="0 0 0 #000000 / 1";break;case"color":$="#000000";break;default:$="none"}const w=e.modelValue[l.value].name;e.modelValue[l.value]={name:w,value:$,valType:p}}});const d=de(!0),r=de({});s.draftVirtualDirective=r;const h=xt("normalizeShadows");return nt(a,c=>{switch(c.valType){case"shadow":{if(Array.isArray(c.value))r.value=h(c.value);else{const p=c.value.split(/,/g).map($=>$.trim());r.value=h(p)}break}case"color":r.value=c.value;break;default:r.value=c.value;break}},{immediate:!0}),nt(r,c=>{try{switch(a.value.valType){case"shadow":{e.modelValue[l.value].value=c.map(p=>zt(p)).join(", ");break}default:e.modelValue[l.value].value=c}d.value=!0}catch(p){console.error("Invalid virtual directive value",p),d.value=!1}},{immediate:!0}),s.getNewVirtualDirective=()=>({name:"newDirective",valType:"generic",value:"foobar"}),s}},S$={class:"setting-item list-editor variables-editor"},P$={class:"list-select-label",for:"variables-selector"},I$=["value"],E$={class:"list-edit-area"},A$={class:"variable-selector"},_$={class:"variable-name-label",for:"variables-selector"},L$={class:"variable-type-label",for:"variables-selector"},O$={value:"shadow"},U$={value:"color"},R$={value:"generic"};function B$(e,t,s,o,l,a){const d=P("Select"),r=P("SelectMotion"),h=P("ShadowControl"),c=P("ColorInput");return m(),b("div",S$,[n("label",P$,i(e.$t("settings.style.themes3.editor.variables.label"))+" "+i(" "),1),u(d,{id:"variables-selector",modelValue:e.selectedVirtualDirectiveId,"onUpdate:modelValue":t[0]||(t[0]=p=>e.selectedVirtualDirectiveId=p),class:"list-select",size:"20"},{default:f(()=>[(m(!0),b(Y,null,se(e.modelValue,(p,$)=>(m(),b("option",{key:p.name,value:$},i(p.name),9,I$))),128))]),_:1},8,["modelValue"]),u(r,{class:"list-select-movement","model-value":e.modelValue,"selected-id":e.selectedVirtualDirectiveId,"get-add-value":e.getNewVirtualDirective,"onUpdate:modelValue":t[1]||(t[1]=p=>e.emit("update:modelValue",p)),"onUpdate:selectedId":t[2]||(t[2]=p=>e.selectedVirtualDirectiveId=p)},null,8,["model-value","selected-id","get-add-value"]),n("div",E$,[n("div",A$,[n("label",_$,i(e.$t("settings.style.themes3.editor.variables.name_label"))+" "+i(" "),1),x(n("input",{"onUpdate:modelValue":t[3]||(t[3]=p=>e.selectedVirtualDirective.name=p),class:"input"},null,512),[[ie,e.selectedVirtualDirective.name]]),n("label",L$,i(e.$t("settings.style.themes3.editor.variables.type_label"))+" "+i(" "),1),u(d,{modelValue:e.selectedVirtualDirectiveValType,"onUpdate:modelValue":t[4]||(t[4]=p=>e.selectedVirtualDirectiveValType=p)},{default:f(()=>[n("option",O$,i(e.$t("settings.style.themes3.editor.variables.type_shadow")),1),n("option",U$,i(e.$t("settings.style.themes3.editor.variables.type_color")),1),n("option",R$,i(e.$t("settings.style.themes3.editor.variables.type_generic")),1)]),_:1},8,["modelValue"])]),e.selectedVirtualDirectiveValType==="shadow"?(m(),H(h,{key:0,modelValue:e.draftVirtualDirective,"onUpdate:modelValue":t[5]||(t[5]=p=>e.draftVirtualDirective=p),"static-vars":e.staticVars,compact:!0},null,8,["modelValue","static-vars"])):V("",!0),e.selectedVirtualDirectiveValType==="color"?(m(),H(c,{key:1,modelValue:e.draftVirtualDirective,"onUpdate:modelValue":t[6]||(t[6]=p=>e.draftVirtualDirective=p),name:"virtual-directive-color",fallback:e.computeColor(e.draftVirtualDirective),label:e.$t("settings.style.themes3.editor.variables.virtual_color"),"hide-optional-checkbox":!0},null,8,["modelValue","fallback","label"])):V("",!0)])])}const M$=X(V$,[["render",B$]]),on=e=>["normal",...(e==null?void 0:e.filter(t=>t!=="normal"))||[]].join(":");ue.add(jr,qr,zr,Hr,Wr);const F$={components:{Select:qe,SelectMotion:Rn,Checkbox:pe,Tooltip:Za,StringSetting:nd,ComponentPreview:Ja,TabSwitcher:Kt,ShadowControl:Bn,ColorInput:rt,PaletteEditor:Ya,OpacityInput:Un,RoundnessInput:T$,ContrastRatio:Qa,Preview:On,VirtualDirectivesTab:M$},setup(){const e={},t=Q(),s=de(t.styleDataUsed||{}),o=Z(()=>t.styleDataUsed);nt([o],()=>{Ie(t.styleDataUsed)},{once:!0}),e.isActive=Z(()=>{const I=ar().parent.ctx;return I?I.isActive("style"):!1}),e.name=de(""),e.author=de(""),e.license=de(""),e.website=de("");const l=Z(()=>["@meta {",`  name: ${e.name.value};`,`  author: ${e.author.value};`,`  license: ${e.license.value};`,`  website: ${e.website.value};`,"}"].join(`
`)),a=Z(()=>({component:"@meta",directives:{name:e.name.value,author:e.author.value,license:e.license.value,website:e.website.value}})),d=Eo([{name:"default",bg:"#121a24",fg:"#182230",text:"#b9b9ba",link:"#d8a070",accent:"#d8a070",cRed:"#FF0000",cBlue:"#0095ff",cGreen:"#0fa00f",cOrange:"#ffa500"},{name:"light",bg:"#f2f6f9",fg:"#d6dfed",text:"#304055",underlay:"#5d6086",accent:"#f55b1b",cBlue:"#0095ff",cRed:"#d31014",cGreen:"#0fa00f",cOrange:"#ffa500",border:"#d8e6f9"}]);e.palettes=d;const r=I=>{d.splice(0,d.length),d.push(...I)};e.onPalettesUpdate=r;const h=de(0),c=Z({get(){return d[h.value]},set(I){d[h.value]=I}});e.selectedPaletteId=h,e.selectedPalette=c,Lt("selectedPalette",c),nt([c],()=>re()),e.getNewPalette=()=>({name:"new palette",bg:"#121a24",fg:"#182230",text:"#b9b9ba",link:"#d8a070",accent:"#d8a070",cRed:"#FF0000",cBlue:"#0095ff",cGreen:"#0fa00f",cOrange:"#ffa500"});const p=Z(()=>d.map(I=>{const{name:F,...q}=I;return{component:"@palette",variant:F,directives:Object.entries(q).filter(([N,G])=>G&&N).reduce((N,[G,ne])=>({...N,[G]:ne}),{})}})),$=Z(()=>d.map(({name:I,...F})=>{const q=Object.entries(F).filter(([N,G])=>G&&N).map(([N,G])=>`  ${N}: ${G};`).join(`
`);return`@palette.${I} {
${q}
}`}).join(`

`)),w=Object.assign({"/src/components/alert.style.js":Dr,"/src/components/attachment/attachment.style.js":Fr,"/src/components/badge.style.js":Mr,"/src/components/border.style.js":Br,"/src/components/button.style.js":Rr,"/src/components/button_unstyled.style.js":Ur,"/src/components/chat/chat.style.js":Or,"/src/components/chat_message/chat_message.style.js":Lr,"/src/components/fun_text.style.js":_r,"/src/components/icon.style.js":Ar,"/src/components/input.style.js":Er,"/src/components/link.style.js":Ir,"/src/components/list/list_item.style.js":Pr,"/src/components/menu_item.style.js":Sr,"/src/components/mobile_drawer.style.js":Vr,"/src/components/modal/modals.style.js":Tr,"/src/components/notification/notification.style.js":Cr,"/src/components/panel.style.js":kr,"/src/components/panel_header.style.js":wr,"/src/components/poll/poll_graph.style.js":yr,"/src/components/popover.style.js":$r,"/src/components/rich_content/rich_content.style.js":vr,"/src/components/root.style.js":br,"/src/components/scrollbar.style.js":gr,"/src/components/scrollbar_element.style.js":fr,"/src/components/status/post.style.js":mr,"/src/components/tab_switcher/tab.style.js":pr,"/src/components/text.style.js":hr,"/src/components/top_bar.style.js":cr,"/src/components/underlay.style.js":ur,"/src/components/user_avatar/avatar.style.js":dr,"/src/components/user_card/user_card.style.js":rr}),y=Object.keys(w),k=new Map(y.map(I=>[I,w[I].default]).filter(([,I])=>!I.virtual&&!I.notEditable));e.componentsMap=k;const S=[...k.keys()];e.componentKeys=S;const T=de(k.keys().next().value);e.selectedComponentKey=T;const E=Z(()=>k.get(T.value)),M=Z(()=>E.value.name);e.selectedComponentVariants=Z(()=>Object.keys({normal:null,...E.value.variants||{}})),e.selectedComponentStates=Z(()=>Object.keys({normal:null,...E.value.states||{}}).filter(F=>F!=="normal"));const O=de("normal");e.selectedVariant=O;const A=Eo(new Set);e.selectedState=A,e.updateSelectedStates=(I,F)=>{F?A.add(I):A.delete(I)},nt(M,()=>{O.value="normal",A.clear()});const C=(I,F={})=>I.reduce((q,N)=>{const{parent:G,component:ne}=N,te=G??N,ee=!!G,Ee=ee?N:null,{component:Te,variant:ve="normal",state:fe=[]}=te,Ae=`${ee?Te:ne}.${ve}.${on(fe)}`;let ke=ae.get(q,Ae);if(ke||(ae.set(q,Ae,{}),ke=ae.get(q,Ae)),ee){ke._children=ke._children??{};const{component:et,variant:Tt="normal",state:Vt=[],directives:St}=Ee,Pt=`${et}.${Tt}.${on(Vt)}`;ae.set(ke._children,Pt,{directives:St})}else ke.directives=te.directives;return q},F),U=Z(()=>{const I={};return S.forEach(F=>{const q=k.get(F),{defaultRules:N,name:G}=q;C(N.map(ne=>({...ne,component:G})),I)}),I});e.componentHas=I=>{var F;return!!((F=E.value.validInnerComponents)!=null&&F.find(q=>q===I))};const _=(I,F)=>{const q=I?`._children.${I}.normal.normal`:"";return`${M.value}.${O.value}.${on([...A])}${q}.directives.${F}`},R=(I,F,q="")=>Z({get(){return ae.get(s.value,_(I,F))!=null},set(N){if(N){const G=ae.get(U.value,_(I,F));ae.set(s.value,_(I,F),G??q)}else ae.unset(s.value,_(I,F));e.updateOverallPreview()}}),B=(I,F,q=N=>N)=>Z({get(){let N;const G=U.value,ne=s.value,te=_(I,F);return N=ae.get(ne,te),N||(N=ae.get(G,te)),q(N)},set(N){N?ae.set(s.value,_(I,F),N):ae.unset(s.value,_(I,F)),e.updateOverallPreview()}});e.editedBackgroundColor=B(null,"background"),e.isBackgroundColorPresent=R(null,"background","#FFFFFF"),e.editedOpacity=B(null,"opacity"),e.isOpacityPresent=R(null,"opacity",1),e.editedRoundness=B(null,"roundness"),e.isRoundnessPresent=R(null,"roundness","0"),e.editedTextColor=B("Text","textColor"),e.isTextColorPresent=R("Text","textColor","#000000"),e.editedTextAuto=B("Text","textAuto"),e.isTextAutoPresent=R("Text","textAuto","#000000"),e.editedLinkColor=B("Link","textColor"),e.isLinkColorPresent=R("Link","textColor","#000080"),e.editedIconColor=B("Icon","textColor"),e.isIconColorPresent=R("Icon","textColor","#909090"),e.editedBorderColor=B("Border","textColor"),e.isBorderColorPresent=R("Border","textColor","#909090");const D=(I,F)=>{try{const q=Ft(I),N=Ft(F),G=Nr(q,N);return{ratio:G,text:G.toPrecision(3)+":1",aa:G>=4.5,aaa:G>=7,laa:G>=3,laaa:G>=4.5}}catch(q){return console.warn("Failure computing contrast",q),{error:q}}},z=I=>I==null?void 0:I.map(F=>{if(typeof F=="object")return F;if(typeof F=="string")try{return gn(F)}catch(q){return console.warn(q),F}return null});Lt("normalizeShadows",z);const L=B(null,"shadow",z);e.editedShadow=L;const j=de(null);e.editedSubShadowId=j;const ce=Z(()=>L.value==null||j.value==null?null:L.value[j.value]);e.editedSubShadow=ce,e.isShadowPresent=R(null,"shadow",[]),e.onSubShadow=I=>{I!=null?j.value=I:ce.value=null},e.updateSubShadow=(I,F)=>{if(!ce.value||j.value==null)return;const q=[...L.value];q[j.value]={...q[j.value],[I]:F},L.value=q},e.isShadowTabOpen=de(!1),e.onTabSwitch=I=>{e.isShadowTabOpen.value=I==="shadow"},e.editorHintStyle=Z(()=>{const I=E.value.editor,F=[];return I&&Object.keys(I).length>0&&(I.aspect!=null&&F.push(`aspect-ratio: ${I.aspect} !important;`),I.border!=null&&F.push(`border-width: ${I.border}px !important;`)),F.join("; ")});const $e=Z(()=>{const I=[],F=(q,N={},G)=>{Object.entries(N||{}).forEach(([te,ee])=>{Object.entries(ee).forEach(([Te,ve])=>{const fe=Te.split(/:/g),Ae={component:q,variant:te,state:fe,directives:ve.directives||{}};G&&(Ae.parent={component:G}),I.push(Ae),G||Object.entries(ve._children||{}).forEach(([ke,et])=>F(ke,et,q))})})};return[...k.values()].forEach(({name:q})=>{F(q,s.value[q])}),I}),Je=[...k.values()].map(I=>I.defaultRules.filter(F=>F.component==="Root").map(F=>Object.entries(F.directives)).flat()).filter(I=>I).flat().map(([I,F])=>{const[q,N]=F.split("|");return{name:I.substring(2),valType:q==null?void 0:q.trim(),value:N==null?void 0:N.trim()}}),ye=de(Je);e.virtualDirectives=ye,e.updateVirtualDirectives=I=>{ye.value=I};const Ze=Z(()=>({component:"Root",directives:Object.fromEntries(ye.value.map(I=>[`--${I.name}`,`${I.valType} | ${I.value}`]))})),Re=Z(()=>["Root {",...ye.value.filter(I=>I.name&&I.valType&&I.value).map(I=>`  --${I.name}: ${I.valType} | ${I.value};`),"}"].join(`
`));e.computeColor=I=>{let F;try{if(F=ln(I,{dynamicVars:dt.value,staticVars:Qe.value}),F)return We(F)}catch(q){console.warn(q)}return null},Lt("computeColor",e.computeColor),e.contrast=Z(()=>D(e.computeColor(xe.value.background),e.computeColor(xe.value.text)));const Pe=Yt({filename:()=>e.name.value??"pleroma_theme",mime:"text/plain",extension:"iss",getExportedObject:()=>Me.value}),Ie=I=>{const F=I.filter(ee=>ee.component.startsWith("@")),q=I.find(ee=>ee.component==="Root"),N=I.filter(ee=>!ee.component.startsWith("@")&&ee.component!=="Root"),G=F.find(ee=>ee.component==="@meta").directives,ne=F.filter(ee=>ee.component==="@palette");e.name.value=G.name,e.license.value=G.license,e.author.value=G.author,e.website.value=G.website;const te=Object.entries(q.directives).map(([ee,Ee])=>{const[Te,ve]=Ee.split("|").map(fe=>fe.trim());return{name:ee.substring(2),valType:Te,value:ve}});ye.value=te,r(ne.map(ee=>({name:ee.variant,...ee.directives}))),s.value=C(N),e.updateOverallPreview()},Be=kt({accept:".iss",parser(I){return Ia(I)},onImportFailure(I){console.error("Failure importing style:",I),Q().pushGlobalNotice({messageKey:"settings.invalid_theme_imported",level:"error"})},onImport:Ie}),He=Z(()=>[a.value,...p.value,Ze.value,...$e.value]),Me=Z(()=>[l.value,$.value,Re.value,Fv($e.value)].join(`

`));e.clearStyle=()=>{Ie(t().styleDataUsed)},e.exportStyle=()=>{Pe.exportData()},e.importStyle=()=>{Be.importData()},e.applyStyle=()=>{Q().setStyleCustom(He.value)};const we=de([]);e.overallPreviewRules=we;const he=de([]);ir(ae.throttle(()=>{try{he.value=fn(Dt(we.value),"#edited-style-preview").join(`
`)}catch(I){console.error(I)}},500)),e.overallPreviewCssRules=he;const re=ae.throttle(()=>{try{we.value=bt({inputRuleset:[...He.value,{component:"Root",directives:Object.fromEntries(Object.entries(c.value).filter(([I,F])=>I&&F&&I!=="name").map(([I,F])=>[`--${I}`,`color | ${F}`]))}],ultimateBackgroundColor:"#000000",debug:!0}).eager}catch(I){return console.error("Could not compile preview theme",I),null}},5e3),be=(I,F)=>I.replace(F,".component-preview .preview-block").replace(":active",".preview-active").replace(":hover",".preview-hover").replace(":active",".preview-active").replace(":focus",".preview-focus").replace(":focus-within",".preview-focus-within").replace(":disabled",".preview-disabled"),me=Z(()=>{const I=we.value.filter(N=>{var ve;const G=N.component===M.value,ne=((ve=N.parent)==null?void 0:ve.component)===M.value;if(!G&&!ne)return!1;const te=ne?N.parent:N;if(te.component!==M.value||te.variant!==O.value)return!1;const ee=new Set(te.state.filter(fe=>fe!=="normal")),Ee=[...ee].filter(fe=>!A.has(fe)),Te=[...A].filter(fe=>!ee.has(fe));return Ee.length+Te.length===0}),q=[...I].filter(N=>N.component===M.value).sort((N,G)=>{const ne=N.selector.split(/ /g).length,te=G.selector.split(/ /g).length;return ne-te})[0].selector;return I.filter(N=>N.selector.startsWith(q))});e.previewClass=Z(()=>{var F;const I=[];return((F=E.value.variants)!=null&&F.normal||O.value!=="normal")&&I.push(E.value.variants[O.value]),A.size>0&&A.forEach(q=>{const N=E.value.states[q];I.push(be(N))}),I.map(q=>q.substring(1)).join("")}),e.previewCss=Z(()=>{try{const I=me.value[0].selector;return Dt(me.value).map(q=>be(q,I)).join(`
`)}catch(I){return console.error("Invalid ruleset",I),null}});const dt=Z(()=>me.value[0].dynamicVars),Qe=Z(()=>{const I=we.value.find(N=>N.component==="Root"),F=Object.entries(I.directives),q={};return F.filter(([N,G])=>N.startsWith("--")&&G.startsWith("color | ")).map(([N,G])=>[N.substring(2),G.substring(8)]).forEach(([N,G])=>{q[N]=ln(G,{dynamicVars:{},staticVars:q})}),q});Lt("staticVars",Qe),e.staticVars=Qe;const xe=Z(()=>{var q,N,G,ne;const I=dt.value.stacked,F=typeof I=="string"?I:We(I);return{text:(q=me.value.find(te=>te.component==="Text"))==null?void 0:q.virtualDirectives["--text"],link:(N=me.value.find(te=>te.component==="Link"))==null?void 0:N.virtualDirectives["--link"],border:(G=me.value.find(te=>te.component==="Border"))==null?void 0:G.virtualDirectives["--border"],icon:(ne=me.value.find(te=>te.component==="Icon"))==null?void 0:ne.virtualDirectives["--icon"],background:F}});return e.previewColors=xe,e.updateOverallPreview=re,re(),nt([s.value,d,c,A,O],re),e}},D$={class:"StyleTab"},N$={class:"setting-item heading"},j$={class:"meta-preview"},q$={class:"style-actions-container"},z$={class:"style-actions"},H$={class:"setting-list style-metadata"},W$=["label"],K$={class:"component-selector"},G$={for:"component-selector"},Y$=["value"],X$={key:0,class:"variant-selector"},J$={for:"variant-selector"},Z$=["value"],Q$={key:1,class:"state-selector"},x$={class:"state-selector-list"},ey={class:"preview-container"},ty=["label"],sy={key:2,class:"style-control suboption"},ny={value:"no-preserve"},oy={value:"no-auto"},ly={value:"preserve"},ay={key:4,class:"style-control suboption"},iy={class:"label"},ry={key:5},dy=["label"],uy=["label"],cy={class:"list-select-label",for:"palette-selector"},hy=["value"],py={class:"list-edit-area"};function my(e,t,s,o,l,a){const d=P("Preview"),r=P("FAIcon"),h=P("StringSetting"),c=P("Select"),p=P("Checkbox"),$=P("ComponentPreview"),w=P("ColorInput"),y=P("Tooltip"),k=P("ContrastRatio"),S=P("OpacityInput"),T=P("RoundnessInput"),E=P("ShadowControl"),M=P("tab-switcher"),O=P("SelectMotion"),A=P("PaletteEditor"),K=P("VirtualDirectivesTab");return m(),b("div",D$,[n("div",N$,[n("h2",null,i(e.$t("settings.style.themes3.editor.title")),1),n("div",j$,[(m(),H(lt("style"),{innerHTML:e.overallPreviewCssRules},null,8,["innerHTML"])),u(d,{id:"edited-style-preview"}),e.isActive?(m(),H(Ea,{key:0,to:"#unscrolled-content"},[n("div",q$,[n("div",z$,[n("button",{class:"btn button-default button-new",onClick:t[0]||(t[0]=(...C)=>e.clearStyle&&e.clearStyle(...C))},[u(r,{icon:"arrows-rotate"}),v(" "+i(e.$t("settings.style.themes3.editor.reset_style")),1)]),n("button",{class:"btn button-default button-load",onClick:t[1]||(t[1]=(...C)=>e.importStyle&&e.importStyle(...C))},[u(r,{icon:"folder-open"}),v(" "+i(e.$t("settings.style.themes3.editor.load_style")),1)]),n("button",{class:"btn button-default button-save",onClick:t[2]||(t[2]=(...C)=>e.exportStyle&&e.exportStyle(...C))},[u(r,{icon:"floppy-disk"}),v(" "+i(e.$t("settings.style.themes3.editor.save_style")),1)]),n("button",{class:"btn button-default button-apply",onClick:t[3]||(t[3]=(...C)=>e.applyStyle&&e.applyStyle(...C))},[u(r,{icon:"check"}),v(" "+i(e.$t("settings.style.themes3.editor.apply_preview")),1)])])])])):V("",!0),n("ul",H$,[n("li",null,[u(h,{modelValue:e.name,"onUpdate:modelValue":t[4]||(t[4]=C=>e.name=C),class:"meta-field"},{default:f(()=>[v(i(e.$t("settings.style.themes3.editor.style_name")),1)]),_:1},8,["modelValue"])]),n("li",null,[u(h,{modelValue:e.author,"onUpdate:modelValue":t[5]||(t[5]=C=>e.author=C),class:"meta-field"},{default:f(()=>[v(i(e.$t("settings.style.themes3.editor.style_author")),1)]),_:1},8,["modelValue"])]),n("li",null,[u(h,{modelValue:e.license,"onUpdate:modelValue":t[6]||(t[6]=C=>e.license=C),class:"meta-field"},{default:f(()=>[v(i(e.$t("settings.style.themes3.editor.style_license")),1)]),_:1},8,["modelValue"])]),n("li",null,[u(h,{modelValue:e.website,"onUpdate:modelValue":t[7]||(t[7]=C=>e.website=C),class:"meta-field"},{default:f(()=>[v(i(e.$t("settings.style.themes3.editor.style_website")),1)]),_:1},8,["modelValue"])])])])]),u(M,null,{default:f(()=>[n("div",{key:"component",class:"setting-item component-editor",label:e.$t("settings.style.themes3.editor.component_tab")},[n("div",K$,[n("label",G$,i(e.$t("settings.style.themes3.editor.component_selector"))+" "+i(" "),1),u(c,{id:"component-selector",modelValue:e.selectedComponentKey,"onUpdate:modelValue":t[8]||(t[8]=C=>e.selectedComponentKey=C)},{default:f(()=>[(m(!0),b(Y,null,se(e.componentKeys,C=>(m(),b("option",{key:"component-"+C,value:C},i(e.componentsMap.get(C).name),9,Y$))),128))]),_:1},8,["modelValue"])]),e.selectedComponentVariants.length>1?(m(),b("div",X$,[n("label",J$,i(e.$t("settings.style.themes3.editor.variant_selector")),1),u(c,{modelValue:e.selectedVariant,"onUpdate:modelValue":t[9]||(t[9]=C=>e.selectedVariant=C)},{default:f(()=>[(m(!0),b(Y,null,se(e.selectedComponentVariants,C=>(m(),b("option",{key:"component-variant-"+C,value:C},i(C),9,Z$))),128))]),_:1},8,["modelValue"])])):V("",!0),e.selectedComponentStates.length>0?(m(),b("div",Q$,[n("label",null,i(e.$t("settings.style.themes3.editor.states_selector")),1),n("ul",x$,[(m(!0),b(Y,null,se(e.selectedComponentStates,C=>(m(),b("li",{key:"component-state-"+C},[u(p,{value:e.selectedState.has(C),"onUpdate:modelValue":U=>e.updateSelectedStates(C,U)},{default:f(()=>[v(i(C),1)]),_:2},1032,["value","onUpdate:modelValue"])]))),128))])])):V("",!0),n("div",ey,[(m(),H(lt("style"),{innerHTML:e.previewCss},null,8,["innerHTML"])),u($,{class:"component-preview","show-text":e.componentHas("Text"),"shadow-control":e.isShadowTabOpen,"preview-class":e.previewClass,"preview-style":e.editorHintStyle,"preview-css":e.previewCss,disabled:!e.editedSubShadow&&typeof e.editedShadow!="string",shadow:e.editedSubShadow,"no-color-control":!0,"onUpdate:shadow":t[10]||(t[10]=({axis:C,value:U})=>e.updateSubShadow(C,U))},null,8,["show-text","shadow-control","preview-class","preview-style","preview-css","disabled","shadow"])]),u(M,{ref:"tabSwitcher",class:"component-settings","on-switch":e.onTabSwitch},{default:f(()=>[n("div",{key:"main",class:"editor-tab",label:e.$t("settings.style.themes3.editor.main_tab")},[u(w,{modelValue:e.editedBackgroundColor,"onUpdate:modelValue":t[11]||(t[11]=C=>e.editedBackgroundColor=C),name:"component-background-color",fallback:e.computeColor(e.editedBackgroundColor)??e.previewColors.background,disabled:!e.isBackgroundColorPresent,label:e.$t("settings.style.themes3.editor.background"),"hide-optional-checkbox":!0},null,8,["modelValue","fallback","disabled","label"]),u(y,{text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isBackgroundColorPresent,"onUpdate:modelValue":t[12]||(t[12]=C=>e.isBackgroundColorPresent=C)},null,8,["modelValue"])]),_:1},8,["text"]),e.componentHas("Text")?(m(),H(w,{key:0,modelValue:e.editedTextColor,"onUpdate:modelValue":t[13]||(t[13]=C=>e.editedTextColor=C),name:"component-text-color",fallback:e.computeColor(e.editedTextColor)??e.previewColors.text,label:e.$t("settings.style.themes3.editor.text_color"),disabled:!e.isTextColorPresent,"hide-optional-checkbox":!0},null,8,["modelValue","fallback","label","disabled"])):V("",!0),e.componentHas("Text")?(m(),H(y,{key:1,text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isTextColorPresent,"onUpdate:modelValue":t[14]||(t[14]=C=>e.isTextColorPresent=C)},null,8,["modelValue"])]),_:1},8,["text"])):V("",!0),e.componentHas("Text")?(m(),b("div",sy,[n("label",{for:"textAuto",class:W(["label",{faint:!e.isTextAutoPresent}])},i(e.$t("settings.style.themes3.editor.text_auto.label")),3),u(c,{id:"textAuto",modelValue:e.editedTextAuto,"onUpdate:modelValue":t[15]||(t[15]=C=>e.editedTextAuto=C),disabled:!e.isTextAutoPresent},{default:f(()=>[n("option",ny,i(e.$t("settings.style.themes3.editor.text_auto.no-preserve")),1),n("option",oy,i(e.$t("settings.style.themes3.editor.text_auto.no-auto")),1),n("option",ly,i(e.$t("settings.style.themes3.editor.text_auto.preserve")),1)]),_:1},8,["modelValue","disabled"])])):V("",!0),e.componentHas("Text")?(m(),H(y,{key:3,text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isTextAutoPresent,"onUpdate:modelValue":t[16]||(t[16]=C=>e.isTextAutoPresent=C)},null,8,["modelValue"])]),_:1},8,["text"])):V("",!0),e.componentHas("Text")?(m(),b("div",ay,[n("label",iy,i(e.$t("settings.style.themes3.editor.contrast")),1),u(k,{"show-ratio":!0,contrast:e.contrast},null,8,["contrast"])])):V("",!0),e.componentHas("Text")?(m(),b("div",ry)):V("",!0),e.componentHas("Link")?(m(),H(w,{key:6,modelValue:e.editedLinkColor,"onUpdate:modelValue":t[17]||(t[17]=C=>e.editedLinkColor=C),name:"component-link-color",fallback:e.computeColor(e.editedLinkColor)??e.previewColors.link,label:e.$t("settings.style.themes3.editor.link_color"),disabled:!e.isLinkColorPresent,"hide-optional-checkbox":!0},null,8,["modelValue","fallback","label","disabled"])):V("",!0),e.componentHas("Link")?(m(),H(y,{key:7,text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isLinkColorPresent,"onUpdate:modelValue":t[18]||(t[18]=C=>e.isLinkColorPresent=C)},null,8,["modelValue"])]),_:1},8,["text"])):V("",!0),e.componentHas("Icon")?(m(),H(w,{key:8,modelValue:e.editedIconColor,"onUpdate:modelValue":t[19]||(t[19]=C=>e.editedIconColor=C),name:"component-icon-color",fallback:e.computeColor(e.editedIconColor)??e.previewColors.icon,label:e.$t("settings.style.themes3.editor.icon_color"),disabled:!e.isIconColorPresent,"hide-optional-checkbox":!0},null,8,["modelValue","fallback","label","disabled"])):V("",!0),e.componentHas("Icon")?(m(),H(y,{key:9,text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isIconColorPresent,"onUpdate:modelValue":t[20]||(t[20]=C=>e.isIconColorPresent=C)},null,8,["modelValue"])]),_:1},8,["text"])):V("",!0),e.componentHas("Border")?(m(),H(w,{key:10,modelValue:e.editedBorderColor,"onUpdate:modelValue":t[21]||(t[21]=C=>e.editedBorderColor=C),name:"component-border-color",fallback:e.computeColor(e.editedBorderColor)??e.previewColors.border,label:e.$t("settings.style.themes3.editor.border_color"),disabled:!e.isBorderColorPresent,"hide-optional-checkbox":!0},null,8,["modelValue","fallback","label","disabled"])):V("",!0),e.componentHas("Border")?(m(),H(y,{key:11,text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isBorderColorPresent,"onUpdate:modelValue":t[22]||(t[22]=C=>e.isBorderColorPresent=C)},null,8,["modelValue"])]),_:1},8,["text"])):V("",!0),u(S,{modelValue:e.editedOpacity,"onUpdate:modelValue":t[23]||(t[23]=C=>e.editedOpacity=C),name:"component-opacity",disabled:!e.isOpacityPresent,label:e.$t("settings.style.themes3.editor.opacity")},null,8,["modelValue","disabled","label"]),u(y,{text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isOpacityPresent,"onUpdate:modelValue":t[24]||(t[24]=C=>e.isOpacityPresent=C)},null,8,["modelValue"])]),_:1},8,["text"]),u(T,{modelValue:e.editedRoundness,"onUpdate:modelValue":t[25]||(t[25]=C=>e.editedRoundness=C),name:"component-roundness",disabled:!e.isRoundnessPresent,label:e.$t("settings.style.themes3.editor.roundness")},null,8,["modelValue","disabled","label"]),u(y,{text:e.$t("settings.style.themes3.editor.include_in_rule")},{default:f(()=>[u(p,{modelValue:e.isRoundnessPresent,"onUpdate:modelValue":t[26]||(t[26]=C=>e.isRoundnessPresent=C)},null,8,["modelValue"])]),_:1},8,["text"])],8,ty),n("div",{key:"shadow",class:"editor-tab shadow-tab",label:e.$t("settings.style.themes3.editor.shadows_tab")},[u(p,{modelValue:e.isShadowPresent,"onUpdate:modelValue":t[27]||(t[27]=C=>e.isShadowPresent=C),class:"style-control"},{default:f(()=>[v(i(e.$t("settings.style.themes3.editor.include_in_rule")),1)]),_:1},8,["modelValue"]),u(E,{modelValue:e.editedShadow,"onUpdate:modelValue":t[28]||(t[28]=C=>e.editedShadow=C),disabled:!e.isShadowPresent,"no-preview":!0,compact:!0,"static-vars":e.staticVars,onSubShadowSelected:e.onSubShadow},null,8,["modelValue","disabled","static-vars","onSubShadowSelected"])],8,dy)]),_:1},8,["on-switch"])],8,W$),n("div",{key:"palette",label:e.$t("settings.style.themes3.editor.palette_tab"),class:"setting-item list-editor palette-editor"},[n("label",cy,i(e.$t("settings.style.themes3.palette.label"))+" "+i(" "),1),u(c,{id:"palette-selector",modelValue:e.selectedPaletteId,"onUpdate:modelValue":t[29]||(t[29]=C=>e.selectedPaletteId=C),class:"list-select",size:"4"},{default:f(()=>[(m(!0),b(Y,null,se(e.palettes,(C,U)=>(m(),b("option",{key:C.name,value:U},i(C.name),9,hy))),128))]),_:1},8,["modelValue"]),u(O,{class:"list-select-movement","model-value":e.palettes,"selected-id":e.selectedPaletteId,"get-add-value":e.getNewPalette,"onUpdate:modelValue":e.onPalettesUpdate,"onUpdate:selectedId":t[30]||(t[30]=C=>e.selectedPaletteId=C)},null,8,["model-value","selected-id","get-add-value","onUpdate:modelValue"]),n("div",py,[u(h,{modelValue:e.selectedPalette.name,"onUpdate:modelValue":t[31]||(t[31]=C=>e.selectedPalette.name=C),class:"palette-name-input"},{default:f(()=>[v(i(e.$t("settings.style.themes3.palette.name_label")),1)]),_:1},8,["modelValue"]),u(A,{modelValue:e.selectedPalette,"onUpdate:modelValue":t[32]||(t[32]=C=>e.selectedPalette=C),class:"palette-editor-single"},null,8,["modelValue"])])],8,uy),u(K,{key:"variables",label:e.$t("settings.style.themes3.editor.variables_tab"),"model-value":e.virtualDirectives,"onUpdate:modelValue":e.updateVirtualDirectives},null,8,["label","model-value","onUpdate:modelValue"])]),_:1})])}const fy=X(F$,[["render",my]]);ue.add(Kr,Gr,Yr,Xr,Jr,Zr,Qr,xr,ed,td);const gy={components:{TabSwitcher:Kt,DataImportExportTab:Ud,MutesAndBlocksTab:Lu,NotificationsTab:oc,FilteringTab:lh,SecurityTab:Bp,ProfileTab:Ff,GeneralTab:mg,AppearanceTab:Jb,StyleTab:fy,VersionTab:iv,ThemeTab:$$},computed:{isLoggedIn(){return!!this.$store.state.users.currentUser},open(){return Q().settingsModalState!=="hidden"},bodyLock(){return Q().settingsModalState==="visible"},expertLevel(){return this.$store.state.config.expertLevel},isMobileLayout(){return Q().layoutType==="mobile"}},methods:{onOpen(){const e=Q().settingsModalTargetTab;if(e){const t=this.$refs.tabSwitcher.$slots.default().findIndex(s=>s.props&&s.props["data-tab-name"]===e);t>=0&&this.$refs.tabSwitcher.setTab(t)}Q().clearSettingsModalTargetTab()}},mounted(){this.onOpen()},watch:{open:function(e){e&&this.onOpen()}}},by=["label"],vy=["label"],$y=["label"],yy=["label"],wy=["label"],ky=["label"],Cy=["label"],Ty=["label"],Vy=["label"],Sy=["label"],Py=["label"];function Iy(e,t,s,o,l,a){const d=P("GeneralTab"),r=P("AppearanceTab"),h=P("StyleTab"),c=P("ThemeTab"),p=P("ProfileTab"),$=P("NotificationsTab"),w=P("SecurityTab"),y=P("FilteringTab"),k=P("MutesAndBlocksTab"),S=P("DataImportExportTab"),T=P("VersionTab"),E=P("tab-switcher");return m(),H(E,{ref:"tabSwitcher",class:"settings_tab-switcher","side-tab-bar":!0,"scrollable-tabs":!0,"body-scroll-lock":e.bodyLock},{default:f(()=>[n("div",{label:e.$t("settings.general"),icon:"wrench","data-tab-name":"general"},[u(d)],8,by),n("div",{label:e.$t("settings.appearance"),icon:"window-restore","data-tab-name":"appearance","delay-render":!0},[u(r)],8,vy),e.expertLevel>0?(m(),b("div",{key:0,label:e.$t("settings.style.themes3.editor.title"),icon:"palette","data-tab-name":"style","delay-render":!0},[u(h)],8,$y)):V("",!0),e.expertLevel>0?(m(),b("div",{key:1,label:e.$t("settings.theme_old"),icon:"paint-brush","data-tab-name":"theme","delay-render":!0},[u(c)],8,yy)):V("",!0),e.isLoggedIn?(m(),b("div",{key:2,label:e.$t("settings.profile_tab"),icon:"user","data-tab-name":"profile"},[u(p)],8,wy)):V("",!0),e.isLoggedIn?(m(),b("div",{key:3,label:e.$t("settings.notifications"),icon:"bell","data-tab-name":"notifications"},[u($)],8,ky)):V("",!0),e.isLoggedIn?(m(),b("div",{key:4,label:e.$t("settings.security_tab"),icon:"lock","data-tab-name":"security"},[u(w)],8,Cy)):V("",!0),n("div",{label:e.$t("settings.filtering"),icon:"filter","data-tab-name":"filtering"},[u(y)],8,Ty),e.isLoggedIn?(m(),b("div",{key:5,label:e.$t("settings.mutes_and_blocks"),fullHeight:!0,icon:"eye-slash","data-tab-name":"mutesAndBlocks"},[u(k)],8,Vy)):V("",!0),e.isLoggedIn?(m(),b("div",{key:6,label:e.$t("settings.data_import_export_tab"),icon:"download","data-tab-name":"dataImportExport"},[u(S)],8,Sy)):V("",!0),n("div",{label:e.$t("settings.version.title"),icon:"info","data-tab-name":"version"},[u(T)],8,Py)]),_:1},8,["body-scroll-lock"])}const Ly=X(gy,[["render",Iy]]);export{Ly as default};
//# sourceMappingURL=settings_modal_user_content.xHyLkkp_.js.map
